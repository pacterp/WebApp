"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[6669],{36669:(y,h,o)=>{o.r(h),o.d(h,{LookupsViewModel:()=>b,QuickAddLookupsViewModel:()=>c});var g=o(76962),r=o(76199),L=o(35789),d=o(99393),k=o(5349),n=o(6532),u=o(81322),s=o(9659),a=o(66148),T=o(29702);class b extends r.g{constructor(){super(...arguments),this.NodeID=0,this.ButtonClick=new L.Yk,this.LookupsTableObj=new T.vv,this.LookupTypes=new k.y$(0),this.Code=new n.Dw(0),this.Name=new n.Dw(0),this.AliasName=new n.Dw(0),this.ButtonAddLookup=new u.v,this.ButtonSave=new u.v,this.ButtonAdd=new u.v,this.ButtonEdit=new u.v,this.ButtonDelete=new u.v,this.ColLists=[],this.LookupType=0,this.isTravel=!1}get SelectedLookup(){return this.LookupsTableObj.SelectedItem}get angularGrid(){return this.LookupsTableObj.angularGrid}get LookupsTable(){return this.LookupsTableObj.Table}get LookupsTableColumns(){return this.LookupsTableObj.TableColumns}get ColumnSource(){return this.LookupsTableObj.Columns}get contextVisible(){return this.LookupsTableObj.contextVisible}set contextVisible(e){this.LookupsTableObj.contextVisible=e}get AddEditLookupVisibility(){return this._AddEditLookupVisibility}set AddEditLookupVisibility(e){e&&(this.AddEditLookupTypeVisibility=!1),this._AddEditLookupVisibility!=e&&(this._AddEditLookupVisibility=e)}get AddEditLookupTypeVisibility(){return this._AddEditLookupTypeVisibility}set AddEditLookupTypeVisibility(e){e&&(this.AddEditLookupVisibility=!1),this._AddEditLookupTypeVisibility!=e&&(this._AddEditLookupTypeVisibility=e)}LookupsViewModel(e,t=0,l=!1){this.Name.Label=s.d.GetResource("CCGroup_Name"),this.AliasName.Label=s.d.GetResource("CostCenter_AliasName"),this.Code.Label=s.d.GetResource("CCGroup_Code"),this.LookupType=t,this.isTravel=l,s.d.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.d.SessionManager.IsActionAssigned(44,"Create"):this.ButtonSave.Enable=s.d.SessionManager.IsActionAssigned(44,"Create"),s.d.SessionManager.HideUnathorizedAccess?this.ButtonEdit.Visible=s.d.SessionManager.IsActionAssigned(44,"Update"):this.ButtonEdit.Enable=s.d.SessionManager.IsActionAssigned(44,"Update"),this.AddEditLookupVisibility=!1,s.d.SessionManager.HideUnathorizedAccess?this.ButtonDelete.Visible=s.d.SessionManager.IsActionAssigned(44,"Delete"):this.ButtonDelete.Enable=s.d.SessionManager.IsActionAssigned(44,"Delete"),s.d.SessionManager.HideUnathorizedAccess?this.ButtonAddLookup.Visible=s.d.SessionManager.IsActionAssigned(44,"Add Lookup"):this.ButtonAddLookup.Enable=s.d.SessionManager.IsActionAssigned(44,"Add Lookup"),this.Title=e,this.ButtonClick.Subscribe(this,"CommandController"),this.DisplayName=this.Title,this.AddGridColumns(),this.LookupTypes.SelectionChangedCommand.Subscribe(this,"OnLookupChanged"),this.LoadLookupTypes(),l&&(this.ButtonAddLookup.Visible=!1),this.LookupsTableObj.SearchVisible=!0}LoadLookupTypes(){let t=s.d.admin.GetLookupTypes().Tables[0],p="124,125,126,127,128,129,130,131,132,133,134,135,136,137,140,142,143,144,145,146,147".split(",");t=t.filter(this.isTravel?i=>p.Contains(i.NodeID.toString()):i=>!p.Contains(i.NodeID.toString()));for(let i=0;i<t.length;i++)this.LookupTypes.Items.push(k._p.ComboBoxItems_2(a.J0.StringValue(t[i].ResourceName),t[i].NodeID.toString()));this.LookupTypes.Items.length>0&&(this.LookupType>0?(this.LookupTypes.SetSelectedItem(this.LookupType.toString()),this.LookupTypes.SelectedValue=this.LookupType.toString()):(this.LookupTypes.SelectedItem=this.LookupTypes.Items[0],this.LookupTypes.SelectedValue=this.LookupTypes.Items[0].Value),this.OnLookupChanged(""))}AddGridColumns(){this.LookupsTableColumns.push("NodeID"),this.LookupsTableColumns.push("Code"),this.LookupsTableColumns.push("Name"),this.LookupsTableColumns.push("IsDefault"),this.LookupsTableColumns.push("Status");let e=new d.O7;e=new d.O7,e.DisplayMember="Code",e.Header=s.d.GetResource("CCGroup_Code"),e.DataType="TextBlock",e.Width=180,e.ReadOnly=!0,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e),e=new d.O7,e=new d.O7,e.DisplayMember="Name",e.Header=s.d.GetResource("CCGroup_Name"),e.DataType="TextBlock",e.Width=320,e.ReadOnly=!0,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e),e=new d.O7,e=new d.O7,e.DisplayMember="AliasName",e.Header="AliasName",e.DataType="TextBlock",e.Width=320,e.ReadOnly=!0,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e),e=new d.O7,e.DisplayMember="IsDefault",e.Header=s.d.GetResource("CCGroup_IsDefault"),e.DataType="RadioButton",e.Width=150,e.ReadOnly=!1,e.IsVisible=!0,this.LookupsTableObj.Columns.push(e)}OnLookupChanged(e){this.LookupsTableObj.Clear(),this.NodeID=0,this.MessageVisibility=!1,this.DisplayMessage="",this.Code.Text="",this.Name.Text="",this.AliasName.Text="";let t=s.d.admin.GetLookupDataByType(parseInt(this.LookupTypes.SelectedValue));this.LookupsTableObj.Table=t.Tables[0],this.LookupsTableObj.refreshids();try{this.LookupsTableObj.Table.forEach(l=>{(""==a.J0.String(l.IsDefault)||0==(0,g.yG0)(a.J0.String(l.IsDefault)))&&(l.IsDefault=!1)}),this.LookupsTableObj.refreshDataView()}catch{throw" error"}}CommandController(e){switch(this.DisplayMessage="",e.toString()){case"ADD":this.NodeID=0,this.Code.Text="",this.Name.Text="",this.AliasName.Text="",this.AddEditLookupVisibility=!0;break;case"EDIT":null!=this.SelectedLookup&&(this.NodeID=parseInt(this.SelectedLookup.NodeID),this.Code.Text=a.J0.String(this.SelectedLookup.Code),this.Name.Text=a.J0.String(this.SelectedLookup.Name),this.AliasName.Text=a.J0.String(this.SelectedLookup.AliasName),this.AddEditLookupVisibility=!0);break;case"DELETE":null!=this.SelectedLookup&&confirm(s.d.GetResource("DeleteMessage"))&&this.OnDeleteCallBack();break;case"Cancel":this.AddEditLookupVisibility=!1,this.AddEditLookupTypeVisibility=!1;break;case"Save":this.OnSaveLookup();break;case"Update":this.OnUpdate();break;case"ADDLOOKUPTYPE":this.NodeID=0,this.Code.Text="",this.Name.Text="",this.AliasName.Text="",this.AddEditLookupTypeVisibility=!0;break;case"SaveLOOKUPTYPE":this.OnSaveLookupType()}}OnUpdate(){Logger.InfoLog("LookupsViewModel::Entering OnUpdate");try{if(null!=this.LookupsTableObj.Table&&this.LookupsTableObj.Table.length>0){let e="";e+="<XML>";let l,t=0;for(let i=0;i<this.LookupsTableObj.Table.length;i++)t="true"==a.J0.String(this.LookupsTableObj.Table[i].IsDefault).toLowerCase()?1:0,e+="<Row Default='"+t+"' NodeID='"+this.LookupsTableObj.Table[i].NodeID.toString()+"' />";e+="</XML>",l=s.d.admin.UpdateLookups(e.toString()).RetValue,l>0&&(this.MessageVisibility=!0,this.DisplayMessage="Updated Sucessfully")}}catch(e){Logger.ErrorLog("LookupsViewModel::OnUpdate"+e.stack)}}OnSaveLookup(){Logger.InfoLog("LookupsViewModel::Entering OnSaveLookup");try{if(a.J0.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");let e,t=s.d.admin.SetLookup(parseInt(this.LookupTypes.SelectedValue),this.NodeID,this.Code.Text,this.Name.Text,a.J0.IsEmpty(this.AliasName.Tag)?this.AliasName.Text:this.AliasName.Tag,1);this.DisplayMessage=t.Message,this.MessageVisibility=!0,e=t.RetValue,e>0&&this.OnLookupChanged(""),Logger.InfoLog("LookupAddViewModel::Exiting OnSaveLookup")}catch(e){Logger.ErrorLog("LookupAddViewModel::OnSaveLookup"+e.stack)}}OnDeleteCallBack(){let e,t=s.d.admin.DeleteLookup(parseInt(this.SelectedLookup.NodeID));this.DisplayMessage=t.Message,this.MessageVisibility=!0,e=t.RetValue,e>0&&this.OnLookupChanged(null)}OnSaveLookupType(){Logger.InfoLog("LookupsViewModel::Entering OnSaveLookupType");try{if(a.J0.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");let e,t=s.d.admin.SetLookupType(0,this.Name.Text);this.DisplayMessage=t.Message,this.MessageVisibility=!0,e=t.RetValue,e>0&&(this.LoadLookupTypes(),this.LookupTypes.SelectedValue=e.toString()),Logger.InfoLog("LookupAddViewModel::Exiting OnSaveLookupType")}catch(e){Logger.ErrorLog("LookupAddViewModel::OnSaveLookupType"+e.stack)}}}class c extends r.g{constructor(){super(...arguments),this.NodeID=0,this.ClassName="QuickAddLookupsViewModel",this.ButtonClick=new L.Yk,this.Code=new n.Dw(0),this.Name=new n.Dw(0),this.AliasName=new n.Dw(0),this.ButtonSave=new u.v}QuickAddLookupsViewModel(e,t){this.NodeID=t,this.LookupTypeID=e,this.Name.Label=s.d.GetResource("CCGroup_Name"),0==t?(this.Title="Quick Add Lookup",s.d.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.d.SessionManager.IsActionAssigned(44,"Create"):this.ButtonSave.Enable=s.d.SessionManager.IsActionAssigned(44,"Create")):(this.Title="Edit Lookup",s.d.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=s.d.SessionManager.IsActionAssigned(44,"Update"):this.ButtonSave.Enable=s.d.SessionManager.IsActionAssigned(44,"Update")),this.ButtonClick.Subscribe(this,"CommandController")}CommandController(e){switch(this.DisplayMessage="",e.toString()){case"Cancel":s.d.page.HideDialog(this.PopUpGUID);break;case"Save":this.OnSaveLookup();break;case"Update":this.OnUpdate()}}OnUpdate(){}OnSaveLookup(){Logger.InfoLog("QuickAddLookupsViewModel::Entering OnSaveLookup");try{if(a.J0.IsEmpty(this.Name.Text))return void(this.DisplayMessage="Enter Name");let e,t=s.d.admin.SetLookup(this.LookupTypeID,this.NodeID,this.Code.Text,this.Name.Text,this.AliasName.Text,1);this.DisplayMessage=t.Message,e=t.RetValue,e>0&&(this.NodeID=e,s.d.page.HideDialog(this.PopUpGUID))}catch(e){Logger.ErrorLog("QuickAddLookupsViewModel::OnSaveLookup"+e.stack)}}}}}]);