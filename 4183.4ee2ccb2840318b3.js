"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[4183],{14183:(ot,_,f)=>{f.r(_),f.d(_,{KPIViewComponent:()=>rt});var v=f(9659),i=f(41360),m=f(32881),O=f(60462),F=f(14592),z=f(70152),y=function(){if(typeof Map<"u")return Map;function e(r,t){var n=-1;return r.some(function(o,s){return o[0]===t&&(n=s,!0)}),n}return function(){function r(){this.__entries__=[]}return Object.defineProperty(r.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),r.prototype.get=function(t){var n=e(this.__entries__,t),o=this.__entries__[n];return o&&o[1]},r.prototype.set=function(t,n){var o=e(this.__entries__,t);~o?this.__entries__[o][1]=n:this.__entries__.push([t,n])},r.prototype.delete=function(t){var n=this.__entries__,o=e(n,t);~o&&n.splice(o,1)},r.prototype.has=function(t){return!!~e(this.__entries__,t)},r.prototype.clear=function(){this.__entries__.splice(0)},r.prototype.forEach=function(t,n){void 0===n&&(n=null);for(var o=0,s=this.__entries__;o<s.length;o++){var a=s[o];t.call(n,a[1],a[0])}},r}()}(),b=typeof window<"u"&&typeof document<"u"&&window.document===document,l=typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")(),T="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(l):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)},G=["top","right","bottom","left","width","height","size","weight"],W=typeof MutationObserver<"u",L=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function j(e,r){var t=!1,n=!1,o=0;function s(){t&&(t=!1,e()),n&&c()}function a(){T(s)}function c(){var h=Date.now();if(t){if(h-o<2)return;n=!0}else t=!0,n=!1,setTimeout(a,r);o=h}return c}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(r){~this.observers_.indexOf(r)||this.observers_.push(r),this.connected_||this.connect_()},e.prototype.removeObserver=function(r){var t=this.observers_,n=t.indexOf(r);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var r=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return r.forEach(function(t){return t.broadcastActive()}),r.length>0},e.prototype.connect_=function(){!b||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),W?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!b||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(r){var t=r.propertyName,n=void 0===t?"":t;G.some(function(s){return!!~n.indexOf(s)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),w=function(e,r){for(var t=0,n=Object.keys(r);t<n.length;t++){var o=n[t];Object.defineProperty(e,o,{value:r[o],enumerable:!1,writable:!1,configurable:!0})}return e},u=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||l},E=p(0,0,0,0);function d(e){return parseFloat(e)||0}function R(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return r.reduce(function(n,o){return n+d(e["border-"+o+"-width"])},0)}var K=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof u(e).SVGGraphicsElement}:function(e){return e instanceof u(e).SVGElement&&"function"==typeof e.getBBox}}();function D(e){return b?K(e)?function A(e){var r=e.getBBox();return p(0,0,r.width,r.height)}(e):function k(e){var r=e.clientWidth,t=e.clientHeight;if(!r&&!t)return E;var n=u(e).getComputedStyle(e),o=function P(e){for(var t={},n=0,o=["top","right","bottom","left"];n<o.length;n++){var s=o[n];t[s]=d(e["padding-"+s])}return t}(n),s=o.left+o.right,a=o.top+o.bottom,c=d(n.width),h=d(n.height);if("border-box"===n.boxSizing&&(Math.round(c+s)!==r&&(c-=R(n,"left","right")+s),Math.round(h+a)!==t&&(h-=R(n,"top","bottom")+a)),!function $(e){return e===u(e).document.documentElement}(e)){var g=Math.round(c+s)-r,C=Math.round(h+a)-t;1!==Math.abs(g)&&(c-=g),1!==Math.abs(C)&&(h-=C)}return p(o.left,o.top,c,h)}(e):E}function p(e,r,t,n){return{x:e,y:r,width:t,height:n}}var V=function(){function e(r){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=p(0,0,0,0),this.target=r}return e.prototype.isActive=function(){var r=D(this.target);return this.contentRect_=r,r.width!==this.broadcastWidth||r.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var r=this.contentRect_;return this.broadcastWidth=r.width,this.broadcastHeight=r.height,r},e}(),H=function(){return function e(r,t){var n=function B(e){var r=e.x,t=e.y,n=e.width,o=e.height,s=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(s.prototype);return w(a,{x:r,y:t,width:n,height:o,top:t,right:r+n,bottom:o+t,left:r}),a}(t);w(this,{target:r,contentRect:n})}}(),Y=function(){function e(r,t,n){if(this.activeObservations_=[],this.observations_=new y,"function"!=typeof r)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=r,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u")&&Element instanceof Object){if(!(r instanceof u(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(r)||(t.set(r,new V(r)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u")&&Element instanceof Object){if(!(r instanceof u(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(r)&&(t.delete(r),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var r=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&r.activeObservations_.push(t)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var r=this.callbackCtx_,t=this.activeObservations_.map(function(n){return new H(n.target,n.broadcastRect())});this.callback_.call(r,t,r),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),x=typeof WeakMap<"u"?new WeakMap:new y,S=function(){return function e(r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=L.getInstance(),n=new Y(r,t,this);x.set(this,n)}}();["observe","unobserve","disconnect"].forEach(function(e){S.prototype[e]=function(){var r;return(r=x.get(this))[e].apply(r,arguments)}});const U=typeof l.ResizeObserver<"u"?l.ResizeObserver:S,N=["textContainer"];let Q=(()=>{class e{constructor(t=null,n,o){this.elementRef=t,this.renderer=n,this.zone=o,this.fontSize=16,this.minWidth=80,this.minHeight=20}ngOnInit(){}ngAfterViewInit(){null!=this.RefreshSubject&&this.RefreshSubject.pipe((0,z.B)(300)).subscribe(()=>{this.resizeTextToFitContainer()}),setTimeout(()=>{this.resizeTextToFitContainer(),this.setupResizeObserver()},300)}getFont(t){var n=this.textContainer.nativeElement.getBoundingClientRect().width;return window,`${Math.max(n/10,this.textContainer.nativeElement.getBoundingClientRect().height/5)}`}resizeTextToFitContainer(){const t=this.textContainer.nativeElement,n=t.querySelector("span");if(""==n.innerText)return;const o=t.clientWidth,s=t.clientHeight;for(n.style.fontSize=this.fontSize+"px";(n.offsetWidth>o||n.offsetHeight>s)&&(o>this.minWidth||s>this.minHeight);)this.fontSize-=1,n.style.fontSize=this.fontSize+"px";for(n.style.fontSize=this.fontSize-2+"px";o>this.minWidth&&s>this.minHeight&&n.offsetWidth<o&&n.offsetHeight<s;)this.fontSize+=1,n.style.fontSize=this.fontSize+"px";n.style.fontSize=this.fontSize-2+"px"}setupResizeObserver(){const t=this.textContainer.nativeElement;new U(()=>{this.resizeTextToFitContainer()}).observe(t)}getTextColor(t){return v.d.IsMobile?null==t?"":(9==t.length&&t.startsWith("#")&&(t="#"+t.substr(3)),t):""}static{this.\u0275fac=function(n){return new(n||e)(i.rXU(i.aKT),i.rXU(i.sFG),i.rXU(i.SKi))}}static{this.\u0275cmp=i.VBU({type:e,selectors:[["KPI-Label"]],viewQuery:function(n,o){if(1&n&&i.GBs(N,5),2&n){let s;i.mGM(s=i.lsd())&&(o.textContainer=s.first)}},inputs:{kpiL:"kpiL",RefreshSubject:"RefreshSubject"},standalone:!1,decls:7,vars:9,consts:[["textContainer",""],[1,"caption",2,"height","100%","width","100%"]],template:function(n,o){1&n&&(i.EFF(0,"\n  "),i.j41(1,"div",1,0),i.EFF(3,"\n  "),i.j41(4,"span"),i.EFF(5),i.k0s(),i.EFF(6,"\n  "),i.k0s()),2&n&&(i.R7$(),i.xc7("color",o.kpiL.ForeColor)("text-align",o.kpiL.Align)("font-family",o.kpiL.FontFamily),i.R7$(3),i.xc7("font-size",o.fontSize,"px"),i.R7$(),i.JRh(o.kpiL.Label))},encapsulation:2})}}return e})();const q=["textCaption"],J=["textdata"];function Z(e,r){if(1&e&&(i.j41(0,"div",9),i.EFF(1,"\n            "),i.nrm(2,"KPI-Label",10),i.EFF(3,"\n        "),i.k0s()),2&e){const t=i.XpG().$implicit;i.R7$(2),i.Y8G("kpiL",t.Header)}}function tt(e,r){if(1&e&&(i.j41(0,"div",5),i.EFF(1,"\n        "),i.DNE(2,Z,4,1,"div",6),i.EFF(3,"\n        "),i.j41(4,"div",7),i.EFF(5,"\n            "),i.nrm(6,"KPI-Label",8),i.EFF(7,"\n       "),i.k0s(),i.EFF(8,"\n    "),i.k0s()),2&e){const t=r.$implicit,n=i.XpG(2);i.Mz_("id","KPI_x",n.slickid,""),i.Y8G("ngStyle",n.getDBpanelStyles(t)),i.R7$(2),i.Y8G("ngIf",t.ShowCaption),i.R7$(2),i.xc7("height",t.ShowCaption?"calc(100% - 40%)":"calc(100%)"),i.R7$(2),i.Y8G("kpiL",t.Data)("RefreshSubject",n.obj.RefreshV)}}function et(e,r){if(1&e&&(i.j41(0,"div",3),i.EFF(1,"\n    "),i.DNE(2,tt,9,8,"div",4),i.EFF(3,"\n"),i.k0s()),2&e){const t=i.XpG();i.Y8G("ngStyle",t.getStyles()),i.R7$(2),i.Y8G("ngForOf",t.obj.KPILabels)}}function nt(e,r){if(1&e&&i.nrm(0,"app-add-edit-filter",11),2&e){const t=i.XpG();i.Y8G("obj",t.obj.Report.Filter)}}function it(e,r){if(1&e&&i.nrm(0,"app-static-report-filter",11),2&e){const t=i.XpG();i.Y8G("obj",t.obj.Report.oReportDialog)}}let rt=(()=>{class e{constructor(t=null,n,o){this.elementRef=t,this.renderer=n,this.zone=o,this.fontSize=16,this.fontSizeData=16,this.minWidth=100,this.minHeight=50}ngOnInit(){this.slickid=v.d.slick.gridid}getColor(t){return null==t?"":(9==t.length&&t.startsWith("#")&&(t="#"+t.substr(3)),t)}getTextColor(t){v.d.IsMobile&&this.getColor(t)}getMaxWidth_Elements(t){return Array.from(t).map(s=>s.getBoundingClientRect().width).reduce((s,a)=>a>s?a:s,0)}get element(){return this.elementRef.nativeElement}getFont(t){var n=this.element.getBoundingClientRect().width;let a=n/window.outerWidth*(t/1.1);const c=Math.max(n/10,this.element.getBoundingClientRect().height/5);return a<1&&(a+=1),this.getMaxWidth_Elements(this.element.getElementsByClassName("KPILabel")),`${c}`}getStyles(){return{gridTemplateColumns:`repeat(${this.obj.Columns},${100/this.obj.Columns}%)`,gridTemplateRows:`repeat(${this.obj.Rows},${100/this.obj.Rows}%)`}}getDBpanelStyles(t){return{gridColumnStart:`${parseInt(t.Column)+1}`,gridColumnEnd:`span ${t.ColumnSpan}`,gridRowStart:`${parseInt(t.Row)+1}`,gridRowEnd:`span ${t.RowSpan}`}}static{this.\u0275fac=function(n){return new(n||e)(i.rXU(i.aKT),i.rXU(i.sFG),i.rXU(i.SKi))}}static{this.\u0275cmp=i.VBU({type:e,selectors:[["app-kpiview"]],viewQuery:function(n,o){if(1&n&&(i.GBs(q,5),i.GBs(J,5)),2&n){let s;i.mGM(s=i.lsd())&&(o.textCaption=s.first),i.mGM(s=i.lsd())&&(o.textdata=s.first)}},inputs:{obj:"obj"},standalone:!1,decls:6,vars:3,consts:[["style","display: grid; width: 100%;height:100%;",3,"ngStyle",4,"ngIf"],["style","height: 100%; margin:auto;",3,"obj",4,"ngIf"],["style","height: 100%;margin:auto;",3,"obj",4,"ngIf"],[2,"display","grid","width","100%","height","100%",3,"ngStyle"],["class","KPILabel","style","color: #333;display: flex;flex-direction: column;height: calc(100% - 0px);",3,"id","ngStyle",4,"ngFor","ngForOf"],[1,"KPILabel",2,"color","#333","display","flex","flex-direction","column","height","calc(100% - 0px)",3,"id","ngStyle"],["style","height: 40%;",4,"ngIf"],[2,"font-weight","bold"],[3,"kpiL","RefreshSubject"],[2,"height","40%"],[3,"kpiL"],[2,"height","100%","margin","auto",3,"obj"]],template:function(n,o){1&n&&(i.DNE(0,et,4,2,"div",0),i.EFF(1,"\n"),i.DNE(2,nt,1,1,"app-add-edit-filter",1),i.EFF(3,"\n"),i.DNE(4,it,1,1,"app-static-report-filter",2),i.EFF(5,"\n")),2&n&&(i.Y8G("ngIf",o.obj.Report.ShowReport),i.R7$(2),i.Y8G("ngIf",o.obj.Report.ShowFilter),i.R7$(2),i.Y8G("ngIf",o.obj.Report.ShowStaticFilter))},dependencies:[m.Sq,m.bT,m.B3,O.y,F.AddEditFilterComponent,Q],encapsulation:2})}}return e})()}}]);