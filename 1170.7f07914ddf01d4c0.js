"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[1170],{11170:(S,l,o)=>{o.r(l),o.d(l,{DeprBookViewModel:()=>g});var t=o(9659),a=o(66148),n=o(76962),D=o(76199),i=o(6532),s=o(5349),p=o(95589),u=o(92014),r=o(66133),B=o(89211);class g extends D.g{get DeprBookID(){return this._DeprBookID}set DeprBookID(e){e!=this._DeprBookID&&(this._DeprBookID=e,this.obj.DeprBookID=this._DeprBookID)}constructor(e){super(),this._DeprBookID=0,this.DeprBookCode=new i.Dw(23798),this.DeprBookName=new i.Dw(23799),this.DeprBookMethod=new s.y$(23800),this.DeprMethodBasedOn=new s.y$(49968),this.DeprMethodBasedOnValue=new i.Dw(49969),this.DeprBookStatus=new s.y$(23801),this.Salvage=new p.mn,this.SalvageEnable=new B.c,this.AveragingMethod=new s.y$(26584),this.ScreenObject=new u.ControlGenerator,this.obj=new r.V,this.RetValue=0,this.Fields=[],this.DeprBookID=e,this.Title=t.d.GetResource("AddDeprBook"),this.DisplayName=this.Title,this.DisplayMessage="",this.AveragingMethod.Items.push(s._p.ComboBoxItems_2(t.d.GetResource("DeprBook_CalendarDays"),"1")),this.AveragingMethod.Items.push(s._p.ComboBoxItems_2(t.d.GetResource("DeprBook_FullMonth"),"2")),this.AveragingMethod.Items.push(s._p.ComboBoxItems_2(t.d.GetResource("DeprBook_MidMonth"),"3")),this.AveragingMethod.SelectedValue="1",this.DeprBookMethod.SelectionChangedCommand.Subscribe(this,"OnDeprMethodChange"),this.DeprMethodBasedOn.SelectionChangedCommand.Subscribe(this,"OnDeprMethodBasedOn"),this.Salvage.Currency.Items.push(s._p.ComboBoxItems_2("Value","1")),this.Salvage.Currency.Items.push(s._p.ComboBoxItems_2("Percentage","2")),this.Salvage.Currency.SelectedValue="1",this.Salvage.ExchangeRate.Text="0",this.SalvageEnable.IsChecked=!1,this.LoadData(),0==this.DeprBookID?this.Title=t.d.GetResource("AddDeprBook"):(this.Title=t.d.GetResource("EditDeprBook"),this.OnLoadData()),this.OnDeprMethodChange(null)}LoadData(){this.ScreenObject.LoadScreen_2(this,75),this.DeprBookCode.Enable=!0,this.DeprBookName.Enable=!0,this.DeprBookMethod.Enable=!0,this.DeprBookStatus.Enable=!0,this.DeprMethodBasedOn.Enable=!0,this.DeprMethodBasedOnValue.Enable=!0,this.Salvage.Enable=!0,this.SalvageEnable.Enable=!0,this.Salvage.Visible=!0,this.SalvageEnable.Visible=!0,this.SalvageEnable.Label="Include salvage value in depriciation calcualtion",this.AveragingMethod.Enable=!0,this.Fields.push(this.DeprBookCode),this.Fields.push(this.DeprBookName),this.Fields.push(this.DeprBookStatus),this.Fields.push(this.DeprMethodBasedOn),this.Fields.push(this.DeprMethodBasedOnValue),this.Fields.push(this.Salvage),this.Fields.push(this.SalvageEnable),this.Fields.push(this.AveragingMethod),this.ScreenObject.Data.Tables.length>0&&(this.ScreenObject.Data.Tables[3].forEach(e=>{this.DeprBookStatus.Items.push(s._p.ComboBoxItems_2(e.Status.toString(),e.StatusID.toString()))}),this.DeprBookStatus.SelectedValue="381",this.ScreenObject.Data.Tables[4].forEach(e=>{this.DeprBookMethod.Items.push(s._p.ComboBoxItems_2(e.Name.toString(),e.DepreciationMethodID.toString()))}),this.DeprBookMethod.SelectedValue="1",this.DeprMethodBasedOn.Items.push(s._p.ComboBoxItems_2("Acquisition Value/Total","1")),this.DeprMethodBasedOn.Items.push(s._p.ComboBoxItems_2("Percentage On Acquisition Value","2")),this.DeprMethodBasedOn.SelectedValue="1",this.DeprMethodBasedOnValue.Text="1")}OnLoadData(){let e=r.V.GetDeprBookDetails(this.obj.DeprBookID);null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&(this.DeprBookCode.Text=e.Tables[0][0].DeprBookCode.toString(),this.DeprBookName.Text=e.Tables[0][0].DeprBookName.toString(),this.DeprBookMethod.SelectedValue=e.Tables[0][0].DeprBookMethod.toString(),this.DeprBookStatus.SelectedValue=e.Tables[0][0].StatusID.toString(),this.AveragingMethod.SelectedValue=e.Tables[0][0].AveragingMethod.toString(),this.DeprMethodBasedOn.SelectedValue=e.Tables[0][0].DeprMethodBasedOn.toString(),this.DeprMethodBasedOnValue.Text=e.Tables[0][0].BasedOnValue.toString(),this.Salvage.Currency.SelectedValue=e.Tables[0][0].SalvageValueType.toString(),this.Salvage.ExchangeRate.Text=e.Tables[0][0].SalvageValue.toString(),this.SalvageEnable.IsChecked=(0,n.yG0)(e.Tables[0][0].IncludeSalvageInDepr),this.obj.GUID=e.Tables[0][0].GUID.toString())}OnDeprMethodChange(e){this.DeprMethodBasedOn.Visible="1"==this.DeprBookMethod.SelectedValue,this.OnDeprMethodBasedOn(null)}OnDeprMethodBasedOn(e){this.DeprMethodBasedOnValue.Label=this.DeprMethodBasedOn.Visible?"2"==this.DeprMethodBasedOn.SelectedValue?"Percentage":"Total Years":"Percentage"}OnSaveDeprBook(e){try{if("Save"==e.toString()){if(null==this.DeprBookCode.Text||""==this.DeprBookCode.Text.Trim())return void(this.DisplayMessage=t.d.GetResource("Enter")+" Code");if(this.obj.DeprBookCode=this.DeprBookCode.Text,null==this.DeprBookName.Text||""==this.DeprBookName.Text.Trim())return void(this.DisplayMessage=t.d.GetResource("Enter")+" Name");if(this.obj.DeprBookName=this.DeprBookName.Text,a.J0.IsEmpty(this.DeprBookMethod.SelectedValue))return void(this.DisplayMessage=t.d.GetResource("Select")+t.d.GetResource("DeprMethod"));if(this.obj.DeprBookMethod=parseInt(this.DeprBookMethod.SelectedValue),a.J0.IsEmpty(this.DeprBookStatus.SelectedValue))return void(this.DisplayMessage=t.d.GetResource("Select")+t.d.GetResource("Status"));if(this.obj.StatusID=parseInt(this.DeprBookStatus.SelectedValue),null==this.AveragingMethod.SelectedValue||""==this.AveragingMethod.SelectedValue)return void(this.DisplayMessage=t.d.GetResource("Select")+t.d.GetResource("DeprBook_AveragingMethod"));if(this.obj.AveragingMethodID=parseInt(this.AveragingMethod.SelectedValue),this.obj.DeprBookMethodBasedOnValue=a.J0.Double(this.DeprMethodBasedOnValue.Text),this.obj.DeprBookMethodBasedOnValue<=0)return void(this.DisplayMessage="Please enter valid based on value");this.obj.DeprBookMethodBasedOn=parseInt(this.DeprMethodBasedOn.SelectedValue);let h=0,M=parseInt(this.Salvage.Currency.SelectedValue);h=a.J0.Double(this.Salvage.ExchangeRate.Text),this.obj.SaveDeprBook(M,h,this.SalvageEnable.IsChecked).subscribe(d=>{this.DisplayMessage=d.Message,this.RetValue=d.RetValue,this.RetValue>0&&(this.DeprBookID=0,this.ClearFields(),null!=this.Parent&&this.Parent.Refresh())})}else t.d.page.HideDialog(this.PopUpGUID)}catch(h){Logger.ErrorLog("DeprBookViewModel:: OnSaveDeprBook",h)}}ClearFields(){this.DeprBookCode.Text="",this.DeprBookName.Text="",this.DeprBookStatus.SelectedValue="381",this.DeprBookMethod.SelectedValue="1",this.AveragingMethod.SelectedValue="1",this.OnDeprMethodChange(null)}}}}]);