"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[7639],{97639:(_,d,s)=>{s.r(d),s.d(d,{ImportUtilityViewModel:()=>p});var e=s(32040),u=s(43767),I=s(98580),C=s(27730),n=s(84151),m=s(7321),D=s(21774),T=s(23603),y=s(88514),i=s(26336),b=s(23458),c=s(58941),h=s(58170);class p extends I.g{get DataTable(){return this.DataTableObj.Table}constructor(l,o){console.log("constructor:",l),super(),this.ds=null,this.obj=new T.Document,this.Name=new n.Dw(0),this.Profile=new C.y$(0),this.Dimensions=new C.y$(0),this.ErrorMessage="",this.drSel=null,this.NotesList=[],this.ErrorList=[],this.RulesList=[],this.CostCenterFields=[],this.DataTableObj=new m.vv,this.xDocCodeDef=new u.VB,this.Administration={},this.objAsset=new y.V,this.temp=new i.bT,this.lookuptemp=new i.bT,this.CCQuery=new i.bT,this.CCQueryData=new i.bT,this.lookupQuery=new i.bT,this.ccdv=new i.bT,this.lookupdv=new i.bT,this.COls=new i.bT,this.catSub=new i.bT,this.partCat=new i.bT,this.BankAccounts=new b.y$(0),this.BatchCode=new n.s3(27184),this.WithoutExcel=!1,this.FailedRecourdList=[],this.FailedCount=0,this.ImportingMessage="Importing Data Please Wait....",this.ScreenObject=null,this.ActualFileName="",this.FeatureVisibility=!0,this.ImportVisbility=!0,this.BulkVisible=!1,this.ProgressValue=0,this.ProgressMax=0,this.grData=new m.vv,this.QtyText=new n.Dw(0),this.RateText=new n.Dw(0),this.ProfileName=new n.Dw(0),this.Feature=new C.y$(0),this.UpdateBasedOn=new n.Dw(0),this.QtyCombo=new n.Dw(0),this.RateCombo=new n.Dw(0),this.RefreshGrid=!1,this.IsDuplicateNameAllowed=!1,this.DoNotCreateCCVisibility=!1,this.UpdateBasedOnVisibility=!1,this.DoNotCreateCostCenter=!1,this.IsAvgRateChecked=!1,this.AvgVisible=!1,this.QtyRateVisible=!1,this.IsQtyChecked=!1,this.IsRateChecked=!1,this.IsProductwiseBarcode=!1,this.IsAutoCodeGen=!1,this.ValidateBeforeImport=!0,this.UpdateStatusInExcel=!0,this.AppendData=!1,this.AppendVisible=!1,this.FillLocalReference=!1,this.FillLocRefVisibility=!1,this.IsCode=!1,this.BulkSave=!1,this.PartialSave=!1,this.IsPreview=!1,this.IsUpdate=!1,this.VerifyVisible=!1,this.ValidateVisible=!1,this.IsSnoBasedLinking=!1,this.GridEnable=!1,this.NameSameasCode=!1,this.lblTitle="",this.ButtonOpen=new c.v,this.ButtonSave=new c.v,this.EmpCode=new n.s3(0),this.DocItems=new C.v4,this.TemplateGrid=new m.vv,this.ProductTypeID=0,this.IgnoreBatch=0,this.YearMonth=(new Date).ToString("yyyyMMM"),this.ProfileID=0,this.Browsefile=new h.Yk,this.ExportFile=new h.Yk,this.ImportData=new h.Yk,this.SaveFile=new h.Yk,this.ProfileID=l,Logger.InfoLog("ImportViewModel::Entering ImportViewModel"),this.BankAccounts.Visible=!1,this.TemplateGrid.Visible=!1,this.QtyCombo.Visible=!1,this.YearMonth="",this.loadFeatures(o)}loadFeatures(l){const o=e.d.document.GetFeaturesList();for(let a=0;a<o.Tables[0].length;a++)console.log("data",o.Tables[0]),251==u.J0.Int(o.Tables[0][a][0])||252==u.J0.Int(o.Tables[0][a][0])||253==u.J0.Int(o.Tables[0][a][0])||254==u.J0.Int(o.Tables[0].Rows[a][0])||255==u.J0.Int(o.Tables[0].Rows[a][0])?this.Feature.Items.push(C._p.ComboBoxItems_2("Payroll "+o.Tables[0][a][1].ToString(),o.Tables[0][a][0].ToString())):this.Feature.Items.push(C._p.ComboBoxItems_2(o.Tables[0][a][1].ToString(),o.Tables[0][a][0].ToString()));this.Feature.Items.push(C._p.ComboBoxItems_2("Attachments","-100")),l?(this.ButtonOpen.Visible=!1,this.ProfileName.Enable=!1,this.FeatureVisibility=!1,this.Feature.Enable=!1,this.GridEnable=!1):this.ButtonOpen.Visible=!(!e.d.SessionManager.IsActionAssigned(162,"Create")&&!e.d.SessionManager.IsActionAssigned(162,"Update")),this.ButtonSave.Visible=!!e.d.SessionManager.IsActionAssigned(162,"Update"),this.BankAccounts.CCID=2,this.BankAccounts.TypeID=2,this.BankAccounts.CustomWhere="AccountTypeID=2",this.UpdateBasedOn.Visible=!1,this.Browsefile.Subscribe(this,"OnBrowsefile"),this.ExportFile.Subscribe(this,"OnExportFile"),this.Feature.SelectionChangedCommand.Subscribe(this,"OnSelectionChanged"),this.ImportData.Subscribe(this,"OnImportData"),this.SaveFile.Subscribe(this,"OnSave"),this.DisplayName=this.lblTitle,this.ButtonSave.ClickCommand.Subscribe(this,"OnSave");let r=[];this.DtImport=[];let t=new D.O7;t.DisplayMember="FieldName",t.Header=e.d.GetResource("Import_FieldName"),t.DataType="TextBlock",t.Width=200,t.ReadOnly=!0,t.DisableTab=!0,r.push(t),this.DtImport.Columns.push("FieldName"),t=new D.O7,t.DisplayMember="ResourceData",t.ValueMember="CostCenterColID",t.ValueBinding="FeatureFieldName",t.Header=e.d.GetResource("Import_FeatureFieldName"),t.DataType="ComboBox",t.Width=200,t.DisableTab=!1,r.Push(t),this.DtImport.Columns.Push("FeatureFieldName"),0!=this.ProfileID&&(t.ReadOnly=!e.d.SessionManager.IsActionAssigned(162,"Edit Profile"),this.Feature.Enable=e.d.SessionManager.IsActionAssigned(162,"Edit Profile")),Logger.InfoLog("ImportViewModel::Exiting ImportViewModel")}FillBomDetails(){const l=this.Feature?.SelectedValue;[{CostCenterColID:"-1",ColumnCostCenterID:"3",ColumnDataType:"LISTBOX",SysColumnName:"RawMaterial",ResourceKey:e.d.GetResource("RawMaterial")},{CostCenterColID:"-12",ColumnCostCenterID:"3",ColumnDataType:"LISTBOX",SysColumnName:"OutPutProduct",ResourceKey:e.d.GetResource("OutPutProduct")},{CostCenterColID:"-2",ColumnCostCenterID:"0",ColumnDataType:"FLOAT",SysColumnName:"Qty",ResourceKey:e.d.GetResource("Quantity")},{CostCenterColID:"-3",ColumnCostCenterID:"11",ColumnDataType:"LISTBOX",SysColumnName:"UOMID",ResourceKey:e.d.GetResource("UOM")},{CostCenterColID:"-4",ColumnCostCenterID:"0",ColumnDataType:"FLOAT",SysColumnName:"UnitPrice",ResourceKey:e.d.GetResource("UnitPrice  ")},{CostCenterColID:"-5",ColumnCostCenterID:"0",ColumnDataType:"FLOAT",SysColumnName:"Value",ResourceKey:e.d.GetResource("Value")},{CostCenterColID:"-6",ColumnCostCenterID:"0",ColumnDataType:"FLOAT",SysColumnName:"Wastage",ResourceKey:e.d.GetResource("Waistage")},{CostCenterColID:"-7",ColumnCostCenterID:"2",ColumnDataType:"LISTBOX",SysColumnName:"CreditAccount",ResourceKey:"Credit Account"},{CostCenterColID:"-15",ColumnCostCenterID:"2",ColumnDataType:"LISTBOX",SysColumnName:"DebitAccount",ResourceKey:"Debit Account"},{CostCenterColID:"-8",ColumnCostCenterID:"0",ColumnDataType:"FLOAT",SysColumnName:"ExpenseCharges",ResourceKey:e.d.GetResource("ExpenseCharges")},{CostCenterColID:"-9",ColumnCostCenterID:"71",ColumnDataType:"LISTBOX",SysColumnName:"Machine",ResourceKey:e.d.GetResource("Machine")},{CostCenterColID:"-10",ColumnCostCenterID:"0",ColumnDataType:"FLOAT",SysColumnName:"HRS",ResourceKey:e.d.GetResource("HRS")},{CostCenterColID:"-11",ColumnCostCenterID:"0",ColumnDataType:"FLOAT",SysColumnName:"MachineCharges",ResourceKey:e.d.GetResource("MachineCharges")}].forEach(r=>{this.CostCenterFields.push({CostCenterColID:r.CostCenterColID,CostcenterID:l,ColumnCostCenterID:r.ColumnCostCenterID,ColumnDataType:r.ColumnDataType,SysColumnName:r.SysColumnName,ResourceData:r.ResourceKey,IsColumninuse:"true",IsColumnUserDefined:"false"})})}OnBrowsefile(){}OnExportFile(){}OnSelectionChanged(l){}OnImportData(l){}OnSave(l){}}}}]);