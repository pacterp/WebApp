"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[9250],{29250:(Q,F,d)=>{d.r(F),d.d(F,{BRSMatchViewModel:()=>z,BRSViewModel:()=>E});var o=d(32040),r=d(43767),M=d(98580),y=d(82503),D=d(27730),I=d(7321),L=d(39026),f=d(66471),B=d(58170),m=d(21774),T=d(54581),V=d(23458),b=d(31884),O=d(67329),x=d(84151),k=d(20643);class v extends M.g{get PstBalances(){return this._PstBalances}get Location(){return this._Location}set Location(e){this._Location!=e&&(this._Location=e)}get BankAccounts(){return this._BankAccounts}set BankAccounts(e){e!=this._BankAccounts&&(this._BankAccounts=e)}get FromDate(){return this._FromDate}set FromDate(e){e!=this._FromDate&&(this._FromDate=e)}get ToDate(){return this._ToDate}set ToDate(e){e!=this._ToDate&&(this._ToDate=e)}get Filter(){return this._Filter}set Filter(e){e!=this._Filter&&(this._Filter=e)}get rdoNone(){return this._rdoNone}set rdoNone(e){e!=this._rdoNone&&(e&&(this.rdoChequeNo=!1,this.rdoVoucherNo=!1),this._rdoNone=e)}get rdoChequeNo(){return this._rdoChequeNo}set rdoChequeNo(e){e!=this._rdoChequeNo&&(e&&(this.rdoNone=!1,this.rdoVoucherNo=!1),this._rdoChequeNo=e)}get rdoVoucherNo(){return this._rdoVoucherNo}set rdoVoucherNo(e){e!=this._rdoVoucherNo&&(e&&(this.rdoNone=!1,this.rdoChequeNo=!1),this._rdoVoucherNo=e)}get BankBalance(){return this._BankBalance}set BankBalance(e){e!=this._BankBalance&&(this._BankBalance=e)}get SortOn(){return this._SortOn}set SortOn(e){e!=this._SortOn&&(this._SortOn=e)}get BalancesVisiblity(){return this._BalancesVisiblity}set BalancesVisiblity(e){e!=this._BalancesVisiblity&&(this._BalancesVisiblity=e)}constructor(){super(),this._PstBalances=new I.vv,this.ButtonClick=new B.Yk,this.LocationCheckedChanged=new B.Yk,this.IsQuit=!0,this.IsOK=!1,this.LockCheckedChanged=!1,this._BankAccounts=new V.y$(0),this._FromDate=new y.Lc(0),this._ToDate=new y.Lc(0),this._rdoNone=!0,this._rdoChequeNo=!1,this._rdoVoucherNo=!1,this._BankBalance=new x.Dw,this.IsDateWiseBalEntry=!1,this.ClassName="BRSDialogViewModel"}BRSDialogViewModel(){if(Logger.InfoLog("BRSDialogViewModel:: Entering BRSDialogViewModel"),o.d.SessionManager.Preferences.ContainsKey("BRS Screen Widths")&&""!=o.d.SessionManager.Preferences["BRS Screen Widths"]){let l=new r.VB;l.LoadXml(o.d.SessionManager.Preferences["BRS Screen Widths"]);for(let h=0;h<l.DocumentElement.childNodes.length;h++){let i=l.DocumentElement.children[h];"CHECKBOX"==i.attributes.Header.value&&"DateWiseBRSBalEntry"==i.attributes.Name.value&&(this.IsDateWiseBalEntry=1==parseInt(i.attributes.WIDTH.value))}}if(this.BankBalance.Label=o.d.GetResource("BRSBankBalance"),this.BankBalance.Align="right",this.BankAccounts.Label=o.d.GetResource("Reports_BankName"),this.BankAccounts.OnPactListBoxValueChanged.Subscribe(this,"onListBoxValueChanged"),this.BankAccounts.CustomWhere="a.AccountTypeID in (2,3)",this.BankAccounts.CCID=2,this.BankAccounts.TypeID=2,this.BankAccounts.Refresh(),this.BankAccounts.SetTimeToZero(500),this.ToDate.SelectedDateChanged.Subscribe(this,"OnDateChanged"),this.FromDate.Label=o.d.GetResource("Reports_LblFromDate"),this.ToDate.Label=o.d.GetResource("Reports_LblToDate"),this.FromDate.Date=o.d.SessionManager.ReportsFromDate,this.DateRanges=k.w.getDateRanges(),this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.InitGrid(),this.ForeignCurrency=new O.NY,o.d.common.GetDataSet("PDDVM01","").Tables[0].forEach(l=>{this.ForeignCurrency.ComboBox.Items.push(D._p.ComboBoxItems_2(l.Name.toString(),l.CurrencyID.toString())),this.ForeignCurrency.ComboBox.Items.length>0&&(this.ForeignCurrency.ComboBox.SelectedValue=this.ForeignCurrency.ComboBox.Items[0].Value)}),this.ForeignCurrency.ComboBox.Enable=!1,this.ForeignCurrency.CheckBox.CheckedChangedCommand.Subscribe(this,"OnForeignCurrencySelectionChanged"),this.ForeignCurrency.CheckBox.Label="Foreign Currency",this.LocationCheckedChanged.Subscribe(this,"OnLocationCheckedChanged"),this.Location=new D.v4(0),this.Location.Items.push(D.oN.CheckedListBoxItem_6("All","All",!1,50002)),this.Location.Visible="True"==o.d.SessionManager.Preferences.EnableLocationWise.toString(),this.Location.Visible){let l=o.d.admin.getLocationRoles(["50002",o.d.SessionManager.LangID]),h=o.d.SessionManager.LocationWhere.split(",");if(null!=l&&l.Tables.length>0&&l.Tables[0].length>0)for(let i=0;i<l.Tables[0].length;i++)(0,T.yG0)(l.Tables[0][i].IsGroup.toString())||h.length>0&&h.Contains(l.Tables[0][i][l.Columns[0][0]].toString())&&(this.Location.Items.push(D.oN.CheckedListBoxItem_6(l.Tables[0][i][l.Columns[0][2]].toString(),l.Tables[0][i][l.Columns[0][0]].toString(),!1,50002)),parseInt(this.Location.Items[this.Location.Items.length-1].Value)==o.d.SessionManager.LocationID&&(this.Location.Items[this.Location.Items.length-1].IsChecked=!0))}let a;this.Filter=new b.Q("Filter"),a=new b.u("All",-1,"Filter"),a.Group=this.Filter,a.Label=o.d.GetResource("ComLanguageAll"),this.Filter.Items.push(a),a=new b.u("Cleared",1,"Filter"),a.Group=this.Filter,a.Label=o.d.GetResource("Reports_Cleared"),this.Filter.Items.push(a),a=new b.u("Outstanding",0,"Filter"),a.Group=this.Filter,a.IsChecked=!0,a.Label=o.d.GetResource("Reports_Outstanding"),this.Filter.Items.push(a),this.Filter.IsHorizontalOrientation=!0,this.SortOn=new D.y$,this.SortOn.Label=o.d.GetResource("Reports_LblSortOn"),this.SortOn.Items.push(D._p.ComboBoxItems_2("Date","Date")),this.SortOn.Items.push(D._p.ComboBoxItems_2("Account","Account")),this.SortOn.Items.push(D._p.ComboBoxItems_2("ChequeNo","ChequeNo")),this.SortOn.Items.push(D._p.ComboBoxItems_2("ChequeDate","ChequeDate")),this.SortOn.SelectedValue="Date",this.ButtonClick.Subscribe(this,"OnButtonClick");let n=o.d.admin.GetDefaultPDC(3),s=[];if(n.Tables.length>0&&(s=n.Tables[0]),null!=s&&s.length>0&&!r.J0.IsEmpty(s[0].LastValueVouchers)){let l=new r.VB;l.LoadXml(s[0].LastValueVouchers.toString()),l.SelectNodes("XML/Row").forEach(i=>{if(this.BankAccounts.SelectedValue=parseInt(i.attributes.Bank.value),null!=i.attributes.FromDate&&(this.FromDate.Date=r.J0.ParseDate(i.attributes.FromDate.value)),null!=i.attributes.ToDate&&(this.ToDate.Date=r.J0.ParseDate(i.attributes.ToDate.value)),this.BankAccounts.SelectedValue>0&&this.onListBoxValueChanged(null),null!=i.attributes.FCChecked&&(this.ForeignCurrency.CheckBox.IsChecked=(0,T.yG0)(i.attributes.FCChecked.value),this.ForeignCurrency.ComboBox.SelectedValue=i.attributes.FCID.value),"-1"==i.attributes.Filter.value?this.Filter.Items[parseInt(i.attributes.Filter.value)+1].IsChecked=!0:"0"==i.attributes.Filter.value?this.Filter.Items[parseInt(i.attributes.Filter.value)+2].IsChecked=!0:this.Filter.Items[parseInt(i.attributes.Filter.value)].IsChecked=!0,"CHK"==i.attributes.Group.value?(this.rdoNone=!1,this.rdoChequeNo=!0,this.rdoVoucherNo=!1):"VNO"==i.attributes.Group.value?(this.rdoNone=!1,this.rdoChequeNo=!1,this.rdoVoucherNo=!0):(this.rdoNone=!0,this.rdoChequeNo=!1,this.rdoVoucherNo=!1),this.SortOn.SelectedValue=i.attributes.SortOn.value,this.Location.Visible){let c=i.attributes.Locations.value.toString().split(",");for(let u=0;u<this.Location.Items.length;u++)for(let g=0;g<c.length;g++)this.Location.Items[u].Value.toString()==c[g].toString()&&(this.Location.Items[u].IsChecked=!0)}})}Logger.InfoLog("BRSDialogViewModel:: Entering BRSDialogViewModel")}InitGrid(){this.PstBalances.CanUserAddRows=!0,this.PstBalances.CanUserDeleteRows=!0,this.PstBalances.Width="",this.PstBalances.Table=[],this.IsDateWiseBalEntry?(this.PstBalances.TableColumns.push("Date"),this.PstBalances.TableColumns.push("Date_Key"),this.PstBalances.DataTypes.Date.push("Date_Key")):(this.PstBalances.TableColumns.push("Month"),this.PstBalances.DataTypes.Int.push("Month"),this.PstBalances.TableColumns.push("Year"),this.PstBalances.DataTypes.Int.push("Year")),this.PstBalances.TableColumns.push("ID"),this.PstBalances.DataTypes.Int.push("ID"),this.PstBalances.TableColumns.push("Balance"),this.PstBalances.DataTypes.Double.push("Balance"),this.PstBalances.TableColumns.push("Status"),this.PstBalances.Columns=[];let e=null,a=[];if(this.IsDateWiseBalEntry)e=new m.O7,e.Header="Date",e.DisplayMember="Date",e.ValueMember="Date_Key",e.DataType="DATE",e.Width=130,this.PstBalances.Columns.push(e);else{e=new m.O7,e.Header=o.d.GetResource("BRSMonth"),e.ValueBinding="Month",e.Width=70,e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",a=[],a.push(D._p.ComboBoxItems_2("JAN","1")),a.push(D._p.ComboBoxItems_2("FEB","2")),a.push(D._p.ComboBoxItems_2("MAR","3")),a.push(D._p.ComboBoxItems_2("APR","4")),a.push(D._p.ComboBoxItems_2("MAY","5")),a.push(D._p.ComboBoxItems_2("JUN","6")),a.push(D._p.ComboBoxItems_2("JUL","7")),a.push(D._p.ComboBoxItems_2("AUG","8")),a.push(D._p.ComboBoxItems_2("SEP","9")),a.push(D._p.ComboBoxItems_2("OCT","10")),a.push(D._p.ComboBoxItems_2("NOV","11")),a.push(D._p.ComboBoxItems_2("DEC","12")),e.ComboData=a,this.PstBalances.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("BRSYear"),e.ValueBinding="Year",e.Width=70,e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",a=[];for(let s=o.d.SessionManager.AccountingDate.getFullYear();s<o.d.SessionManager.AccountingDate.getFullYear()+40;s++)a.push(D._p.ComboBoxItems_2(s.toString(),s.toString()));e.ComboData=a,this.PstBalances.Columns.push(e)}e=new m.O7,e.Header=o.d.GetResource("BRSBalance"),e.DisplayMember="Balance",e.Width=150,e.DataType="FLOAT",e.DecimalPoints=o.d.SessionManager.Preferences.DecimalsinAmount,this.PstBalances.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("BRSStatus"),e.ValueBinding="Status",e.Width=80,e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",a=[],a.push(D._p.ComboBoxItems_2("Open","0")),a.push(D._p.ComboBoxItems_2("Close","1")),e.ComboData=a,this.PstBalances.Columns.push(e);let n=this.PstBalances.NewRow();this.PstBalances.addRow(n)}OnDateChanged(e){var a=null;this.IsDateWiseBalEntry?(a=this.PstBalances.Table.filter(n=>n.Date_Key<=this.ToDate.Date)).SortBy([{name:"Date_Key",desc:!0}]):a=this.PstBalances.Table.filter(n=>n.Year==this.ToDate.Date.getFullYear()&&n.Month==this.ToDate.Date.getMonth()),null!=a&&a.length>0?this.BankBalance.Text=parseFloat(a[0].Balance.toString()).ToString("N"+o.d.SessionManager.Preferences.DecimalsinAmount):this.PstBalances.Table.length>0&&this.PstBalances.Table.find(n=>n.ID>0)&&(this.BankBalance.Text=(0).ToString("N"+o.d.SessionManager.Preferences.DecimalsinAmount))}onListBoxValueChanged(e){this.PstBalances.Table.Clear();let n,s=o.d.admin.BankStmtBalance(this.BankAccounts.SelectedValue,"",2,void 0);if(null!=s&&s.Tables.length>0)for(let l=0;l<s.Tables[0].length;l++){let h=this.PstBalances.NewRow();h.ID=s.Tables[0][l].ID.toString(),this.IsDateWiseBalEntry?r.J0.IsEmpty(s.Tables[0][l].Date)||1900==r.J0.ParseDate(s.Tables[0][l].Date).getFullYear()?(n=new Date(parseInt(s.Tables[0][l].Year),parseInt(s.Tables[0][l].Month),r.J0.DaysInMonth(parseInt(s.Tables[0][l].Year),parseInt(s.Tables[0][l].Month))),h.Date=n.ToString(o.d.SessionManager.Preferences["Date Format"]),h.Date_Key=n):(h.Date=r.J0.ParseDate(s.Tables[0][l].Date).ToString(o.d.SessionManager.Preferences["Date Format"]),h.Date_Key=r.J0.ParseDate(s.Tables[0][l].Date)):(h.Month=s.Tables[0][l].Month.toString(),h.Year=s.Tables[0][l].Year.toString()),h.Balance=s.Tables[0][l].Balance.toString(),h.Status=s.Tables[0][l].Status.toString(),this.PstBalances.addRow(h)}this.OnDateChanged(null);for(let l=this.PstBalances.Table.length;l<25;l++){let h=this.PstBalances.NewRow();this.PstBalances.addRow(h)}}OnLocationCheckedChanged(e){if(!this.LockCheckedChanged&&e.item instanceof D.oN){let n,a=e.item;if(n=this.Location,"All"==a.Value){this.LockCheckedChanged=!0;for(let s=1;s<n.Items.length;s++)n.Items[s].IsChecked=a.IsChecked;this.LockCheckedChanged=!1}else{if(this.LockCheckedChanged=!0,a.IsChecked){n.Items[0].IsChecked=!0;for(let s=1;s<n.Items.length;s++)if(!n.Items[s].IsChecked){n.Items[0].IsChecked=!1;break}}else n.Items[0].IsChecked=!1;this.LockCheckedChanged=!1}this.LockCheckedChanged=!1}}GetLocation(e,a){let n="";if(e.Visible){for(let s=1;s<e.Items.length;s++)e.Items[s].IsChecked&&(n.length>0&&(n+=","),n+=e.Items[s].Value);a&&(n.length>0?e.Items[0].IsChecked&&"1"==o.d.SessionManager.RoleID&&(n=""):n="-100")}return n}OnButtonClick(e){if("Cancel"==e.toString())o.d.page.HideDialog(this.PopUpGUID);else if("CancelSave"==e.toString())this.BalancesVisiblity=!1;else if("ShowBalances"==e.toString())this.BalancesVisiblity=!0;else if("Save"==e.toString()){if(0==this.BankAccounts.SelectedValue)return this.DisplayMessage=o.d.GetResource("SelectBankAccount"),void(this.MessageVisibility=!0);let a,s,n="",l=!1;for(let h=0;h<this.PstBalances.Table.length;h++)l=!1,this.IsDateWiseBalEntry?!r.J0.IsEmpty(this.PstBalances.Table[h].Date_Key)&&!r.J0.IsEmpty(this.PstBalances.Table[h].Balance)&&(l=!0):!r.J0.IsEmpty(this.PstBalances.Table[h].Month)&&!r.J0.IsEmpty(this.PstBalances.Table[h].Year)&&!r.J0.IsEmpty(this.PstBalances.Table[h].Balance)&&(l=!0),l&&(n+='<ROW ID="',r.J0.IsEmpty(this.PstBalances.Table[h].ID)?n+='0" ':n+=this.PstBalances.Table[h].ID.toString()+'" ',this.IsDateWiseBalEntry?(s=new Date(this.PstBalances.Table[h].Date_Key),n+='Date="'+s.ToString("dd MMM yyyy")+'" ',n+='Month="'+s.getMonth()+'" ',n+='Year="'+s.getFullYear()+'" '):(n+='Month="'+this.PstBalances.Table[h].Month.toString()+'" ',n+='Year="'+this.PstBalances.Table[h].Year.toString()+'" ',s=new Date(parseInt(this.PstBalances.Table[h].Year),parseInt(this.PstBalances.Table[h].Month),r.J0.DaysInMonth(parseInt(this.PstBalances.Table[h].Year),parseInt(this.PstBalances.Table[h].Month))),n+='Date="'+s.ToString("dd MMM yyyy")+'" '),n+='Status="'+this.PstBalances.Table[h].Status.toString()+'" ',n+='Balance="'+this.PstBalances.Table[h].Balance.toString()+'" />');if(n.length>0){n="<XML>"+n,n+="</XML>";let h=o.d.admin.BankStmtBalance(this.BankAccounts.SelectedValue,n.toString(),1,a);h.Tables.length>0&&h.Columns[0].Contains("ErrorMessage")&&h.Tables[0].length>0&&(this.DisplayMessage=h.Tables[0][0].ErrorMessage.toString()),this.MessageVisibility=!0}}else if("SetAsDefault"==e.toString()){let a="";a+="<XML>",a+="<Row ",a+='Bank="'+this.BankAccounts.SelectedValue+'" ',a+='FromDate="'+this.FromDate.Date.ToString("dd/MMM/yyyy")+'" ',a+='ToDate="'+this.ToDate.Date.ToString("dd/MMM/yyyy")+'" ',null!=this.ForeignCurrency&&(a+='FCChecked="'+this.ForeignCurrency.CheckBox.IsChecked+'" ',a+='FCID="'+(r.J0.IsEmpty(this.ForeignCurrency.ComboBox.SelectedValue)?"0":this.ForeignCurrency.ComboBox.SelectedValue)+'" '),a+='Filter="'+this.Filter.CheckedItem.FeatureID+'" ',a+=this.rdoNone?'Group="" ':this.rdoChequeNo?'Group="CHK" ':'Group="VNO" ',a+='Locations="'+this.GetLocation(Location,!1)+'" ',a+='SortOn="'+this.SortOn.SelectedValue+'" ',a+="/>",a+="</XML>",o.d.admin.SetDefaultPDC(a.toString(),!0,3,0)}else if("Reset"==e.toString())o.d.admin.SetDefaultPDC("",!0,3,0),this.BankAccounts.SelectedValue=0,this.Location.Items.length>0&&this.Location.Items.forEach(n=>{n.IsChecked=!1});else if("OK"==e.toString())try{if(0==this.BankAccounts.SelectedValue)return this.DisplayMessage=o.d.GetResource("SelectBankAccount"),void(this.MessageVisibility=!0);if(this.DisplayMessage=this.BankBalance.ValidateData(),""!=this.DisplayMessage)return void(this.MessageVisibility=!0);this.DisplayMessage="",this.MessageVisibility=!1,this.IsQuit=!1,this.IsOK=!0,this.GroupByColumn=this.rdoNone?"":this.rdoChequeNo?"CHK":"VNO",o.d.page.HideDialog(this.PopUpGUID)}catch{}}OnDateRangesSelectionChanged(e){null!=this.DateRanges.SelectedValue&&k.w.SetDateRanges(this.DateRanges.SelectedValue,this.FromDate,this.ToDate)}OnForeignCurrencySelectionChanged(e){this.ForeignCurrency.ComboBox.Enable=!this.ForeignCurrency.ComboBox.Enable}}var R=d(11798),t=d(96598),A=d(43357),J=d(67700),j=d(96336);function W(S,e){if(1&S&&(t.j41(0,"div",6),t.EFF(1,"\n                    "),t.j41(2,"fieldset",24),t.EFF(3,"\n                        "),t.j41(4,"legend"),t.EFF(5,"Location"),t.k0s(),t.EFF(6,"\n                        "),t.j41(7,"div",25),t.EFF(8,"\n                            "),t.eu8(9,9),t.EFF(10,"\n                        "),t.k0s(),t.EFF(11,"\n                    "),t.k0s(),t.EFF(12,"\n                "),t.k0s()),2&S){const a=t.XpG();t.R7$(9),t.Y8G("obj",a.obj.Location)}}function K(S,e){if(1&S){const a=t.RV6();t.j41(0,"div",19),t.EFF(1,"\n                    "),t.j41(2,"div",20),t.EFF(3,"\n                        "),t.j41(4,"button",21),t.bIt("click",function(){t.eBV(a);const s=t.XpG(2);return t.Njj(s.obj.OnButtonClick("Save"))}),t.nrm(5,"i",33),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.EFF(8,"\n                        "),t.j41(9,"button",22),t.bIt("click",function(){t.eBV(a);const s=t.XpG(2);return t.Njj(s.obj.OnButtonClick("CancelSave"))}),t.nrm(10,"i",23),t.EFF(11),t.nI1(12,"translate"),t.k0s(),t.EFF(13,"\n                    "),t.k0s(),t.EFF(14,"\n                "),t.k0s()}2&S&&(t.R7$(6),t.JRh(t.bMT(7,2,"Save")),t.R7$(5),t.JRh(t.bMT(12,4,"Cancel")))}function H(S,e){if(1&S){const a=t.RV6();t.j41(0,"div",26),t.EFF(1,"\n                "),t.j41(2,"div",27),t.EFF(3,"\n                    "),t.j41(4,"label",28),t.EFF(5,"\n                        Balances  \n                    "),t.k0s(),t.EFF(6,"\n                "),t.k0s(),t.EFF(7,"\n                "),t.j41(8,"div",29),t.EFF(9,"\n                "),t.j41(10,"label",30),t.EFF(11),t.k0s(),t.EFF(12,"\n                "),t.j41(13,"input",31),t.mxI("ngModelChange",function(s){t.eBV(a);const l=t.XpG();return t.DH7(l.obj.BankAccounts.Text,s)||(l.obj.BankAccounts.Text=s),t.Njj(s)}),t.k0s(),t.EFF(14,"\n\n                "),t.j41(15,"div",29),t.EFF(16,"\n                    "),t.eu8(17,9),t.EFF(18,"        \n                "),t.k0s(),t.EFF(19,"\n\n                "),t.DNE(20,K,15,6,"div",32),t.EFF(21,"\n                \n            "),t.k0s(),t.EFF(22,"\n           \n\n\n            "),t.k0s()}if(2&S){const a=t.XpG();t.R7$(11),t.JRh(a.obj.BankAccounts.Label),t.R7$(2),t.R50("ngModel",a.obj.BankAccounts.Text),t.R7$(4),t.xc7("width",100,"%"),t.Y8G("obj",a.obj.PstBalances),t.R7$(3),t.Y8G("ngIf",a.obj.BalancesVisiblity)}}let G=(()=>{class S{constructor(){this.form=new R.gE({}),console.log(this.obj)}ngOnInit(){Array.from(document.getElementsByClassName("modal-dialog")).forEach(a=>{a.classList.add("modal-dialog-Override")})}static{this.\u0275fac=function(n){return new(n||S)}}static{this.\u0275cmp=t.VBU({type:S,selectors:[["app-brsdialog"]],inputs:{obj:"obj"},standalone:!1,decls:142,vars:49,consts:[[1,"master-screen",2,"padding-bottom","4px"],[1,"PACTHeaderFields","dialogSubBody"],[2,"display","flex"],[1,"row","form-row",2,"display","block","flex-direction","column"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"row"],[1,"form-group","row","form-row","col-xl-4","col-md-4","col-sm-12","col-xs-12","PACTControl",2,"padding-right","5px !important"],[1,"form-group","row","form-row","col-xl-4","col-md-4","col-sm-12","col-xs-12","PACTControl","select-no-border",2,"margin-top","6px"],["FieldDirective","",3,"obj"],[1,"row",2,"display","flex","justify-content","center","align-items","center"],[1,"form-group","row","form-row","col-xl-6","col-md-6","col-sm-12","col-xs-12","PACTControl"],[1,"form-group","row","form-row","col-xl-6","col-md-6","col-sm-12","col-xs-12","PACTControl",2,"margin-top","-10px"],[2,"display","flex","justify-content","space-between"],[1,"form-group","divRadio",2,"display","table-cell"],["type","radio","name","RDOGROUP",3,"change","checked","value"],[1,"input_cntrl_label",3,"click"],["class","row",4,"ngIf"],["style","flex-direction: column; width: 420px; margin-left: 10px; padding-left: 15px; border-left:solid 1px gray",4,"ngIf"],[1,"Pactdailogfooter"],[2,"display","flex","flex-direction","inherit","flex","auto"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"],[2,"width","100%"],[1,"form-group","row","form-row","col-xl-6","col-md-6","col-sm-12","col-xs-12","PACTControl",2,"margin-top","-17px"],[2,"flex-direction","column","width","420px","margin-left","10px","padding-left","15px","border-left","solid 1px gray"],[1,"page-header"],[1,"page-title",2,"padding-left","1px","margin-left","-3px"],[1,"form-group","row","form-row","col","PACTControl"],[1,"input_cntrl_label"],["type","text",2,"margin-bottom","15px",3,"ngModelChange","ngModel"],["class","Pactdailogfooter",4,"ngIf"],[1,"fa-light","fa-floppy-disk"]],template:function(n,s){1&n&&(t.j41(0,"div",0),t.EFF(1,"\n    "),t.j41(2,"div",1),t.EFF(3,"\n        "),t.j41(4,"div",2),t.EFF(5,"\n            "),t.j41(6,"div",3),t.EFF(7,"\n                "),t.j41(8,"div",4),t.EFF(9,"\n                    "),t.eu8(10,5),t.EFF(11,"\n                "),t.k0s(),t.EFF(12,"\n                "),t.j41(13,"div",6),t.EFF(14,"\n                    "),t.j41(15,"div",7),t.EFF(16,"\n                        "),t.eu8(17,5),t.EFF(18,"\n                    "),t.k0s(),t.EFF(19,"\n                    "),t.j41(20,"div",7),t.EFF(21,"\n                        "),t.eu8(22,5),t.EFF(23,"\n                    "),t.k0s(),t.EFF(24,"\n                    "),t.j41(25,"div",8),t.EFF(26,"\n                        "),t.eu8(27,9),t.EFF(28,"\n                    "),t.k0s(),t.EFF(29,"\n                "),t.k0s(),t.EFF(30,"\n    \n                "),t.j41(31,"div",10),t.EFF(32,"\n                    "),t.j41(33,"div",11),t.EFF(34,"                    \n                        "),t.eu8(35,9),t.EFF(36,"\n                    "),t.k0s(),t.EFF(37,"\n                    "),t.j41(38,"div",12),t.EFF(39,"\n                        "),t.eu8(40,9),t.EFF(41,"\n                    "),t.k0s(),t.EFF(42,"\n                "),t.k0s(),t.EFF(43,"\n                "),t.j41(44,"div",6),t.EFF(45,"\n                    "),t.j41(46,"div",4),t.EFF(47,"\n                        "),t.eu8(48,9),t.EFF(49,"\n                    "),t.k0s(),t.EFF(50,"\n                "),t.k0s(),t.EFF(51,"\n                "),t.j41(52,"div",6),t.EFF(53,"\n                    "),t.j41(54,"div",4),t.EFF(55,"\n                        "),t.j41(56,"fieldset",13),t.EFF(57,"\n                            "),t.j41(58,"legend"),t.EFF(59),t.nI1(60,"translate"),t.k0s(),t.EFF(61,"\n                            "),t.j41(62,"div",14),t.EFF(63,"\n                                "),t.j41(64,"input",15),t.bIt("change",function(){return s.obj.rdoNone=!s.obj.rdoNone}),t.k0s(),t.EFF(65,"\n                                "),t.j41(66,"label",16),t.bIt("click",function(){return s.obj.rdoNone=!0}),t.EFF(67),t.nI1(68,"translate"),t.k0s(),t.EFF(69,"\n                            "),t.k0s(),t.EFF(70,"\n                            "),t.j41(71,"div",14),t.EFF(72,"\n                                "),t.j41(73,"input",15),t.bIt("change",function(){return s.obj.rdoChequeNo=!s.obj.rdoChequeNo}),t.k0s(),t.EFF(74,"\n                                "),t.j41(75,"label",16),t.bIt("click",function(){return s.obj.rdoChequeNo=!0}),t.EFF(76),t.nI1(77,"translate"),t.k0s(),t.EFF(78,"\n                            "),t.k0s(),t.EFF(79,"\n                            "),t.j41(80,"div",14),t.EFF(81,"\n                                "),t.j41(82,"input",15),t.bIt("change",function(){return s.obj.rdoVoucherNo=!s.obj.rdoVoucherNo}),t.k0s(),t.EFF(83,"\n                                "),t.j41(84,"label",16),t.bIt("click",function(){return s.obj.rdoVoucherNo=!0}),t.EFF(85),t.nI1(86,"translate"),t.k0s(),t.EFF(87,"\n                            "),t.k0s(),t.EFF(88,"\n                        "),t.k0s(),t.EFF(89,"\n                    "),t.k0s(),t.EFF(90,"\n                "),t.k0s(),t.EFF(91,"\n    \n                "),t.DNE(92,W,13,1,"div",17),t.EFF(93,"\n    \n                "),t.j41(94,"div",6),t.EFF(95,"\n                   \n                        "),t.j41(96,"div",4),t.EFF(97,"\n                            "),t.eu8(98,9),t.EFF(99,"\n                        "),t.k0s(),t.EFF(100,"\n                     \n                "),t.k0s(),t.EFF(101,"\n    \n                "),t.j41(102,"div",6),t.EFF(103,"\n                    "),t.j41(104,"div",4),t.EFF(105,"\n                        "),t.eu8(106,9),t.EFF(107,"\n                    "),t.k0s(),t.EFF(108,"\n                "),t.k0s(),t.EFF(109,"\n            "),t.k0s(),t.EFF(110,"\n\n            "),t.DNE(111,H,23,6,"div",18),t.EFF(112,"\n        "),t.k0s(),t.EFF(113,"\n    "),t.k0s(),t.EFF(114,"\n    "),t.j41(115,"div",19),t.EFF(116,"\n        "),t.j41(117,"div",20),t.EFF(118,"\n            "),t.j41(119,"button",21),t.bIt("click",function(){return s.obj.OnButtonClick("OK")}),t.EFF(120),t.nI1(121,"translate"),t.k0s(),t.EFF(122,"                \n             "),t.j41(123,"button",22),t.bIt("click",function(){return s.obj.OnButtonClick("Cancel")}),t.nrm(124,"i",23),t.EFF(125),t.nI1(126,"translate"),t.k0s(),t.EFF(127,"\n            "),t.j41(128,"button",21),t.bIt("click",function(){return s.obj.OnButtonClick("SetAsDefault")}),t.EFF(129),t.nI1(130,"translate"),t.k0s(),t.EFF(131,"\n            "),t.j41(132,"button",21),t.bIt("click",function(){return s.obj.OnButtonClick("Reset")}),t.EFF(133),t.nI1(134,"translate"),t.k0s(),t.EFF(135,"\n            "),t.j41(136,"button",21),t.bIt("click",function(){return s.obj.OnButtonClick("ShowBalances")}),t.EFF(137),t.nI1(138,"translate"),t.k0s(),t.EFF(139,"\n        "),t.k0s(),t.EFF(140,"\n    "),t.k0s(),t.EFF(141,"\n    \n"),t.k0s()),2&n&&(t.xc7("width",s.obj.IsMobile?"100%":s.obj.BalancesVisiblity?"800px":"auto"),t.R7$(10),t.Y8G("obj",s.obj.BankAccounts)("group",s.form),t.R7$(7),t.Y8G("obj",s.obj.FromDate)("group",s.form),t.R7$(5),t.Y8G("obj",s.obj.ToDate)("group",s.form),t.R7$(5),t.Y8G("obj",s.obj.DateRanges),t.R7$(8),t.Y8G("obj",s.obj.ForeignCurrency.CheckBox),t.R7$(5),t.Y8G("obj",s.obj.ForeignCurrency.ComboBox),t.R7$(8),t.Y8G("obj",s.obj.Filter),t.R7$(11),t.JRh(t.bMT(60,31,"Group")),t.R7$(5),t.Y8G("checked",s.obj.rdoNone)("value",s.obj.rdoNone),t.R7$(3),t.JRh(t.bMT(68,33,"None")),t.R7$(6),t.Y8G("checked",s.obj.rdoChequeNo)("value",s.obj.rdoChequeNo),t.R7$(3),t.JRh(t.bMT(77,35,"ChequeNo")),t.R7$(6),t.Y8G("checked",s.obj.rdoVoucherNo)("value",s.obj.rdoVoucherNo),t.R7$(3),t.JRh(t.bMT(86,37,"VoucherNo")),t.R7$(7),t.Y8G("ngIf",s.obj.Location.Visible),t.R7$(6),t.Y8G("obj",s.obj.SortOn),t.R7$(8),t.Y8G("obj",s.obj.BankBalance),t.R7$(5),t.Y8G("ngIf",s.obj.BalancesVisiblity),t.R7$(9),t.JRh(t.bMT(121,39,"Com_OK")),t.R7$(5),t.JRh(t.bMT(126,41,"Cancel")),t.R7$(4),t.JRh(t.bMT(130,43,"Set As Default")),t.R7$(4),t.JRh(t.bMT(134,45,"Reset")),t.R7$(4),t.JRh(t.bMT(138,47,"Balances")))},dependencies:[A.bT,J._,R.me,R.BC,R.vS,j.D9],styles:[".modal-dialog[_ngcontent-%COMP%]{overflow-y:unset!important}"]})}}return S})();var Y=d(61301),P=d(31503),q=d(69883),$=d(42070),X=d(80197),U=d(12229);class E extends M.g{get DetailsVisibility(){return this._DetailsVisibility}set DetailsVisibility(e){e!=this._DetailsVisibility&&(this._DetailsVisibility=e,this.ClearanceVisibility=!e)}get CanClick(){return this._CanClick}set CanClick(e){e!=this._CanClick&&(this._CanClick=e)}get ClearanceVisibility(){return this._ClearanceVisibility}set ClearanceVisibility(e){e!=this._ClearanceVisibility&&(this._ClearanceVisibility=e)}get ClearanceDate(){return this._ClearanceDate}set ClearanceDate(e){e!=this._ClearanceDate&&(this._ClearanceDate=e)}get Status(){return this._Status}set Status(e){e!=this._Status&&(this._Status=e)}get SelectedVoucher(){return this._SelectedVoucher}set SelectedVoucher(e){e!=this._SelectedVoucher&&(this._SelectedVoucher=e)}get SubTitle(){return this._SubTitle}set SubTitle(e){e!=this._SubTitle&&(this._SubTitle=e)}get Table(){return this._Table}set Table(e){e!=this._Table&&(this._Table=e)}constructor(e){super(),this.ButtonClick=new B.Yk,this.ClearanceInfo=new B.Yk,this._DetailsVisibility=!0,this._CanClick=!0,this._ClearanceVisibility=!1,this._ClearanceDate=new y.Lc(0),this._Status=new D.y$,this.oReportViewModel=null,this.GroupChequeNos=!1,this.dvStatus=null,this.Locations="",this.tempcol=[],this.workerloadData=new B.dp,this.DontPopulateClearanceDate=!1,this.NetClearedBalance=0,this.outdr=0,this.outcr=0,this.Netcr=0,this.Netdr=0,this.LockWhere="",this.ClassName="BRSViewModel",this.Title=this.ScreenName=e,this.Title=this.ScreenName,this.BRSViewModel(e)}BRSViewModel(e){Logger.InfoLog("BRSViewModel::Entering BRSViewModel"),o.d.SessionManager.IsWebApplication&&(this.BRDDialog=new v,this.BRDDialog.BRSDialogViewModel(),o.d.page.ShowDialog(this.BRDDialog,G,{ShowCenter:!o.d.IsMobile,NoWidth:!0,Title:o.d.GetResource("Reports_BankReconciliation")}).subscribe(()=>{this.BRDDialog.IsOK&&(this.DetailsVisibility=!0,this.Title=this.ScreenName=e,this.MessageVisibility=!1,this.DisplayMessage="",this.ButtonClick.Subscribe(this,"OnButtonClick"),this.ClearanceInfo.Subscribe(this,"onClearanceInfo"),this.Title=this.ScreenName,this.DisplayName=this.ScreenName,this.ClearanceDate.Label="Clearance Date",this.InitControls())})),Logger.InfoLog("BRSViewModel::Exiting BRSViewModel")}onClick(){null!=this.BRSGrid.SelectedItem&&!r.J0.IsEmpty(this.BRSGrid.SelectedItem.CostCenterID)&&Y.RibbonExtViewModel.LoadDocument(this.BRSGrid.SelectedItem)}InitControls(){let e;this.NetBalance=new f.D,this.OutStandingDr=new f.D,this.OutStandingCr=new f.D,this.NetClearBalance=new f.D,this.Difference=new f.D,this.BankBalance=new f.D,this.NetBalance.Label=o.d.GetResource("LedgerBalance"),this.OutStandingDr.Label=o.d.GetResource("Reports_OutStandingDr"),this.OutStandingCr.Label=o.d.GetResource("Reports_OutStandingCr"),this.NetClearBalance.Label=o.d.GetResource("ReconciledBankBalance"),this.Difference.Label=o.d.GetResource("Variance"),this.BankBalance.Label=o.d.GetResource("EnteredStatementBalance"),this.BRSGrid=new I.vv,this.BRSGrid.Columns=[],this.BRSGrid.BeginEdit.Subscribe(this,"OnBeginEdit"),this.BRSGrid.CanUserSortColumns=!1,this.BRSGrid.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.BRSGrid.Width="810",this.BRSGrid.CalcTotalsOnDataView=!0,this.BRSGrid.Height=void 0,this.tempcol=[];let a=[];if(o.d.SessionManager.Preferences.ContainsKey("BRS Screen Widths")&&""!=o.d.SessionManager.Preferences["BRS Screen Widths"]){let i=new r.VB;i.LoadXml(o.d.SessionManager.Preferences["BRS Screen Widths"]);for(let c=0;c<i.DocumentElement.childNodes.length;c++){let u=i.DocumentElement.children[c];"CHECKBOX"==u.attributes.Header.value?"DontPopulateClearanceDate"==u.attributes.Name.value&&(this.DontPopulateClearanceDate=1==parseInt(u.attributes.WIDTH.value)):(e=new m.O7,e.Header=u.attributes.Header.value,e.DisplayMember=u.attributes.Name.value,e.DisplayIndex=parseInt(u.attributes.index.value),e.Width=parseInt(u.attributes.WIDTH.value),this.tempcol.push(e))}}e=new m.O7,e.Header=o.d.GetResource("Service_Sno"),e.DisplayMember="sno",e.ReadOnly=!0,e.Width=45;let n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember);null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Service_Date"),e.DisplayMember="CDate",e.DataType="DATE",e.ReadOnly=!0,e.Width=85,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.DisplayMember="VoucherNo",e.Header=o.d.GetResource("VPDesigner_VNo"),e.DataType="LINK",e.Click.Subscribe(this,"onClick"),e.Width=160,e.ReadOnly=!0,e.IsVisible=!0,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Ticket_Account"),e.DisplayMember="Account",e.ReadOnly=!0,e.Width=160,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("AssetManagement_Narration"),e.DisplayMember="CommonNarration",e.ReadOnly=!0,e.Width=160,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Service_ChequeNo"),e.DisplayMember="ChequeNo",e.ReadOnly=!0,e.Width=90,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Service_ChequeDate"),e.DisplayMember="ChqDate",e.DataType="DATE",e.ReadOnly=!0,e.Width=90,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Amount_Dr"),e.DisplayMember="Dr",e.ReadOnly=!0,e.DataType="FLOAT",e.IsCalculated=1,e.ShowTotal=!0,e.Width=100,e.DecimalPoints=o.d.SessionManager.Preferences.DecimalsinAmount,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Amount_Cr"),e.DisplayMember="Cr",e.ReadOnly=!0,e.DataType="FLOAT",e.IsCalculated=1,e.ShowTotal=!0,e.DecimalPoints=o.d.SessionManager.Preferences.DecimalsinAmount,e.Width=100,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e);let s=[];s.Columns=[],s.Columns.push("Name"),s.Columns.push("Value"),s.Columns.push("Status");let l=[];l.Name=o.d.GetResource("Reports_Outstanding"),l.Value=0,s.push(l),l=[],l.Name=o.d.GetResource("Reports_Cleared"),l.Value=1,s.push(l),l=[],l.Name=o.d.GetResource("Reports_AlreadyCleared"),l.Value=2,s.push(l),this.dvStatus=s,e=new m.O7,e.Header=o.d.GetResource("Document_Status"),e.ValueBinding="Status",e.DataType="PactComboBox",e.DisplayMember="Name",e.ValueMember="Value",e.Width=90,e.ComboData=s,n=this.tempcol.find(i=>i.DisplayMember==e.ValueBinding),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Reports_ClearanceDate"),e.DisplayMember="clrDate",e.ValueMember="clrDate_Key",e.DataType="DATE",e.ReadOnly=!1,e.Width=105,n=this.tempcol.find(i=>i.DisplayMember==e.DisplayMember),null!=n?(e.DisplayIndex=n.DisplayIndex,e.Width=n.Width):this.tempcol.length>0&&(e.IsVisible=!1),this.BRSGrid.Columns.push(e),this.LoadData(!0),a=this.BRSGrid.Columns,a.sort((i,c)=>i.DisplayIndex-c.DisplayIndex),this.BRSGrid.SearchVisible=!0,this.BRSGrid.FilterVisible=!0,this.BRSGrid.AddSearchCols()}OnBeginEdit(e){let a=e.args.item;if(o.d.SessionManager.Preferences.ContainsKey("BRSFromDate")&&""!=o.d.SessionManager.Preferences.BRSFromDate&&o.d.SessionManager.Preferences.ContainsKey("BRSToDate")&&""!=o.d.SessionManager.Preferences.BRSToDate&&!r.J0.IsEmpty(a.CDate_Key)&&r.J0.ParseDate(a.CDate_Key)>=r.J0.ParseDate(o.d.SessionManager.Preferences.BRSFromDate)&&r.J0.ParseDate(a.CDate_Key)<=r.J0.ParseDate(o.d.SessionManager.Preferences.BRSToDate))e.args.Cancel=!0;else{if(!r.J0.IsEmpty(a.ClearanceDate)){var n;if(null!=(n=this.BRDDialog.PstBalances.Table.filter(this.BRDDialog.IsDateWiseBalEntry?s=>1==s.Status&&s.Date_Key==r.J0.ParseDate(a.ClearanceDate).Date():s=>1==s.Status&&s.Month==r.J0.ParseDate(a.ClearanceDate).iMonth()&&s.Year==r.J0.ParseDate(a.ClearanceDate).getFullYear()))&&n.length>0)return void(e.args.Cancel=!0)}if("DataGridPactComboBoxColumn"==e.args.column.className){if("Status"==e.args.column.field){if(e.args.column.DataGridColumn.ItemsSource=this.dvStatus,"3"==a.BRS_Status.toString()||"1"==a.IsLock.toString())return void(e.args.Cancel=!0);e.args.column.DataGridColumn.ItemsSource=!r.J0.IsEmpty(a.ClearanceDate)&&r.J0.ParseDate(a.ClearanceDate)>this.BRDDialog.ToDate.Date&&"1"==a.BRS_Status.toString()?e.args.column.DataGridColumn.ItemsSource.filter(h=>2==h.Value):e.args.column.DataGridColumn.ItemsSource.filter(h=>1==h.Value||0==h.Value)}}else if(!("DataGridDateColumn"!=e.args.column.className&&"DataGridDateTimeColumn"!=e.args.column.className||"3"!=a.BRS_Status.toString()&&"1"!=a.IsLock.toString()))return void(e.args.Cancel=!0)}}Setselectedrow(e){this.BRSGrid.SelectedItem=this.BRSGrid.Table[e]}OnButtonClick(e){if(this.DisplayMessage="",e instanceof KeyboardEvent){if(e.keyCode==U.FG.SPACE&&"PACT.VIEW.PactGridView"==e.toString()&&null!=this.BRSGrid.SelectedItem&&"2"!=this.BRSGrid.SelectedItem.Status_Key.toString()&&"1"!=this.BRSGrid.SelectedItem.IsLock.toString()){if(o.d.SessionManager.Preferences.ContainsKey("BRSFromDate")&&""!=o.d.SessionManager.Preferences.BRSFromDate&&o.d.SessionManager.Preferences.ContainsKey("BRSToDate")&&""!=o.d.SessionManager.Preferences.BRSToDate&&""!=this.BRSGrid.SelectedItem.CDate_Key.toString()&&r.J0.ParseDate(this.BRSGrid.SelectedItem.CDate_Key)>=r.J0.ParseDate(o.d.SessionManager.Preferences.BRSFromDate)&&r.J0.ParseDate(this.BRSGrid.SelectedItem.CDate_Key)<=r.J0.ParseDate(o.d.SessionManager.Preferences.BRSToDate))return;if(""!=this.BRSGrid.SelectedItem.ClearanceDate.toString()){var a;if(null!=(a=this.BRDDialog.PstBalances.Table.filter(this.BRDDialog.IsDateWiseBalEntry?s=>1==s.Status&&s.Date_Key==r.J0.ParseDate(this.BRSGrid.SelectedItem.ClearanceDate).Date():s=>1==s.Status&&s.Month==r.J0.ParseDate(this.BRSGrid.SelectedItem.ClearanceDate).iMonth()&&s.Year==r.J0.ParseDate(this.BRSGrid.SelectedItem.ClearanceDate).getFullYear()))&&a.length>0)return}"1"==this.BRSGrid.SelectedItem.Status.toString()?(this.BRSGrid.SelectedItem.Status=0,this.BRSGrid.SelectedItem.Status_Key=o.d.GetResource("Reports_Outstanding")):(this.BRSGrid.SelectedItem.Status=1,this.BRSGrid.SelectedItem.Status_Key=o.d.GetResource("Reports_Cleared")),this.BRSGrid.updateRow(this.BRSGrid.SelectedItem)}}else{let s=e.toString();if("Save"==s.toString())this.Save();else if("Set"==s)this.Status.Items.Clear(),this.Status.Label="Status",this.Status.Items.push(D._p.ComboBoxItems_2(o.d.GetResource("Reports_Outstanding"),"0")),this.Status.Items.push(D._p.ComboBoxItems_2(o.d.GetResource("Reports_Cleared"),"1")),this.Status.Items.push(D._p.ComboBoxItems_2(o.d.GetResource("Reports_AlreadyCleared"),"2")),this.Status.SelectedValue=this.Status.Items[0].Value,this.DetailsVisibility=!1,this.ClearanceVisibility=!0;else if("DELETE"!=s)if("CLEAR"==s)this.BRSGrid.Table.forEach(l=>{l!=this.BRSGrid.Table[0]&&(""==l.Status.toString()||"0"==l.Status.toString())&&(l.Status="1",l.Status_Key=o.d.GetResource("Reports_Cleared"),l.clrDate_Key=l.Date,l.clrDate=r.J0.ParseDate(l.Date).ToString(o.d.SessionManager.Preferences["Date Format"]),this.BRSGrid.updateRow(l))});else if("Report"==s||"Preview"==s){null==this.oReportViewModel?(this.oReportViewModel=new L.ReportViewModel,this.oReportViewModel.ReportViewModel_1(72),o.d.page.addNewTab({component:P.ReportViewComponent,params:{obj:this.oReportViewModel}})):o.d.page.addNewTab({component:P.ReportViewComponent,params:{obj:this.oReportViewModel}}),this.oReportViewModel.oReportDialog.FromDate.Date=this.BRDDialog.FromDate.Date,this.oReportViewModel.oReportDialog.ToDate.Date=this.BRDDialog.ToDate.Date,this.oReportViewModel.FromDatePicker=this.BRDDialog.FromDate,this.oReportViewModel.ToDatePicker=this.BRDDialog.ToDate,this.oReportViewModel.DateFilter=this.SubTitle,this.oReportViewModel.oReportDialog.DefaultProperties.forEach(c=>{c instanceof V.y$?c.SelectedValue=this.BRDDialog.BankAccounts.SelectedValue:"ForeignCurrency"==c.DBColumnName&&(c.CheckBox.IsChecked=this.BRDDialog.ForeignCurrency.CheckBox.IsChecked,c.ComboBox.SelectedValue=this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue)}),this.BRDDialog.Location.Visible&&this.oReportViewModel.oReportDialog.Locations.Visible&&50002==this.oReportViewModel.oReportDialog.Locations.DBColumnID&&this.oReportViewModel.oReportDialog.Locations.Items.forEach(c=>{c.IsChecked=null!=this.BRDDialog.Location.Items.filter(u=>u.Value==c.Value&&u.IsChecked)});let l=new $.ACC_BRSReport(this.oReportViewModel);l.BankID=this.BRDDialog.BankAccounts.SelectedValue,l.DateWiseDrCr=!1;let h=0;this.BRDDialog.ForeignCurrency.CheckBox.IsChecked&&(h=r.J0.IsEmpty(this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue)?0:parseInt(this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue)),this.oReportViewModel.ShowReport=!0;let i=new r.M4;i.Enabled=!0,l.ViewModel.Preferences.ContainsKey("GroupBy")?l.ViewModel.Preferences.GroupBy=this.BRDDialog.GroupByColumn:l.ViewModel.Preferences.push("GroupBy",this.BRDDialog.GroupByColumn),l.ViewModel.Preferences.ContainsKey("Preview")&&l.ViewModel.Preferences.Remove("Preview"),"Preview"==s?(this.oReportViewModel.RefreshVisibility=!1,l.ViewModel.Preferences.push("Preview","true"),l.dtpreview=this.BRSGrid.Table.Copy()):l.ViewModel.Preferences.push("Preview","false");var n=l.ViewModel.oReportDialog.CostCenterFilters.find(c=>2==c.CostCenterID);if(n){n.SelectedNodes.Clear();let c=null;l.ViewModel.oReportDialog.tree.length>0&&2==l.ViewModel.oReportDialog.tree[0].CostCenterID&&(c=l.ViewModel.oReportDialog.tree[0].AllNodes.find(u=>u.Id==l.BankID)),c||(c=new q.n,c.Id=l.BankID,c.Text=[],c.Text.push("[FILTER]")),n.SelectedNodes.push(c),n.RefreshSelectedNodesText()}l.LoadReportFromData(l.BankID,h),this.oReportViewModel.StaticReportObject=l,i.Enabled=!1,Logger.InfoLog("OnButtonClick::Report::"+i.Elapsed.toString())}else if("Regenerate"==s)this.BRDDialog.IsOK=!1,this.DetailsVisibility=!0,o.d.page.ShowDialog(this.BRDDialog,G,{ShowCenter:!o.d.IsMobile,NoWidth:!0,Title:o.d.GetResource("Reports_BankReconciliation")}).subscribe(()=>{this.BRDDialog.IsOK&&this.LoadData(!1)});else if("Refresh"==s)this.LoadData(!1);else if("Read"==s)this.onReadFile();else if("Export"==s){this.MessageVisibility=!0,this.DisplayMessage="Exporting data please wait...";let l=this.GetExportHTML(!1);const h=new Blob([l],{type:"text/plain;charser=utf-8"});X.saveAs(h,this.ScreenName+"_XlsExport_"+(new Date).getTime()+".xls")}}}onReadFile(){}OnCellEditEnding(e,a,n){if(a=e.column.field,e=e.item,"clrDate"==a)r.J0.IsEmpty(e.clrDate_Key)?(e.Status_Key=o.d.GetResource("Reports_Outstanding"),e.Status="0"):(e.Status_Key=o.d.GetResource("Reports_Cleared"),e.Status="1"),this.BRSGrid.updateRow(e);else if(("Status_Key"==a||r.J0.hasprop(e,"Status_Key"))&&!r.J0.IsEmpty(e.Status))if(0==parseInt(e.Status.toString())||this.DontPopulateClearanceDate){if(!r.J0.IsEmpty(e.clrDate_Key))return;e.clrDate_Key=null,e.clrDate=""}else 1==parseInt(e.Status.toString())&&r.J0.IsEmpty(e.clrDate_Key)&&(e.clrDate_Key=e.Date,e.clrDate=r.J0.ParseDate(e.Date).ToString(o.d.SessionManager.Preferences["Date Format"]));this.RefreshBalances()}onClearanceInfo(e){if(null!=e)if("Clearance"==e.toString()){if(null!=this.BRSGrid.SelectedRows&&this.BRSGrid.SelectedRows.length>1)for(let n=0;n<this.BRSGrid.SelectedRows.length;n++){const s=this.BRSGrid.SelectedRows[n];if(null!=s){let l=s.Row;if("2"!=l.Status.toString()){l.Status=this.Status.SelectedValue;let h=parseInt(this.Status.SelectedValue);l.Status_Key=this.Status.Items[h].Name,l.clrDate_Key=this.ClearanceDate.Date,l.clrDate=r.J0.ParseDate(this.ClearanceDate.Date).ToString(o.d.SessionManager.Preferences["Date Format"]),this.BRSGrid.updateRow(l),this.RefreshBalances()}}}this.DetailsVisibility=!0}else this.DetailsVisibility=!0}workerloadData_RunWorkerCompleted(e,a){this.DisplayName=this.Title,this.CanClick=!0}LoadData(e){if(!o.d.SessionManager.IsActionAssigned(43,"Override BRS Lock")&&""==this.LockWhere&&"true"==o.d.SessionManager.Preferences.UseDimWiseLock.toLowerCase()&&""!=o.d.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]&&"<XML></XML>"!=o.d.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]){let n=0,s=new r.VB;s.LoadXml(o.d.SessionManager.Preferences["DimensionWiseLockData Customize Screen"]);for(let l=0;l<s.SelectNodes("XML/Row").length;l++){let h=s.SelectNodes("XML/Row")[l];if(null!=h.attributes.ID&&!r.J0.IsEmpty(h.attributes.ID.Value))if(n=parseInt(h.attributes.ID.Value),n>5e4)this.LockWhere+=" and (CC.dcCCNID"+(n-5e4)+"=c.CCNID"+(n-5e4)+" or c.CCNID"+(n-5e4)+"=1)";else{if(3==n)continue;2==n?this.LockWhere+=" and (D.DebitAccount=c.AccountID or D.CreditAccount=c.AccountID or c.AccountID=1)":400==n&&(this.LockWhere+=" and (D.CostCenterID=c.DocumentID or c.DocumentID=1)")}}}this.NetClearedBalance=0,this.outdr=0,this.outcr=0,this.Netcr=0,this.Netdr=0;let a=[];a.push(this.BRDDialog.BankAccounts.SelectedValue),a.push(r.J0.String(this.BRDDialog.Filter.CheckedItem.FeatureID)),a.push(this.BRDDialog.FromDate.Date.ToString("dd/MMM/yyyy")),a.push(this.BRDDialog.ToDate.Date.ToString("dd/MMM/yyyy")),r.J0.String(this.BRDDialog.Location.Visible)?a.push(this.BRDDialog.GetLocation(this.BRDDialog.Location,!1)):a.push(""),a.push(this.BRDDialog.ForeignCurrency.CheckBox.IsChecked?r.J0.IsEmpty(this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue)?0:parseInt(this.BRDDialog.ForeignCurrency.ComboBox.SelectedValue):0),a.push(0),a.push(this.LockWhere),a.push(this.BRDDialog.SortOn.SelectedValue),o.d.report.GetBRSVouchers(a).then(n=>{this.ds=n,this.SubTitle=this.BRDDialog.FromDate.Date.ToString(o.d.SessionManager.Preferences["Date Format"]),this.SubTitle+="  to  "+this.BRDDialog.ToDate.Date.ToString(o.d.SessionManager.Preferences["Date Format"]),null!=this.ds&&this.ds.Tables.length>3&&this.ds.Tables[3].length>0&&(this.SubTitle+=" ["+this.ds.Tables[3][0].AccountName.toString()+"]");let s=[];if(!(null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables.length>0&&this.ds.Columns[0].Contains("VoucherNo")))return;if(s=this.ds.Tables[0],e&&null!=this.ds&&this.ds.Tables.length>0&&this.ds.Columns[0].length>16)for(let i=17;i<this.ds.Columns[0].length;i++){let c=new m.O7;var l;c.Header=this.ds.Tables[0][0][this.ds.Columns[0][i]],c.DisplayMember=this.ds.Tables[0][0][this.ds.Columns[0][i]],c.ReadOnly=!0,c.Width=160,this.ds.Columns[0][i].Contains("~")?(c.Header=this.ds.Columns[0][i].split("~")[1],null!=(l=this.tempcol.find(u=>u.DisplayMember==this.ds.Columns[0][i].split("~")[0]))?(c.DisplayIndex=l.DisplayIndex,c.Width=l.Width):this.tempcol.length>0&&(c.IsVisible=!1)):(c.Header=this.ds.Columns[0][i],null!=(l=this.tempcol.find(g=>g.DisplayMember==c.DisplayMember))?(c.DisplayIndex=l.DisplayIndex,c.Width=l.Width):this.tempcol.length>0&&(c.IsVisible=!1)),this.BRSGrid.Columns.push(c)}if(null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables.length>1&&this.ds.Columns[1].Contains("Bal")&&this.ds.Tables[1].length>0&&""!=r.J0.StringValue(this.ds.Tables[1][0])){let i=parseFloat(this.ds.Tables[1][0][this.ds.Columns[1][0]]);this.NetBalance.Text=i>=0?i.Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)+" "+o.d.GetResource("Dr"):(-i).Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)+" "+o.d.GetResource("Cr")}this.NetClearedBalance=null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables.length>2&&this.ds.Columns[2].Contains("Bal")&&this.ds.Tables[2].length>0&&!r.J0.IsEmpty(this.ds.Tables[2][0][this.ds.Columns[2][0]])?r.J0.DoubleTryParse(this.ds.Tables[2][0][this.ds.Columns[2][0]]):0,s.Columns=[],s.Columns.push("StyleIsBold"),s.Columns.push("CDate"),s.Columns.push("ChqDate"),s.Columns.push("ChqDate_Key"),s.Columns.push("sno"),s.Columns.push("Status"),s.Columns.push("Status_Key"),s.Columns.push("clrDate"),s.Columns.push("clrDate_Key"),s.Columns.push("DBStatus"),s.Columns.push("GroupIDs");for(let i=0;i<s.length;i++)if(r.J0.ParseDate(s[i].ClearanceDate).Date()>this.BRDDialog.ToDate.Date.Date()&&"1"==s[i].BRS_Status.toString()?(s[i].sno=i+1,s[i].CDate=r.J0.ParseDate(s[i].Date).ToString(o.d.SessionManager.Preferences["Date Format"]),s[i].CDate_Key=r.J0.ParseDate(s[i].Date),null!=s[i].ChequeDate&&(s[i].ChqDate=r.J0.ParseDate(s[i].ChequeDate).ToString(o.d.SessionManager.Preferences["Date Format"]),s[i].ChqDate_Key=r.J0.ParseDate(s[i].ChequeDate)),s[i].Status=2,s[i].Status_Key=o.d.GetResource("Reports_AlreadyCleared"),s[i].clrDate=r.J0.ParseDate(s[i].ClearanceDate).ToString(o.d.SessionManager.Preferences["Date Format"]),s[i].clrDate_Key=r.J0.ParseDate(s[i].ClearanceDate),s[i].DBStatus=1):(s[i].DBStatus=0,s[i].sno=i+1,s[i].CDate=r.J0.ParseDate(s[i].Date).ToString(o.d.SessionManager.Preferences["Date Format"]),s[i].CDate_Key=r.J0.ParseDate(s[i].Date),null!=s[i].ChequeDate&&(s[i].ChqDate=r.J0.ParseDate(s[i].ChequeDate).ToString(o.d.SessionManager.Preferences["Date Format"]),s[i].ChqDate_Key=r.J0.ParseDate(s[i].ChequeDate)),s[i].Status=s[i].BRS_Status,"1"==s[i].BRS_Status.toString()?s[i].Status_Key=o.d.GetResource("Reports_Cleared"):"0"==s[i].BRS_Status.toString()&&(s[i].Status_Key=o.d.GetResource("Reports_Outstanding"))),1900!=r.J0.ParseDate(s[i].ClearanceDate).getFullYear()&&"1"==s[i].Status.toString()){s[i].clrDate_Key=r.J0.ParseDate(s[i].ClearanceDate);try{s[i].clrDate=o.d.SessionManager.Preferences.ContainsKey("Date Format")&&""!=o.d.SessionManager.Preferences["Date Format"]?r.J0.ParseDate(s[i].ClearanceDate).ToString(o.d.SessionManager.Preferences["Date Format"]):r.J0.ParseDate(s[i].ClearanceDate).ToString("dd/MMM/yyyy")}catch{}}if(-1!=this.BRDDialog.Filter.CheckedItem.FeatureID){let i=s.length-1;for(;i>=0;i--)if(this.BRDDialog.Filter.CheckedItem.FeatureID!=parseInt(s[i].Status.toString())){let u=r.J0.StringValue(s[i].Dr).length>0?parseFloat(s[i].Dr):0,g=r.J0.StringValue(s[i].Cr).length>0?parseFloat(s[i].Cr):0;r.J0.IsEmpty(s[i].ClearanceDate)&&this.BRDDialog.ToDate.Date.Date()<r.J0.ParseDate(s[i].ClearanceDate).Date()||0==parseInt(s[i].Status)?(this.outcr+=g,this.outdr+=u):1==parseInt(s[i].Status)&&(this.Netcr+=g,this.Netdr+=u),0==this.BRDDialog.Filter.CheckedItem.FeatureID&&2==parseInt(s[i].Status)||s.RemoveAt(i)}}if(!this.BRDDialog.rdoNone){let i=[];for(let c=0;c<s.length;c++)if(!i.Contains(s[c])&&!this.BRDDialog.rdoNone){let C,u=0,g=0,N="",_="",w=s;if(this.BRDDialog.rdoChequeNo&&(r.J0.IsEmpty(s[c].ChequeNo)||(_="ChequeNo='"+r.J0.String(s[c].ChequeNo).Replace("'","''")+"' and ",w=s.filter(p=>p.ChequeNo==r.J0.String(s[c].ChequeNo).Replace("'","''")))),_+="VoucherNo='"+r.J0.String(s[c].VoucherNo).Replace("'","''")+"' and BRS_Status="+r.J0.String(s[c].BRS_Status),C=w.filter(p=>p.VoucherNo==r.J0.String(s[c].VoucherNo).Replace("'","''")&&p.BRS_Status==r.J0.String(s[c].BRS_Status)),C.length>1){for(let p=1;p<C.length;p++)r.J0.IsEmpty(C[p].Dr)||(g+=parseFloat(C[p].Dr.toString())),r.J0.IsEmpty(C[p].Cr)||(u+=parseFloat(C[p].Cr.toString())),N+=C[p].AccDocDetailsID.toString()+",",i.push(C[p]);C[0].GroupIDs=N,r.J0.IsEmpty(C[0].Cr)||(u=parseFloat(C[0].Cr.toString())+u),r.J0.IsEmpty(C[0].Dr)||(g=parseFloat(C[0].Dr.toString())+g),u>g?(C[0].Dr=null,C[0].Cr=u-g):(C[0].Cr=null,C[0].Dr=g-u)}}for(let c=0;c<i.length;c++)s.Remove(i[c])}this.BRSGrid.Table=s,1==this.BRDDialog.Filter.CheckedItem.FeatureID&&this.BRSGrid.Table.sort((i,c)=>i.clrDate_Key>c.clrDate_Key?1:-1),this.RefreshBalances();let h=[];h.Status=3,h.BRS_Status=3,this.NetClearedBalance>0?(h.Dr=this.NetClearedBalance.Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount),h.Cr=0):(h.Dr=0,h.Cr=this.NetClearedBalance.Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)),h.VoucherNo="Opening",h.StyleIsBold="1",this.BRSGrid.Table.InsertAt(h,0);for(let i=0;i<this.BRSGrid.Table.length;i++)this.BRSGrid.Table[i].sno=i+1,this.BRSGrid.Table[i].id=i+1;s=[]})}Save(){this.DisplayMessage="";let a,n,e="",s=0;for(let l=0;l<this.BRSGrid.Table.length;l++){const h=this.BRSGrid.Table[l];if(""!=r.J0.String(h.ClearanceDate)){if(s++,1==parseInt(r.J0.String(h.Status))&&r.J0.IsEmpty(h.clrDate_Key))return this.DisplayMessage="Clearance Date Mandatory when the Status is Cleared. Check at RowNo : "+s,void(this.MessageVisibility=!0);if(n=r.J0.ParseDate(h.ClearanceDate),""==r.J0.String(h.clrDate))a=n;else{if(a=r.J0.ParseDate(h.clrDate_Key),!r.J0.IsEmpty(h.ChqDate_Key)&&r.J0.ParseDate(h.clrDate_Key)<r.J0.ParseDate(h.ChqDate_Key))return this.DisplayMessage="Clearance Date is less than Cheque Date at RowNo : "+s,void(this.MessageVisibility=!0);if(r.J0.IsEmpty(h.ChqDate_Key)&&r.J0.ParseDate(h.clrDate_Key)<r.J0.ParseDate(h.CDate_Key))return this.DisplayMessage="Clearance Date is less than Doc Date at RowNo : "+s,void(this.MessageVisibility=!0)}if(parseInt(h.BRS_Status)!=parseInt(h.Status)||n!=a){if("2"==r.J0.String(h.Status))continue;if(("0"==r.J0.String(h.DBStatus)||"1"==r.J0.String(h.Status))&&(e+='<Row ID="'+h.AccDocDetailsID.toString()+'" Status="'+h.Status.toString()+'" Date="'+a.ToString("dd MMM yyyy")+'"/>'),!r.J0.IsEmpty(h.GroupIDs)&&!this.BRDDialog.rdoNone){let i=h.GroupIDs.toString().split(",");for(let c=0;c<i.length-1;c++)e+='<Row ID="'+i[c]+'" Status="'+h.Status.toString()+'" Date="'+a.ToString("dd MMM yyyy")+'"/>'}}}}if(e.length>0){e="<XML>"+e,e+="</XML>";let l=[];l.push(e.toString());let h=o.d.report.SetBRSVouchers(l);this.DisplayMessage=h.Message}}RefreshBalances(){let l,h,e=this.outcr,a=this.outdr,n=this.Netcr,s=this.Netdr;null!=this.BRSGrid.Table&&this.BRSGrid.Table.forEach(c=>{l=r.J0.Int(c.Dr)>0?parseFloat(c.Dr):0,h=r.J0.Int(c.Cr)>0?parseFloat(c.Cr):0,r.J0.IsEmpty(c.clrDate_Key)&&this.BRDDialog.ToDate.Date<r.J0.ParseDate(c.clrDate_Key)||0==r.J0.Int(c.Status)?(a+=l,e+=h):1==r.J0.Int(c.Status)&&(s+=l,n+=h)}),this.OutStandingDr.Text=a.Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount),this.OutStandingCr.Text=e.Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount);let i=0;r.J0.IsEmpty(this.BRDDialog.BankBalance.Text)||(i=parseFloat(this.BRDDialog.BankBalance.Text)),this.BankBalance.Text=i>0?i.Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)+" "+o.d.GetResource("Dr"):(-i).Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)+" "+o.d.GetResource("Cr"),s=this.NetClearedBalance+s-n,this.Difference.Text=i-s>0?(i-s).Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)+" "+o.d.GetResource("Dr"):(s-i).Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)+" "+o.d.GetResource("Cr"),this.NetClearBalance.Text=s>=0?s.Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)+" "+o.d.GetResource("Dr"):(-s).Commas("N"+o.d.SessionManager.Preferences.DecimalsinAmount)+" "+o.d.GetResource("Cr"),this.BRSGrid.UpdateTotals()}GetExportHTML(e){let a="",n="";a+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",n+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",n+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",n+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",n+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}",e||(a+="<style>"+n.toString()+"</style>");let l=0,h=this.BRSGrid.Table,i=this.BRSGrid.Columns;for(let c=0;c<i.length;c++)i[c].IsVisible&&i[c].Width>20&&(l+=i[c].Width);a+="<table>",a+="\r\n<tr><td align='center'><h2>",a+=o.d.SessionManager.CompanyName,a+="</h2></td></tr>",a+="\r\n<tr><td align='center'><h3 style='vertical-align:middl;'>",a+="Bank Reconciliation",a+="</h3></td></tr>",a+="\r\n<tr><td align='center'>",a+=" &nbsp;&nbsp;&nbsp;DATE :  "+(new Date).ToString(o.d.SessionManager.Preferences["Date Format"]),a+="</td></tr>",a+="<tr><td style='padding-top:10p;'><table border=1 width='"+l+"' style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",a+="<COLGROUP>";for(let c=0;c<i.length;c++)i[c].IsVisible&&i[c].Width>20&&(a+="FLOAT"==i[c].DataType?"<COL style='text-align:righ;'>":"<COL style=''>");a+="</COLGROUP>",a+="<tr style=''>";for(let c=0;c<i.length;c++)i[c].IsVisible&&i[c].Width>20&&(a+="<th class='hdr' width='"+i[c].Width,a+=e?"' >":"px' >",a+=i[c].Header,a+="</th>");a+="</tr>";for(let c=0;c<h.length;c++){a+="<tr",c%2==1&&(a+=" class=alt"),a+=">";for(let u=0;u<i.length;u++)i[u].IsVisible&&i[u].Width>20&&(a+="<td",a+="FLOAT"==i[u].DataType?" align='right'":" align='left'",a+=">",null!=i[u].ComboData&&"Status"==i[u].ValueBinding?(this.dvStatus.filter(g=>g.Value==h[c][i[u].ValueBinding].toString()),this.dvStatus.length>0&&(a+=r.J0.String(this.dvStatus[0][i[u].DisplayMember]))):a+=r.J0.String(h[c][i[u].DisplayMember]),a+="</td>");a+="</tr>"}return a+="</table>",a+="</td></tr></table>",a+="</body><html>",a}}class z extends E{BRSMatchViewModel(e){this.BRSMatchGrid=new I.vv,this.initgrid(),this.BRSMatchGrid.SearchVisible=!0,this.BRSMatchGrid.AddSearchCols(),this.LoadGrid(),this.ButtonClick.Subscribe(this,"OnButtonClick")}OnButtonClick(e){("Regenerate"==e||"Refresh"==e)&&this.LoadGrid()}initgrid(){this.BRSGrid.TableColumns.push("RefNo"),this.BRSGrid.TableColumns.push("UniqueNo"),this.BRSMatchGrid.Table=[],this.BRSMatchGrid.TableColumns.push("sno"),this.BRSMatchGrid.TableColumns.push("VoucherNo"),this.BRSMatchGrid.TableColumns.push("Account"),this.BRSMatchGrid.TableColumns.push("ChequeNo"),this.BRSMatchGrid.TableColumns.push("DocDate"),this.BRSMatchGrid.TableColumns.push("DocDate_Key"),this.BRSMatchGrid.TableColumns.push("ChequeDate"),this.BRSMatchGrid.TableColumns.push("Cr"),this.BRSMatchGrid.TableColumns.push("Dr"),this.BRSMatchGrid.TableColumns.push("CommonNarration"),this.BRSMatchGrid.TableColumns.push("DocID"),this.BRSMatchGrid.TableColumns.push("CostCenterID"),this.BRSMatchGrid.TableColumns.push("AccDocDetailsID"),this.BRSMatchGrid.TableColumns.push("ChequeDate_Key"),this.BRSMatchGrid.TableColumns.push("RefNo"),this.BRSMatchGrid.TableColumns.push("UniqueNo"),this.BRSMatchGrid.Columns=[];let e=new m.O7;e.Header=o.d.GetResource("Service_Sno"),e.DisplayMember="sno",e.ReadOnly=!0,e.Width=45,this.BRSMatchGrid.Columns.push(e),e=new m.O7,e.Header="VoucherNo",e.DisplayMember="VoucherNo",e.ReadOnly=!0,e.Width=100,this.BRSMatchGrid.Columns.push(e),e=new m.O7,e.Header="Date",e.DisplayMember="DocDate",e.ReadOnly=!0,e.Width=100,this.BRSMatchGrid.Columns.push(e),e=new m.O7,e.Header="Account",e.DisplayMember="Account",e.ReadOnly=!0,e.Width=150,this.BRSMatchGrid.Columns.push(e),e=new m.O7,e.Header="ChequeNo",e.DisplayMember="ChequeNo",e.ReadOnly=!0,e.Width=100,this.BRSMatchGrid.Columns.push(e),e=new m.O7,e.Header="ChequeDate",e.DisplayMember="ChequeDate",e.ReadOnly=!0,e.Width=100,this.BRSMatchGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Amount_Cr"),e.DisplayMember="Cr",e.ReadOnly=!0,e.DataType="FLOAT",e.ShowTotal=!0,e.DecimalPoints=o.d.SessionManager.Preferences.DecimalsinAmount,e.Width=100,e.ShowTotal=!0,e.IsCalculated=1,this.BRSMatchGrid.Columns.push(e),e=new m.O7,e.Header=o.d.GetResource("Amount_Dr"),e.DisplayMember="Dr",e.ReadOnly=!0,e.DataType="FLOAT",e.ShowTotal=!0,e.DecimalPoints=o.d.SessionManager.Preferences.DecimalsinAmount,e.Width=100,e.ShowTotal=!0,this.BRSMatchGrid.Columns.push(e),e=new m.O7,e.Header="Narration",e.DisplayMember="CommonNarration",e.ReadOnly=!0,e.Width=160,this.BRSMatchGrid.Columns.push(e)}LoadGrid(){let e=this.ds.Tables[this.ds.Tables.length-1];for(let a=0;a<e.length;a++){let n=this.BRSMatchGrid.NewRow();n.sno=a+1,r.J0.IsEmpty(e[a].ChequeDate)||(n.ChequeDate=r.J0.ParseDate(e[a].ChequeDate).ToString(o.d.SessionManager.Preferences["Date Format"]),n.ChequeDate_Key=r.J0.ParseDate(e[a].ChequeDate)),n.Cr=e[a].Cr,n.Dr=e[a].Dr,n.AccDocDetailsID=e[a].AccDocDetailsID,n.VoucherNo=e[a].VoucherNo,n.CommonNarration=e[a].CommonNarration,n.ChequeNo=e[a].ChequeNo,r.J0.IsEmpty(e[a].DocDate)||(n.DocDate=r.J0.ParseDate(e[a].DocDate),n.DocDate_Key=r.J0.ParseDate(e[a].DocDate).ToString(o.d.SessionManager.Preferences["Date Format"])),n.Account=e[a].Account,n.DocID=e[a].DocID,n.CostCenterID=e[a].CostCenterID,this.BRSMatchGrid.addRow(n)}}}}}]);