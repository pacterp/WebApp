"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[1250],{68869:(S,g,r)=>{r.r(g),r.d(g,{DuplicateUser:()=>n,TeamViewModel:()=>I,ViewColumn1:()=>h});var d=r(98580),m=r(84151),o=r(27730),a=r(32040);class I extends d.g{constructor(e,s){super(),this.Name=new m.Dw(0),this.LOSelectedIndex=-1,this.ROSelectedIndex=-1,this.LMSelectedIndex=-1,this.Status=new o.y$(0),this.RMSelectedIndex=-1,this.obj={},this.oParent=null,this.lst=[],Logger.InfoLog("TeamViewModel :: Exiting OnLoad"),this.ID=e,this.oParent=s,this.Name.Label="Name",this.obj.TeamID=this.ID,0==this.ID?(this.Title=a.d.GetResource("CreateTeam"),this.LoadData()):(this.Title=a.d.GetResource("EditTeam"),this.LoadEditData()),this.DisplayName=this.Title,Logger.InfoLog("TeamViewModel :: Exiting OnExit")}LoadEditData(){let e=[];e.push(this.ID),e.push(a.d.SessionManager.UserID),e.push(a.d.SessionManager.LanguageID);let s="?CompanyIndex="+a.d.SessionManager.CompanyIndex+"&param="+JSON.stringify(e),t=a.d.crmService.GetTeamScreenDetails(s);if(null!=t&&t.Tables.length>4&&t.Tables[5].length>0){let i=null;if(null!=t&&t.Tables.length>0){for(let l=0;l<t.Tables[0].length;l++)this.Status.Items.push(o._p.ComboBoxItems_2(t.Tables[0][l].Status.toString(),t.Tables[0][l].StatusID.toString()));this.FillOwnersLeftList(i,1,t),this.FillMembersLeftList(i,2,t),this.FillMembersRightList(i,4,t),this.FillOwnersRightList(i,3,t),t.Tables[5].length>0&&""!=t.Tables[5][0].StatusID.toString()&&(this.Status.SelectedValue=t.Tables[5][0].StatusID.toString()),t.Tables[5].length>0&&""!=t.Tables[5][0].TeamName.toString()&&(this.Name.Text=t.Tables[5][0].TeamName.toString()),this.obj.TeamID=parseInt(t.Tables[5][0].TeamID.toString())}}}Check(e){for(let s=0;s<this.lst.length;s++)if(this.lst[s].User==e)return!1;return!0}OnSave(e){if(Logger.InfoLog("TeamViewModel ::  OnSave"),0==this.Name.Text.length)this.MessageVisibility=!0,this.DisplayMessage="Team Name cannot be empty";else{this.obj.Name=this.Name.Text,this.obj.Status=parseInt(this.Status.SelectedValue);let t,s="";s+="<XML>";for(let l=0;l<this.lstOwnersRight.length;l++)s+="<Row  IsOwner='1' UserId='"+this.lstOwnersRight[l].CostCenterColID+"'/>";for(let l=0;l<this.lstMembersRight.length;l++)s+="<Row  IsOwner='0' UserId='"+this.lstMembersRight[l].CostCenterColID+"'/>";s+="</XML>",this.obj.XML=s.toString(),this.DisplayMessage="";let i=this.SaveTeam();this.DisplayMessage=i.Message,t=i.RetValue,t>0&&(this.MessageVisibility=!0,this.LoadData(),this.Name.Text="",null!=this.oParent&&this.oParent.Refresh(),this.Status.SelectedValue="101",Logger.InfoLog("TeamViewModel :: Exiting OnSaveLead"))}Logger.InfoLog("TeamViewModel ::  OnSave Exit")}SaveTeam(){Logger.InfoLog("Cases::Exiting SaveCases");try{let e=[];e.push(this.obj.Name),e.push(this.obj.XML),e.push(this.obj.Status),e.push(this.obj.TeamID),e.push(a.d.SessionManager.CompanyGUID),e.push(a.d.SessionManager.UserName),e.push(a.d.SessionManager.UserID),e.push(a.d.SessionManager.RoleID),e.push(a.d.SessionManager.LanguageID);let s=a.d.crmService.SaveTeam(e);return Logger.InfoLog("SaveTeam::Exiting SaveTeam"),s}catch(e){return Logger.ErrorLog("SaveTeam::SaveTeam"+e.stack),""}}MoveItem(e){switch(Logger.InfoLog("TeamViewModel ::  MoveItem Enter"),e){case"Left1":-1!=this.LOSelectedIndex&&(this.Check(this.lstOwnersLeft[this.LOSelectedIndex].CostCenterColID)?(this.lst.push(new n(this.lstOwnersLeft[this.LOSelectedIndex].CostCenterColID)),this.lstOwnersRight.Insert(this.lstOwnersRight.length,this.lstOwnersLeft[this.LOSelectedIndex]),this.lstOwnersLeft.RemoveAt(this.LOSelectedIndex)):alert("User is aleady selected in Members list"));break;case"Right1":-1!=this.ROSelectedIndex&&(this.lstOwnersLeft.Insert(this.lstOwnersLeft.length,this.lstOwnersRight[this.ROSelectedIndex]),this.lst.Remove(new n(this.lstOwnersRight[this.ROSelectedIndex].CostCenterColID)),this.lstOwnersRight.RemoveAt(this.ROSelectedIndex));break;case"Left2":-1!=this.LMSelectedIndex&&(this.Check(this.lstMembersLeft[this.LMSelectedIndex].CostCenterColID)?(this.lst.push(new n(this.lstMembersLeft[this.LMSelectedIndex].CostCenterColID)),this.lstMembersRight.Insert(this.lstMembersRight.length,this.lstMembersLeft[this.LMSelectedIndex]),this.lstMembersLeft.RemoveAt(this.LMSelectedIndex)):alert("User is aleady selected in Owners list"));break;case"Right2":-1!=this.RMSelectedIndex&&(this.lstMembersLeft.Insert(this.lstMembersLeft.length,this.lstMembersRight[this.RMSelectedIndex]),this.lst.Remove(new n(this.lstMembersRight[this.RMSelectedIndex].CostCenterColID)),this.lstMembersRight.RemoveAt(this.RMSelectedIndex))}Logger.InfoLog("TeamViewModel ::  MoveItem Leave")}ListViewUserSelectionChange(e){"Right"==e.toString()&&-1!=this.RMSelectedIndex&&this.lstMembersRight.length>0&&(this.SelectedUserViewColumn=this.lstMembersRight[this.RMSelectedIndex])}ListViewSelectionChange(e){"Right"==e.toString()&&-1!=this.ROSelectedIndex&&this.lstOwnersRight.length>0&&(this.SelectedOwnerViewColumn=this.lstOwnersRight[this.ROSelectedIndex])}LoadData(){Logger.InfoLog("TeamViewModel ::  LoadData Enter");let e=[];e.push(this.ID),e.push(a.d.SessionManager.UserID),e.push(a.d.SessionManager.LanguageID);let s="?CompanyIndex="+a.d.SessionManager.CompanyIndex+"&param="+JSON.stringify(e),t=a.d.crmService.GetTeamScreenDetails(s);if(null!=t&&t.Tables.length>0){for(let l=0;l<t.Tables[0].length;l++)this.Status.Items.push(o._p.ComboBoxItems_2(t.Tables[0][l].Status.toString(),t.Tables[0][l].StatusID.toString()));this.FillOwnersLeftList(null,1,t),this.FillMembersLeftList(null,1,t),this.Status.SelectedValue="420"}Logger.InfoLog("TeamViewModel ::  LoadData Leave")}FillOwnersLeftList(e,s,t){Logger.InfoLog("TeamViewModel ::  LoadData FillOwnersLeftList"),this.lstOwnersLeft=[],this.lstOwnersRight=[];for(let i=0;i<t.Tables[s].length;i++)(e=new h).CostCenterColID=parseInt(t.Tables[s][i].UserID.toString()),e.UserColumnName=t.Tables[s][i].UserName.toString(),this.lstOwnersLeft.push(e);Logger.InfoLog("TeamViewModel ::  OnLeave FillOwnersLeftList")}FillOwnersRightList(e,s,t){Logger.InfoLog("TeamViewModel ::  LoadData FillOwnersLeftList"),this.lstOwnersRight=[];for(let i=0;i<t.Tables[s].length;i++)(e=new h).CostCenterColID=parseInt(t.Tables[s][i].UserID.toString()),e.UserColumnName=t.Tables[s][i].UserName.toString(),this.lstOwnersRight.push(e),this.lst.push(new n(e.CostCenterColID));Logger.InfoLog("TeamViewModel ::  OnLeave FillOwnersLeftList")}FillMembersRightList(e,s,t){Logger.InfoLog("TeamViewModel ::  LoadData FillOwnersLeftList"),this.lstMembersRight=[];for(let i=0;i<t.Tables[s].length;i++)(e=new h).CostCenterColID=parseInt(t.Tables[s][i].UserID.toString()),e.UserColumnName=t.Tables[s][i].UserName.toString(),this.lstMembersRight.push(e),this.lst.push(new n(e.CostCenterColID));Logger.InfoLog("TeamViewModel ::  OnLeave FillOwnersLeftList")}FillMembersLeftList(e,s,t){Logger.InfoLog("TeamViewModel ::  LoadData FillOwnersLeftList"),this.lstMembersLeft=[],this.lstMembersRight=[];for(let i=0;i<t.Tables[s].length;i++)(e=new h).CostCenterColID=parseInt(t.Tables[s][i].UserID.toString()),e.UserColumnName=t.Tables[s][i].UserName.toString(),this.lstMembersLeft.push(e);Logger.InfoLog("TeamViewModel ::  OnLeave FillOwnersLeftList")}}class n{constructor(e){this.User=0,this.User=e}}class h{}}}]);