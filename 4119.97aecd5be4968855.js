"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[4119],{76500:(N,A,t)=>{t.r(A),t.d(A,{FavoritesViewModel:()=>E});var i=t(32040),S=t(43767),B=t(98580),R=t(27730),f=t(58941),y=t(83809),M=t(58170),O=t(25436),p=t(61301),L=t(54189);class E extends B.g{constructor(s=0){super(),this.StaticFields=[],this.Favorites=new R.y$(0),this.ButtonAssign=new f.v,this.ButtonCustomize=new f.v,this.SearchLinks=[],this.RecentSearchLinks=[],this.Categories=[],this.BgColor="#f9f9f9",this.IsList=!1,this.SelectionChangedCommandAssign=new M.Yk,this.ButtonClick=new M.Yk,this.SearchReport=new M.Yk,this.SearchDataClick=new M.Yk,this.SelectionChangedCommand=new M.Yk,this.Maxcol=0,this.Maxrow=0,this.Columns=[],Logger.InfoLog("FavoritesViewModel::Entering FavoritesViewModel"),i.d.SessionManager.HideUnathorizedAccess?this.ButtonCustomize.Visible=i.d.SessionManager.IsActionAssigned(69,"Customize"):this.ButtonCustomize.Enable=i.d.SessionManager.IsActionAssigned(69,"Customize"),i.d.SessionManager.HideUnathorizedAccess?this.ButtonAssign.Visible=i.d.SessionManager.IsActionAssigned(69,"Assign"):this.ButtonAssign.Enable=i.d.SessionManager.IsActionAssigned(69,"Assign"),this.ButtonClick.Subscribe(this,"OnSave"),this.SearchReport.Subscribe(this,"onsearch"),this.SearchDataClick.Subscribe(this,"onSearchDataClick"),this.Categories=[],this.Favorites.SelectionChangedCommand.Subscribe(this,"OnSelectionChangedCommand"),this.CompanyName=i.d.SessionManager.CompanyName,this.RevenUEdition=i.d.SessionManager.LicenseSettings.ContainsKey("RevenUEdition")?i.d.SessionManager.LicenseSettings.RevenUEdition:"Standard",this.RevenUVersion="R-"+i.d.SessionManager.VersionNo,this.FillFavorites(),(s>0||i.d.SessionManager.IsEmpUser&&-1e3==s)&&(this.Favorites.SelectedValue=s.toString()),null!=this.Favorites.SelectedValue&&(this.ds=i.d.admin.GetFavorite("VIEW",parseInt(this.Favorites.SelectedValue)),this.prevValue=this.Favorites.SelectedValue),0==s?(this.DisplayName=i.d.GetResource("Favorite"),this.Title=this.DisplayName):this.Title=this.DisplayName=this.Favorites.GetText(),this.onLoad(),Logger.InfoLog("FavoritesViewModel::Leaving FavoritesViewModel"),i.d.SessionManager.PersonalSettings.ContainsKey("IsFavList")&&"1"==i.d.SessionManager.PersonalSettings.IsFavList&&(this.IsList=!0),this.LoadRecentSearchData()}OnSelectionChangedCommand(){null!=this.Favorites.SelectedValue&&this.prevValue!=this.Favorites.SelectedValue&&(this.prevValue=this.Favorites.SelectedValue,this.ds=null,this.StaticFields.Clear(),this.Categories.Clear(),this.ds=i.d.admin.GetFavorite("VIEW",parseInt(this.Favorites.SelectedValue)),this.onLoad())}FillFavorites(){let s=i.d.admin.GetFavorite("GETLIST"+i.d.SessionManager.LocationID,0);if(null!=s&&s.Tables.length>0&&s.Tables[0].length>0){let e=null;s.Tables[1].length>0&&(e=s.Tables[1][0][s.Columns[1][0]].toString()),s.Tables[0].forEach(n=>{this.Favorites.Items.push(R._p.ComboBoxItems_2(n.FavName.toString(),n.ID.toString())),null!=e&&n.ID.toString()==e&&(this.Favorites.SelectedValue=e)}),null==this.Favorites.SelectedValue&&this.Favorites.Items.length>0&&(this.Favorites.SelectedValue=this.Favorites.Items[0].Value)}this.Favorites.Visible=this.Favorites.Items.length>=1,s=[]}OnSave(s){"Customize"==s||"Assign"==s||this.onClick(s)}onClick(s){i.d.page.ShowLoading=!0,setTimeout(()=>{this.onClick_Async(s)},50)}onClick_Async(s){let e=new O.aF;if(s instanceof L.B||s instanceof f.v){let n=s;if("1"==n.isReport.toString())"0"==n.Featureactiontypeid?(i.d.page.ShowLoading=!1,alert("Report Not Assigned.")):Promise.all([t.e(9891),t.e(534),t.e(7996),t.e(2881),t.e(1755),t.e(3884),t.e(7030),t.e(4628),t.e(5984),t.e(5152),t.e(8405),t.e(895),t.e(5819),t.e(6015),t.e(2963),t.e(108),t.e(2290),t.e(8024),t.e(3364),t.e(9284),t.e(9128),t.e(1938),t.e(2726),t.e(4065),t.e(2014),t.e(2209),t.e(2771),t.e(6084),t.e(4882),t.e(9702),t.e(2076)]).then(t.bind(t,39026)).then(({ReportViewModel:o})=>{let r=new o;r.ReportViewModel_1(parseInt(n.DBColumnName)),0==r.ReturnType&&Promise.all([t.e(2881),t.e(3884),t.e(8285)]).then(t.bind(t,31503)).then(({ReportViewComponent:m})=>{i.d.page.addNewTab({component:m,params:{obj:r}})})});else if("2"==n.isReport.toString())"0"==n.Featureactiontypeid?(i.d.page.ShowLoading=!1,alert("Dashboard Not Assigned.")):Promise.all([t.e(9891),t.e(534),t.e(7996),t.e(2881),t.e(1755),t.e(3884),t.e(7030),t.e(4628),t.e(5984),t.e(5152),t.e(8405),t.e(895),t.e(5819),t.e(6015),t.e(2963),t.e(108),t.e(2290),t.e(8024),t.e(3364),t.e(9284),t.e(9128),t.e(1938),t.e(2726),t.e(4065),t.e(2014),t.e(2209),t.e(2771),t.e(6084),t.e(4882),t.e(9702),t.e(3798),t.e(2911),t.e(1188),t.e(5620),t.e(5746),t.e(2144),t.e(4244),t.e(2076)]).then(t.bind(t,71863)).then(({DBViewViewModel:o})=>{let r=new o;r.DBViewViewModel_1(parseInt(n.DBColumnName)),Promise.all([t.e(9891),t.e(534),t.e(7996),t.e(2881),t.e(1755),t.e(3884),t.e(7030),t.e(4628),t.e(5984),t.e(5152),t.e(8405),t.e(895),t.e(5819),t.e(6015),t.e(2963),t.e(108),t.e(2290),t.e(8024),t.e(3364),t.e(9284),t.e(9128),t.e(1938),t.e(2726),t.e(4065),t.e(2014),t.e(2209),t.e(2771),t.e(6084),t.e(4882),t.e(9702),t.e(2586),t.e(9842),t.e(2076)]).then(t.bind(t,49842)).then(({DBViewComponent:m})=>{i.d.page.addNewTab({component:m,params:{obj:r}})})});else{e.FeatureActionID=parseInt(n.DBColumnName),s instanceof L.B?e.ScreenName=n.ScreenName:s instanceof f.v&&(e.ScreenName=n.DataType),e.FeatureID=n.FeatureID,(50==e.FeatureID||"215"==n.Featureactiontypeid&&(2==n.FeatureID||3==n.FeatureID))&&(e.FeatureActionTypeID=parseInt(n.Featureactiontypeid)),n.FeatureID>5e4?(e.ScreenType=7,e.FeatureActionTypeID="31"!=n.Featureactiontypeid&&"30"!=n.Featureactiontypeid?2:parseInt(n.Featureactiontypeid)):n.FeatureID>4e4&&(e.ISDoctype=n.DBColumnID);let o={};p.RibbonExtViewModel.OncmdLoadPage(e,o).then(r=>{if(!o.component)return;let m;"FeatureActionID"==o.basedon?m=i.d.page.tabs.find(c=>c.instance instanceof o.component&&c.instance.FeatureActionID==e.FeatureActionID):"CostCenterID"==o.basedon?m=i.d.page.tabs.find(c=>c.instance instanceof o.component&&c.instance.CostCenterID==e.FeatureID):"Unique"==o.basedon&&(m=i.d.page.tabs.find(c=>c.instance instanceof o.component)),m?(i.d.page.tabs.map(c=>c.active=!1),m.active=!0):(o.title=e.ScreenName,i.d.page.addNewTab(o))})}this.StaticFields.filter(o=>s)}else if(s instanceof String){for(let n=0;n<this.StaticFields.length;n++){let o=this.StaticFields[n];if(o.DBColumnName==s.toString()){"1"==o.isReport.toString()||(e.FeatureActionID=parseInt(o.DBColumnName),o instanceof L.B?e.ScreenName=o.ScreenName:o instanceof f.v&&(e.ScreenName=o.Message),e.FeatureID=o.FeatureID,("31"==o.Featureactiontypeid||"30"==o.Featureactiontypeid)&&(e.FeatureActionTypeID=parseInt(o.Featureactiontypeid)),o.FeatureID>5e4&&(e.ScreenType=7,e.FeatureActionTypeID="31"!=o.Featureactiontypeid&&"30"!=o.Featureactiontypeid?2:parseInt(o.Featureactiontypeid)),p.RibbonExtViewModel.OncmdLoadPage(e,void 0),"ErrorMessage"==e.ToolTipDescription&&(this.DisplayMessage=e.ImageName));break}}this.StaticFields.filter(n=>s)}}onLoad(){Logger.InfoLog("FavoritesViewModel::Entering onLoad");let s="assets/images/menu/",e=[],n=-1;try{if(null!=this.ds&&this.ds.Tables[0].length>0&&(this.ds.Tables[0]=i.d.IsMobile?[...new Map(this.ds.Tables[0].map(a=>[a.FeatureactionID,a])).values()].filter(a=>1==a.ShowInMobile):[...new Map(this.ds.Tables[0].map(a=>[a.FeatureactionID,a])).values()].filter(a=>1==a.ShowInWeb),e=this.ds.Tables[0],this.ds.Tables.length>1&&this.ds.Tables[1].length>0&&(n=parseInt(this.ds.Tables[1][0].MaxRows))),this.IsCategoryWise=!1,this.BgColor="#f9f9f9",null!=this.ds&&this.ds.Tables.length>2&&this.ds.Tables[2].length>0&&S.J0.StringValue(this.ds.Tables[2][0].OptionsXML).toString().length>0){let a=new S.VB;a.LoadXml(this.ds.Tables[2][0].OptionsXML.toString()),null!=a.SelectSingleNode("XML/IsCategoryWise")&&(this.IsCategoryWise=!0),this.BgColor=S.J0.rgbColor(a.SelectSingleNodeText("XML/BgColor")),("#FFFFFF"==this.BgColor||"#FFFFFF00"==this.BgColor)&&(this.BgColor="#f9f9f9")}if(this.IsCategoryWise){let a,D,g=0,l=[];this.ds.Tables[0].forEach(F=>{g<parseInt(F.ColumnNo)&&(g=parseInt(F.ColumnNo)),l.Contains(F.Category.toString().toUpperCase())||l.push(F.Category.toString().toUpperCase())}),g++,D=100/g/100+"*";for(let F=0;F<l.length;F++){let u;u=this.ds.Tables[0].filter(""==l[F]?C=>C.Category.toLowerCase()==l[F].toLowerCase()||null==C.Category:C=>C.Category.toLowerCase()==l[F].toLowerCase()),u=u.sort((C,h)=>C.RowNo>h.RowNo||C.RowNo==h.RowNo&&C.ColumnNo>h.ColumnNo?1:-1),a=parseInt(u[0].RowNo);let I=new y.O;I.Header=u[0].Category.toString(),this.Categories.push(I),I.Align=D,I.Column=g>1?D:"0",I.ColumnSpan=g>2?D:"0",I.DataType=g>3?D:"0",I.DecimalPoints=g>4?D:"0",I.DefaultValue=g>5?D:"0",I.DependantOn=g>6?D:"0",I.Expression=g>7?D:"0";for(let C=0;C<u.length;C++){const h=u[C];if(Object.keys(e).Contains("FeatureID")&&""!=h.FeatureID.toString()&&parseInt(h.FeatureID)>=40001&&parseInt(h.FeatureID)<=49999&&Object.keys(e).Contains("HasAccess")&&"0"==h.HasAccess.toString())continue;let d=new f.v;d.Label=h.DisplayName.toString(),d.DBColumnName=h.FeatureactionID.toString(),d.SmallImage=s+h.ImagePath.toString().replace("/","''"),d.Row=parseInt(h.RowNo)-a,d.Column=parseInt(h.ColumnNo),d.ClickCommand.Subscribe(this,"onClick"),d.DataType=h.ScreenName.toString(),d.Message=h.ScreenName.toString(),d.ScreenName=h.ScreenName.toString(),d.LocalRefXML=h.ShortCutKey.toString(),null!=h.FeatureID&&""!=h.FeatureID.toString()&&(d.FeatureID=parseInt(h.FeatureID)),d.KeyTip=S.J0.StringValue(h.ButtonKeyTip),d.isReport=h.isReport.toString(),d.Featureactiontypeid=S.J0.StringValue(h.FeatureActionTypeID),d.WebIcon=E.GetIcon(d),this.ds.Columns[0].Contains("DocumentType")&&""!=S.J0.StringValue(h.DocumentType)&&(d.DBColumnID=parseInt(h.DocumentType.toString())),I.Fields.push(d),this.StaticFields.push(d)}this.AddEmptySpace(I.Fields)}}else{for(let a=0;a<=n;a++)for(let g=0;g<4;g++)if(e=this.ds.Tables[0],e=e.filter(l=>l.RowNo==a&&l.ColumnNo==g),e.length>0){if(Object.keys(e).Contains("FeatureID")&&""!=e[0].FeatureID.toString()&&parseInt(e[0].FeatureID)>=40001&&parseInt(e[0].FeatureID)<=49999&&Object.keys(e).Contains("HasAccess")&&"0"==e[0].HasAccess.toString())continue;let l=new L.B;l.Label=e[0].DisplayName.toString(),l.DBColumnName=e[0].FeatureactionID.toString(),l.SmallImage=s+e[0].ImagePath.toString().replace("/","''"),l.Row=a,l.Column=g,l.ClickCommand.Subscribe(this,"onClick"),l.ScreenName=e[0].ScreenName.toString(),l.ShortcutKey=e[0].ShortCutKey.toString(),null!=e[0].FeatureID&&""!=e[0].FeatureID.toString()&&(l.FeatureID=parseInt(e[0].FeatureID)),l.KeyTip=S.J0.StringValue(e[0].ButtonKeyTip),l.isReport=e[0].isReport.toString(),l.Featureactiontypeid=S.J0.StringValue(e[0].FeatureActionTypeID),l.Icon=E.GetIcon(l),this.ds.Columns[0].Contains("DocumentType")&&""!=S.J0.StringValue(e[0].DocumentType)&&(l.DBColumnID=parseInt(e[0].DocumentType.toString())),this.StaticFields.push(l)}this.AddEmptySpace(this.StaticFields)}if(this.StaticFields.length>0){var v=this.StaticFields;this.Maxrow=Math.max.apply(Math,v.map(function(a){return a.Row})),this.Maxcol=Math.max.apply(Math,v.map(function(a){return a.Column})),this.Columns=Array(this.Maxcol+1).fill(null).map((a,g)=>g)}this.multiArray=new Array(1);for(var T=0;T<1;T++){this.multiArray[T]=new Array(0);for(var V=0;V<this.Maxcol+1;V++)this.multiArray[T][V]=-1}}catch(a){Logger.ErrorLog("FavoritesViewModel::onLoad",a.stack)}Logger.InfoLog("FavoritesViewModel::Leaving onLoad")}AddEmptySpace(s){let e=[];for(let n=s.length-1;n>=0;n--)if(!e.Contains(s[n].Row)){e.push(s[n].Row);for(let o=0;o<4;o++)if(!s.find(r=>r.Row==s[n].Row&&r.Column==o)){let r=new f.v;r.Row=s[n].Row,r.Column=o,r.Visible=!1,s.push(r)}}s.sort((n,o)=>n.Row>o.Row||n.Row==o.Row&&n.Column>o.Column?1:-1)}static GetIcon(s){let e,r;return i.d.SessionManager.MenuTabs.forEach(m=>{r||m.Groups.forEach(c=>{if(r)return;let v=c.Items.find(T=>T.FeatureActionID==s.DBColumnName);return v?(e=v.WebIcon,void(r=!0)):void 0})}),e||(e=s.isReport?"fa-thin fa-file-chart-line":"fa-thin fa-file"),e}onsearch(s){}QuickSearch(){this.SearchLinks.Clear(),S.J0.IsEmptySpace(this.SerachValue)||this.SerachValue.toLowerCase()}onSearchDataClick(s){new S.VB}LoadRecentSearchData(){if(this.RecentSearchLinks.Clear(),i.d.SessionManager.PersonalSettings.ContainsKey("RecentQuickSearch")){let s=new S.VB;s.LoadXml(i.d.SessionManager.PersonalSettings.RecentQuickSearch);for(let e=s.DocumentElement.children.length-1;e>=0;e--);}this.RecentSearchVisible=this.RecentSearchLinks.length>0}}},83809:(N,A,t)=>{t.d(A,{O:()=>B,Z:()=>S});var i=t(58170);class S extends i.MI{constructor(){super(),this.Pages=[],this.Sections=[],this.Tabs=[],this.OnTabChange=new i.Yk}}class B extends i.MI{constructor(){super(...arguments),this.IsVisible=!0,this.TabType=1,this.strViewCCID="",this._IsAccordionOpen=!0,this._IsAccordionMobileOpen=!0,this.Fields=[]}PactTabData(){}get IsAccordionOpen(){return this._IsAccordionOpen}set IsAccordionOpen(f){this._IsAccordionOpen=f,f&&this.Fields.length>0&&this.Fields.forEach(y=>{y.angularGrid&&y.angularGrid.resizerService.resizeGrid()})}get IsAccordionMobileOpen(){return this._IsAccordionMobileOpen}set IsAccordionMobileOpen(f){this._IsAccordionMobileOpen=f,f&&this.Fields.length>0&&this.Fields.forEach(y=>{y.angularGrid&&y.angularGrid.resizerService.resizeGrid()})}}}}]);