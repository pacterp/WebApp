"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[1938],{99557:(N,m,I)=>{I.r(m),I.d(m,{DocumentNumberViewModel:()=>b});var h=I(74523),a=I(32040),o=I(43767),f=I(54581),p=I(98580),S=I(23458),P=I(72247);class b extends p.g{InitVariables(s){this.Parent=s,this.Prefixdt=s.ScreenObject.Data.Tables[8],this.Division=this.DocNumberFields.find(e=>50001==e.CCID),this.Location=this.DocNumberFields.find(e=>50002==e.CCID),this.Parent.IsPOs&&(a.d.SessionManager.Preferences.ContainsKey("PosShifts")&&""!=a.d.SessionManager.Preferences.PosShifts.toString()&&parseInt(a.d.SessionManager.Preferences.PosShifts.toString())>5e4&&(this.Shift=this.DocNumberFields.find(e=>e.CCID==parseInt(a.d.SessionManager.Preferences.PosShifts.toString()))),this.Register=this.DocNumberFields.find(e=>e.CCID==a.d.SessionManager.RegisterCCID))}CommandController(s){}constructor(s,e,C,d=null){if(super(),this.DocNumberFields=[],this.ISTree=!1,this.IsNormal=!1,this.IsFirstCall=!1,this.Prefixdt=null,this.Parent=null,this.objRent=null,this.objparent=null,this.ClearSelectedNodes=!1,this.SelectedNodes=[],"AddEditRenContractViewModel"==s.ClassName)return;this.ISTree=C,this.IsNormal=!C,this.Parent=s,this.Prefixdt=e;let u=o.J0.IsType(d,"AddEditDocumentViewModel")?d:null,r=d&&"object"==typeof d&&!o.J0.IsEmpty(d.length)?d:null;for(let t=0;t<e.length;t++)if(parseInt(e[t].CCID.toString())>5e4){if(this.DocNumberFields.find(l=>l.CCID==parseInt(e[t].CCID)))continue;let n=new S.y$(0);if(n.CCID=parseInt(e[t].CCID.toString()),n.TypeID=1,n.Label=e[t].Name.toString(),n.DBColumnName=e[t].SysColumnName.toString(),n.Mandatory=!0,n.Row=this.DocNumberFields.length/2,n.Column=this.DocNumberFields.length%2,n.OnPactListBoxValueChanged.Subscribe(this,"onSelectedValueChanged"),n.SetTimeToZero(),(this.Parent.IsPOs||this.Parent.ScreenObject.GridDataColumns.Contains("FieldType"))&&n.CCID==a.d.SessionManager.RegisterCCID?(n.DefaultValue=this.Parent.ScreenObject.RegisterNodeID.toString(),n.SelectedValue=this.Parent.ScreenObject.RegisterNodeID,n.Enable=!1,this.Register=n):(this.Parent.IsPOs||this.Parent.ScreenObject.GridDataColumns.Contains("FieldType"))&&a.d.SessionManager.Preferences.ContainsKey("PosShifts")&&""!=a.d.SessionManager.Preferences.PosShifts.toString()&&parseInt(a.d.SessionManager.Preferences.PosShifts.toString())==n.CCID&&(n.DefaultValue=this.Parent.ScreenObject.ShiftNodeID.toString(),n.SelectedValue=this.Parent.ScreenObject.ShiftNodeID,this.Shift=n),s.ScreenObject.Data.Columns[0].Contains("dependanton")){let l=s.ScreenObject.Data.Tables[0].filter(c=>c.SysColumnName=="dcCCNID"+(n.CCID-5e4));if(l.length>0&&(o.J0.StringIsNullOrEmpty(l[0].IsEditable)||(n.IsReadOnly=!(0,f.yG0)(l[0].IsEditable)),this.Parent.IsPOs&&n.CCID!=a.d.SessionManager.RegisterCCID&&s.ScreenObject.Data.Columns[0].Contains("LocalCCID")&&o.J0.String(l[0].LocalCCID)==a.d.SessionManager.RegisterCCID.toString()&&s.ScreenObject.Data.Columns[1].Contains("CCNID"+(n.CCID-5e4))?(n.SelectedValue=parseInt(s.ScreenObject.Data.Tables[1][0]["CCNID"+(n.CCID-5e4)].toString()),n.DefaultValue=n.SelectedValue.toString()):o.J0.IsNum(l[0].UserDefaultValue)&&(n.SelectedValue=parseInt(l[0].UserDefaultValue.toString())),o.J0.IsNum(l[0].ColumnCCListViewTypeID)&&(n.TypeID=parseInt(l[0].ColumnCCListViewTypeID.toString())),!o.J0.StringIsNullOrEmpty(l[0].dependanton)&&"0"!=l[0].dependanton.toString())){let c=null;c=83==parseInt(l[0].dependanton.toString())||parseInt(l[0].dependanton.toString())>5e4?s.ScreenObject.Data.Tables[0].filter(D=>D.SysColumnName.startsWith("dcCCNID")&&D.ColumnCostCenterID==l[0].dependanton):s.ScreenObject.Data.Tables[0].filter(D=>D.CostCenterColID==l[0].dependanton),null!=c&&c.length>0&&(n.DependantOn=c[0].SysColumnName.toString(),s.ScreenObject.Data.Columns[0].Contains("dependancy")&&!o.J0.StringIsNullOrEmpty(l[0].dependancy)&&(n.Dependancy=parseInt(l[0].dependancy.toString())),s.ScreenObject.Data.Columns[0].Contains("filterinuse")&&!o.J0.StringIsNullOrEmpty(l[0].filterinuse)&&(n.Dependantinuse=(0,f.yG0)(l[0].filterinuse.toString())))}n.SelectedValue>0&&(n.IsRendred=!0)}if(0==n.SelectedValue)if(null!=u)if(u.ScreenObject.GridDataColumns.Contains("dcCCNID"+(n.CCID-5e4)))o.J0.StringIsNullOrEmpty(u.ScreenObject.GridData[t]["dcCCNID"+(n.CCID-5e4)+"_Key"])||(n.SelectedValue=parseInt(u.ScreenObject.GridData[t]["dcCCNID"+(n.CCID-5e4)+"_Key"].toString()));else{let l=u.ScreenObject._CCFields.find(c=>c instanceof S.y$&&c.CCID==n.CCID);l&&(n.SelectedValue=l.SelectedValue)}else null!=r&&Object.keys(r[0]).Contains("dcCCNID1")&&(n.SelectedValue=parseInt(r[0]["dcCCNID"+(n.CCID-5e4)].toString()));this.DocNumberFields.push(n),50001==n.CCID?this.Division=n:50002==n.CCID?this.Location=n:this.Parent.ScreenObject.CostCentersValues.ContainsKey(n.CCID.toString())?this.Parent.ScreenObject.CostCentersValues[n.CCID.toString()]="":this.Parent.ScreenObject.CostCentersValues.push(n.CCID.toString(),"")}if(null==this.Division&&a.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==a.d.SessionManager.Preferences.EnableDivisionWise.toString()&&(!this.Parent.ScreenObject.Preferences.ContainsKey("Donotusedivision")||""==this.Parent.ScreenObject.Preferences.Donotusedivision||!(0,f.yG0)(this.Parent.ScreenObject.Preferences.Donotusedivision))){let t=new S.y$(0);if(t.CCID=50001,t.TypeID=1,t.DBColumnName="Name",t.Label=a.d.SessionManager.Preferences.ContainsKey("DivisionName")?a.d.SessionManager.Preferences.DivisionName:"Division",t.Mandatory=!0,t.Row=this.DocNumberFields.length/2,t.Column=this.DocNumberFields.length%2,t.OnPactListBoxValueChanged.Subscribe(this,"onSelectedValueChanged"),t.SetTimeToZero(),s.ScreenObject.Data.Columns[0].Contains("dependanton")){let i=s.ScreenObject.Data.Tables[0].filter(n=>"dcCCNID1"==n.SysColumnName);if(i.length>0&&(o.J0.StringIsNullOrEmpty(i[0].IsEditable)||(t.IsReadOnly=!(0,f.yG0)(i[0].IsEditable)),this.Parent.IsPOs&&s.ScreenObject.Data.Columns[0].Contains("LocalCCID")&&o.J0.String(i[0].LocalCCID)==a.d.SessionManager.RegisterCCID.toString()&&s.ScreenObject.Data.Columns[1].Contains("CCNID1")?(t.SelectedValue=parseInt(s.ScreenObject.Data.Tables[1][0].CCNID1.toString()),t.DefaultValue=t.SelectedValue.toString()):!o.J0.StringIsNullOrEmpty(i[0].UserDefaultValue)&&isFinite(i[0].UserDefaultValue)&&(t.SelectedValue=parseInt(i[0].UserDefaultValue.toString())),!o.J0.StringIsNullOrEmpty(i[0].dependanton)&&"0"!=i[0].dependanton.toString())){let n=null;n=83==parseInt(i[0].dependanton.toString())||parseInt(i[0].dependanton.toString())>5e4?s.ScreenObject.Data.Tables[0].filter(l=>l.SysColumnName.startsWith("dcccnid")&&l.ColumnCostCenterID==o.J0.String(i[0].dependanton)):s.ScreenObject.Data.Tables[0].filter(l=>l.CostCenterColID==i[0].dependanton.toString()),null!=n&&n.length>0&&(t.DependantOn=n[0].SysColumnName.toString(),s.ScreenObject.Data.Columns[0].Contains("dependancy")&&!o.J0.StringIsNullOrEmpty(i[0].dependancy)&&(t.Dependancy=parseInt(i[0].dependancy.toString())),s.ScreenObject.Data.Columns[0].Contains("filterinuse")&&!o.J0.StringIsNullOrEmpty(i[0].filterinuse)&&(t.Dependantinuse=(0,f.yG0)(i[0].filterinuse.toString())))}}if(0==t.SelectedValue)if(null!=u){let i=u.ScreenObject._CCFields.find(n=>n instanceof S.y$&&n.CCID==t.CCID);i&&(t.SelectedValue=i.SelectedValue)}else null!=r&&r.Columns.Contains("dcCCNID1")&&(t.SelectedValue=o.J0.Int(r[0].dcCCNID1));this.DocNumberFields.push(t),this.Division=t}if(null==this.Location&&a.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==a.d.SessionManager.Preferences.EnableLocationWise.toString()&&(!this.Parent.ScreenObject.Preferences.ContainsKey("Donotuselocation")||""==this.Parent.ScreenObject.Preferences.Donotuselocation||!(0,f.yG0)(this.Parent.ScreenObject.Preferences.Donotuselocation))){let t=new S.y$(0);if(t.CCID=50002,t.TypeID=1,t.DBColumnName="Name",t.Label=a.d.SessionManager.Preferences.ContainsKey("LocationName")?a.d.SessionManager.Preferences.LocationName:"Location",t.Mandatory=!0,t.Row=this.DocNumberFields.length/2,t.Column=this.DocNumberFields.length%2,t.OnPactListBoxValueChanged.Subscribe(this,"onSelectedValueChanged"),t.SetTimeToZero(),s.ScreenObject.Data.Columns[0].Contains("dependanton")){let i=s.ScreenObject.Data.Tables[0].filter(n=>"dcCCNID2"==n.SysColumnName);if(i.length>0&&(o.J0.StringIsNullOrEmpty(i[0].IsEditable)||(t.IsReadOnly=!(0,f.yG0)(i[0].IsEditable)),this.Parent.IsPOs&&s.ScreenObject.Data.Columns[0].Contains("LocalCCID")&&i[0].LocalCCID.toString()==a.d.SessionManager.RegisterCCID.toString()&&s.ScreenObject.Data.Columns[1].Contains("CCNID2")?(t.SelectedValue=parseInt(s.ScreenObject.Data.Tables[1][0].CCNID2.toString()),t.DefaultValue=t.SelectedValue.toString()):!o.J0.StringIsNullOrEmpty(i[0].UserDefaultValue)&&isFinite(i[0].UserDefaultValue)&&(t.SelectedValue=parseInt(i[0].UserDefaultValue.toString())),!o.J0.StringIsNullOrEmpty(i[0].dependanton)&&"0"!=i[0].dependanton.toString())){let n=null;n=83==parseInt(i[0].dependanton.toString())||parseInt(i[0].dependanton.toString())>5e4?s.ScreenObject.Data.Tables[0].filter(l=>l.SysColumnName.startsWith("dcccnid")&&l.ColumnCostCenterID==o.J0.String(i[0].dependanton)):s.ScreenObject.Data.Tables[0].filter(l=>l.CostCenterColID==i[0].dependanton),null!=n&&n.length>0&&(t.DependantOn=n[0].SysColumnName.toString(),s.ScreenObject.Data.Columns[0].Contains("dependancy")&&!o.J0.StringIsNullOrEmpty(i[0].dependancy)&&(t.Dependancy=parseInt(i[0].dependancy.toString())),s.ScreenObject.Data.Columns[0].Contains("filterinuse")&&!o.J0.StringIsNullOrEmpty(i[0].filterinuse)&&(t.Dependantinuse=(0,f.yG0)(i[0].filterinuse.toString())))}}if(0==t.SelectedValue)if(null!=u){let i=u.ScreenObject._CCFields.find(n=>n instanceof S.y$&&n.CCID==t.CCID);i&&(t.SelectedValue=i.SelectedValue)}else null!=r&&(t.SelectedValue=parseInt(r[0].dcCCNID2.toString()));this.DocNumberFields.push(t),this.Location=t}if(this.ISTree){if(this.ISTree){if(!a.d.IsMobile){this.tree=[];let i=new P.T;i.TreeViewModel_5(3,this,0,"",""),i.HeaderVisiblity=!1,this.tree.push(i)}let t=o.J0.IntTryParse(a.d.SessionManager.Preferences["Maintain Dimensionwise stock"]);if(a.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&t>0&&!this.DocNumberFields.find(n=>n instanceof S.y$&&n.CCID==t)){let n=new S.y$(0);n.CCID=t,n.TypeID=1,n.DBColumnName="Name";let l=this.Parent.ScreenObject._CCFields.find(c=>c instanceof S.y$&&c.CCID==t);if(l)n.Label=l.Label;else{let c=this.Parent.ScreenObject.ColumnSource.find(D=>D.CostCenterID==t);n.Label=c?c.Header:this.Parent.ScreenObject.GetCostcenterName(t)}if(n.Mandatory=!0,n.Row=this.DocNumberFields.length/2,n.Column=this.DocNumberFields.length%2,s.ScreenObject.Data.Columns[0].Contains("dependanton")){let c=s.ScreenObject.Data.Tables[0].filter(D=>"dcCCNID2"==D.SysColumnName);if(c.length>0&&!o.J0.StringIsNullOrEmpty(c[0].dependanton)&&"0"!=c[0].dependanton.toString()){let D=null;D=83==parseInt(c[0].dependanton.toString())||parseInt(c[0].dependanton.toString())>5e4?s.ScreenObject.Data.Tables[0].filter(g=>g.SysColumnName.startsWith("dcccnid")&&g.ColumnCostCenterID==o.J0.String(c[0].dependanton)):s.ScreenObject.Data.Tables[0].filter(g=>g.CostCenterColID==c[0].dependanton),null!=D&&D.length>0&&(n.DependantOn=D[0].SysColumnName.toString(),s.ScreenObject.Data.Columns[0].Contains("dependancy")&&!o.J0.StringIsNullOrEmpty(c[0].dependancy)&&(n.Dependancy=parseInt(c[0].dependancy.toString())),s.ScreenObject.Data.Columns[0].Contains("filterinuse")&&!o.J0.StringIsNullOrEmpty(c[0].filterinuse)&&(n.Dependantinuse=(0,f.yG0)(c[0].filterinuse.toString())))}}this.DocNumberFields.push(n),this.Parent.ScreenObject.CostCentersValues.ContainsKey(n.CCID.toString())?this.Parent.ScreenObject.CostCentersValues[n.CCID.toString()]="":this.Parent.ScreenObject.CostCentersValues.push(n.CCID.toString(),"")}}}else this.OnSave("Save");this.SetFocus()}SetFocus(){this.DocNumberFields.length>0&&(this.DocNumberFields[0].SetFocus=!0)}onSelectedValueChanged(s){let e=s,C="dcccnid"+(e.CCID-5e4);this.DocNumberFields.filter(r=>null!=r.DependantOn&&r.DependantOn.toLowerCase()==C).forEach(r=>{if(r instanceof S.y$){let t="";r.CCID>5e4?r.Dependantinuse?(t="(ccnid"+(s.CCID-5e4)+"="+s.SelectedValue.toString(),1==r.Dependancy&&(t+=" OR ccnid"+(s.CCID-5e4)+"=1 "),t+=")"):t=5==r.Dependancy?"  JOIN "+this.Parent.ScreenObject.GetTableName(r.CCID)+" CMJ with(nolock) ON a.lft between  CMJ.lft and CMJ.rgt JOIN COM_CostCenterCostCenterMap CM on CM.CostCenterID="+r.CCID+" and CM.ParentCostCenterID="+s.CCID+" and CM.ParentNodeID="+s.SelectedValue.toString()+" and CMJ.NodeID=CM.NodeID ":"  JOIN "+this.Parent.ScreenObject.GetTableName(r.CCID)+" CMJ with(nolock) ON a.lft between  CMJ.lft and CMJ.rgt JOIN COM_CostCenterCostCenterMap CM on CM.CostCenterID="+s.CCID+" and CM.ParentCostCenterID="+r.CCID+" and CM.NodeID="+s.SelectedValue.toString()+" and CMJ.NodeID=CM.ParentNodeID ":65==r.CCID&&(t="(FeatureID="+s.CCID+" and  FeaturePK="+s.SelectedValue.toString()+")"),r.CustomWhere=t}});let u=this.Parent.ScreenObject._CCFields.find(r=>r instanceof S.y$&&r.CCID==e.CCID);if(u&&this.Parent.ScreenObject.Data.Tables[0].filter(t=>t.SysColumnName.startsWith("dcCCNID")&&t.LocalReference==u.DBColumnID).length>0){let t=this.Parent.ScreenObject.GetLinkRefDataSet(u.DBColumnID,this.Parent.DocumentID,e.SelectedValue,this.Parent.DocumentDate,u.DBColumnName,e.CCID,null);if(null!=t&&t.Tables.length>0&&t.Tables[0].length>0)for(let i=0;i<t.Columns[0].length;i++)if(t.Columns[0][i].toUpperCase().Contains("CCNID")&&!o.J0.StringIsNullOrEmpty(t.Tables[0][0][t.Columns[0][i]])){let n=o.J0.IntTryParse(t.Columns[0][i].toUpperCase().replace("DCCCNID",""));if(n>0){n+=5e4;let l=this.DocNumberFields.find(c=>c.CCID==n);l&&(l.SelectedValue=parseInt(t.Tables[0][0][t.Columns[0][i]].toString()))}}}}DocumentNumberViewModel_1(s){let e;if(this.objRent=s,a.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"true"==a.d.SessionManager.Preferences.EnableLocationWise.toString().toLowerCase()&&a.d.SessionManager.Preferences.ContainsKey("LW Contracts")&&"true"==a.d.SessionManager.Preferences["LW Contracts"].toString().toLowerCase()&&(e=new S.y$(0),e.CCID=50002,e.TypeID=1,e.DBColumnName="Name",e.Label=a.d.SessionManager.Preferences.ContainsKey("LocationName")?a.d.SessionManager.Preferences.LocationName:"Location",e.Mandatory=!0,e.Row=this.DocNumberFields.length/2,e.Column=this.DocNumberFields.length%2,this.DocNumberFields.push(e),this.Location=e),a.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"true"==a.d.SessionManager.Preferences.EnableDivisionWise.toString().toLowerCase()&&a.d.SessionManager.Preferences.ContainsKey("DW Contracts")&&"true"==a.d.SessionManager.Preferences["DW Contracts"].toString().toLowerCase()&&(e=new S.y$(0),e.CCID=50001,e.TypeID=1,e.DBColumnName="Name",e.Label=a.d.SessionManager.Preferences.ContainsKey("DivisionName")?a.d.SessionManager.Preferences.DivisionName:"Division",e.Mandatory=!0,e.Row=this.DocNumberFields.length/2,e.Column=this.DocNumberFields.length%2,this.DocNumberFields.push(e),this.Division=e),null!=s.DimWiseFields)for(let C=0;C<s.DimWiseFields.length;C++){let d=parseInt(s.DimWiseFields[C]),u=s.ScreenObject.GetCustomField("CCNID"+(d-5e4).toString());e=new S.y$(0),e.CCID=s.dimcc,e.TypeID=1,e.DBColumnName="Name",e.Label=u?u.Label:"view",e.Mandatory=!0,e.Row=this.DocNumberFields.length/2,e.Column=this.DocNumberFields.length%2,this.DocNumberFields.push(e)}this.IsNormal=!0,this.SetFocus()}DocumentNumberViewModel_2(s){this.objparent=s,this.IsNormal=!0}static GetTrimString(s,e){return null!=s&&e>=0&&s.length>e?s.substr(0,e):s}OnSave(s){var e=this;return(0,h.A)(function*(){if("Save"==s.toString()||"ReSave"==s.toString()){if(e.DisplayMessage="",null!=e.Parent){for(let r=0;r<e.DocNumberFields.length;r++){let t=e.DocNumberFields[r],i=t.GetValidationError("SelectedValue");if(!o.J0.StringIsNullOrEmpty(i))return e.DisplayMessage=i,void(e.MessageVisibility=!0);if(!o.J0.StringIsNullOrEmpty(t.DependantOn)&&t.DependantOn.toLowerCase().startsWith("dcccnid")){let n=e.DocNumberFields.find(l=>l.CCID==parseInt(t.DependantOn.toLowerCase().replace("dcccnid",""))+5e4);if(!e.Parent.ScreenObject.IsValidSelection(n,t))return e.DisplayMessage=a.d.GetResource("Invalid")+" "+t.Label,void(e.MessageVisibility=!0)}}e.Parent.ScreenObject.DocPrefix.Prefixes.Clear();let C="",d=0;for(let r=0;r<e.Prefixdt.length;r++)if(0==r&&(d=parseInt(e.Prefixdt[r].SeriesNo.toString())),!o.J0.StringIsNullOrEmpty(e.Prefixdt[r].SeriesNo)&&parseInt(e.Prefixdt[r].SeriesNo.toString())!=d&&(null!=e.Parent.ScreenObject.DocPrefix&&!e.Parent.ScreenObject.DocPrefix.Prefixes.ContainsKey(C)&&e.Parent.ScreenObject.DocPrefix.Prefixes.push(C,(0,f.yG0)(e.Prefixdt[r-1].Isdefault.toString())),d=parseInt(e.Prefixdt[r].SeriesNo.toString()),C=""),51==parseInt(e.Prefixdt[r].CCID.toString())||52==parseInt(e.Prefixdt[r].CCID.toString())||53==parseInt(e.Prefixdt[r].CCID.toString()))C+="'"+e.Prefixdt[r].Length.toString()+"'"+e.Prefixdt[r].Delimiter.toString();else if(54==parseInt(e.Prefixdt[r].CCID.toString()))C+=e.Prefixdt[r].Length.toString()+e.Prefixdt[r].Delimiter.toString();else{let t=e.DocNumberFields.find(i=>i.CCID==parseInt(e.Prefixdt[r].CCID.toString()));t&&(C+=b.GetTrimString(e.Parent.ScreenObject.GetDocNumberString(e.Prefixdt[r].SysColumnName.toString(),t.CCID,t.SelectedValue),parseInt(e.Prefixdt[r].Length.toString()))+e.Prefixdt[r].Delimiter.toString(),e.Parent.ScreenObject.CostCentersValues[t.CCID.toString()]=t.SelectedValue.toString())}if(e.Prefixdt.length>0&&null!=e.Parent.ScreenObject.DocPrefix&&!e.Parent.ScreenObject.DocPrefix.Prefixes.ContainsKey(C)&&e.Parent.ScreenObject.DocPrefix.Prefixes.push(C,(0,f.yG0)(e.Prefixdt[e.Prefixdt.length-1].Isdefault.toString())),e.Parent.DialogResult=!0,null!=e.Division&&a.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==a.d.SessionManager.Preferences.EnableDivisionWise.toString()?(e.Parent.ScreenObject.DivisionID=e.Division.SelectedValue,e.Parent.ScreenObject.DivisionName=e.Division.Text):null!=e.Division&&(e.Parent.ScreenObject.CostCentersValues.ContainsKey("50001")?e.Parent.ScreenObject.CostCentersValues[50001]=e.Division.SelectedValue.toString():e.Parent.ScreenObject.CostCentersValues.push("50001",e.Division.SelectedValue.toString())),null!=e.Location&&a.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==a.d.SessionManager.Preferences.EnableLocationWise.toString()?(e.Parent.ScreenObject.LocationID=e.Location.SelectedValue,e.Parent.ScreenObject.LocationName=e.Location.Text):null!=e.Location&&(e.Parent.ScreenObject.CostCentersValues.ContainsKey("50002")?e.Parent.ScreenObject.CostCentersValues[50002]=e.Location.SelectedValue.toString():e.Parent.ScreenObject.CostCentersValues.push("50002",e.Location.SelectedValue.toString())),e.Parent.IsPOs&&null!=e.Shift&&e.Shift.SelectedValue!=e.Parent.ScreenObject.ShiftNodeID&&(e.Parent.ScreenObject.ShiftNodeID=e.Shift.SelectedValue),e.ISTree){e.DisplayMessage="Loading data.Please wait...",e.MessageVisibility=!0;let r=o.J0.IntTryParse(a.d.SessionManager.Preferences["Maintain Dimensionwise stock"]);if(a.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&r>0){let t=e.DocNumberFields.find(i=>i instanceof S.y$&&i.CCID==r);if(t){e.Parent.ScreenObject.CostCentersValues[r.toString()]=t.SelectedValue.toString();let i=e.Parent.ScreenObject._CCFields.find(n=>n instanceof S.y$&&n.CCID==r);i&&(i.SelectedValue=t.SelectedValue)}}if(null!=e.Location){let t=e.Parent.ScreenObject._CCFields.find(i=>i instanceof S.y$&&50002==i.CCID);t&&(t.SelectedValue=e.Location.SelectedValue)}if(null!=e.Division){let t=e.Parent.ScreenObject._CCFields.find(i=>i instanceof S.y$&&50001==i.CCID);t&&(t.SelectedValue=e.Division.SelectedValue)}if(e.tree&&null!=e.tree[0].SelectedNodes&&e.tree[0].SelectedNodes.length>0&&!e.tree[0].IsDynamicTree){let n,t=0,i=0;for(;i<e.Parent.ScreenObject.GridData.length;i++)if(o.J0.StringIsNullOrEmpty(e.Parent.ScreenObject.GridData[i].ProductID_Key)){t=i;break}i=0,e.tree[0].SelectedNodes.forEach(l=>{if(!l.IsGroup){if(n=e.Parent.ScreenObject.GridDataObj.NewRow(),e.Parent.ScreenObject.GridDataObj.insertRowAt(n,t+i),r>5e4&&e.Parent.ScreenObject.GridDataColumns.Contains("dcCCNID"+(r-5e4).toString())){let c=e.DocNumberFields.find(D=>D instanceof S.y$&&D.CCID==r);c&&(n["dcCCNID"+(r-5e4).toString()+"_Key"]=c.SelectedValue)}null!=e.Location&&e.Parent.ScreenObject.GridDataColumns.Contains("dcCCNID2")&&(n.dcCCNID2_Key=e.Location.SelectedValue),null!=e.Division&&e.Parent.ScreenObject.GridDataColumns.Contains("dcCCNID1")&&(n.dcCCNID1_Key=e.Division.SelectedValue),e.Parent.IsInventoryVoucher=!0,n.ProductID_Key=l.Id,e.Parent.AddProductData(n,!1,!0),e.Parent.CalculateTotals(n,!1),i++}}),e.Parent.ScreenObject.UpdateSequence(),e.Parent.RefreshGrid=!e.Parent.RefreshGrid}}let u=e.Parent.ScreenObject.DocPrefix.ComboBox.IsRendred;e.Parent.ScreenObject.DocPrefix.ComboBox.IsRendred=!1,e.Parent.ScreenObject.FillDocumentPrefix(!1),e.Parent.ScreenObject.DocPrefix.ComboBox.IsRendred=u}else if(null!=e.objRent){for(let C=0;C<e.DocNumberFields.length;C++){let u=e.DocNumberFields[C].GetValidationError("SelectedValue");if(!o.J0.StringIsNullOrEmpty(u))return e.DisplayMessage=u,void(e.MessageVisibility=!0)}null!=e.Location&&null!=e.Location&&e.objRent.ChangeLocation(e.Location.SelectedValue),null!=e.Division&&null!=e.Division&&(e.objRent.DivisionContract.SelectedValue=e.Division.SelectedValue);for(let C=0;C<e.DocNumberFields.length;C++){let d=e.DocNumberFields[C];if(d==e.Location||d==e.Division)continue;e.objRent.SetViewByType(d.CCID,d.SelectedValue,!1);let u=e.objRent.ScreenObject.GetCustomField("CCNID"+(d.CCID-5e4).toString());o.J0.IsEmpty(u.LocalRefXML)||e.objRent.ScreenObject.FillLocalReferenceData(u,0)}}else null!=e.objparent&&e.DocNumberFields.forEach(C=>{let d=C.GetValidationError("SelectedValue");if(!o.J0.IsEmpty(d))return e.DisplayMessage=d,void(e.MessageVisibility=!0)});"Save"==s.toString()&&(yield a.d.page.HideDialog(e.PopUpGUID),e.DialogCallBack(!e.IsFirstCall))}else"Cancel"==s.toString()&&(null!=e.objparent&&e.DocNumberFields.forEach(C=>{let d=C.GetValidationError("SelectedValue");if(!o.J0.IsEmpty(d))return e.DisplayMessage=d,void(e.MessageVisibility=!0)}),null!=e.Parent&&(e.Parent.DialogResult=!1),null!=e.objRent&&(e.objRent.DialogResult=!1),yield a.d.page.HideDialog(e.PopUpGUID),null!=e.Parent&&e.Parent.ToLinkParent?(e.Parent.ToLinkParent.GenerateLinkDocument_Sub1(e.Parent),e.Parent.ToLinkParent=null):e.IsFirstCall&&a.d.page.ActiveTab.params?.obj==e.Parent&&a.d.page.removeActiveTab())})()}}}}]);