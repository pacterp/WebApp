"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[9922],{97541:(T,D,a)=>{a.r(D),a.d(D,{ShiftAssignRotationViewModel:()=>k});var n=a(9659),C=a(66148),u=a(5349),S=a(4884),v=a(29702),d=a(99393),W=a(58940),_=a(66828),p=a(76199);class k extends p.g{constructor(){if(super(),this.FromDate=new S.Lc(0),this.ToDate=new S.Lc(0),this.dt=null,this.dtRotData=null,this.dt=n.d.common.GetDataTable("SAV001",""),null!=this.dt&&this.dt.length>0){this.CCList=[];let e=new u.BZ(0);e.DBColumnName=this.dt[0].FeatureID,e.FeatureID=parseInt(this.dt[0].FeatureID),e.Label=C.J0.String(this.dt[0].Name),this.CCList.push(e)}this.LoadWeekShiftGrid(),this.LoadGenerateGrid()}LoadGenerateGrid(){this.dgv=new v.vv,this.dgv.CanUserAddRows=!1,this.dgv.CanUserSortColumns=!1,this.dgv.CanUserDeleteRows=!0,this.dgv.Columns=[],this.dgv.Width="";let e=new d.O7;e.Header="#",e.DisplayMember="sno",e.ID="sno",e.Width=50,e.ReadOnly=!0,e.TextAlign="Center",this.dgv.Columns.push(e),e=new d.O7,e.Header=null!=this.dt&&this.dt.length>0?C.J0.String(this.dt[0].Name):"Employee",e.DisplayMember="Employee",e.ID="Employee",e.Width=220,e.ReadOnly=!0,e.TextAlign="Left",this.dgv.Columns.push(e),e=new d.O7,e.Header="From",e.DisplayMember="From",e.ID="From",e.Width=100,e.ReadOnly=!0,e.TextAlign="Center",this.dgv.Columns.push(e),e=new d.O7,e.Header="To",e.DisplayMember="To",e.ID="To",e.Width=100,e.ReadOnly=!0,e.TextAlign="Center",this.dgv.Columns.push(e),e=new d.O7,e.Header="Shift",e.DisplayMember="Shift",e.ID="Shift",e.Width=170,e.ReadOnly=!0,e.TextAlign="Left",this.dgv.Columns.push(e),this.dgv.Table=[],this.dgv.TableColumns.push("sno"),this.dgv.TableColumns.push("Employee"),this.dgv.TableColumns.push("Employee_Key"),this.dgv.TableColumns.push("From"),this.dgv.TableColumns.push("To"),this.dgv.TableColumns.push("Shift"),this.dgv.TableColumns.push("Shift_Key")}LoadWeekShiftGrid(){this.dgvWeekShifts=new v.vv,this.dgvWeekShifts.CanUserAddRows=!1,this.dgvWeekShifts.CanUserSortColumns=!1,this.dgvWeekShifts.CanUserDeleteRows=!1,this.dgvWeekShifts.Columns=[],this.dgvWeekShifts.Width="310";let e=new d.O7;e.Header="Week Day",e.DisplayMember="WeekDay",e.ID="WeekDay",e.Width=100,e.ReadOnly=!0,e.TextAlign="Left",this.dgvWeekShifts.Columns.push(e),e=new d.O7,e.Header="Shift",e.DisplayMember="Shift",e.DataType="LISTBOX",e.CostCenterID=50073,e.FilterCondition="IsGroup=0",e.TypeID=1,e.Width=200,this.dgvWeekShifts.Columns.push(e),this.dgvWeekShifts.Table=[],this.dgvWeekShifts.TableColumns.push("WeekDay"),this.dgvWeekShifts.TableColumns.push("Shift"),this.dgvWeekShifts.TableColumns.push("Shift_Key"),this.ResetWeekShiftGridRows()}ResetWeekShiftGridRows(){let e;this.dgvWeekShifts.Table.Clear(),e=this.dgvWeekShifts.NewRow(),e.WeekDay="Monday",this.dgvWeekShifts.addRow(e),e=this.dgvWeekShifts.NewRow(),e.WeekDay="Tuesday",this.dgvWeekShifts.addRow(e),e=this.dgvWeekShifts.NewRow(),e.WeekDay="Wednesday",this.dgvWeekShifts.addRow(e),e=this.dgvWeekShifts.NewRow(),e.WeekDay="Thursday",this.dgvWeekShifts.addRow(e),e=this.dgvWeekShifts.NewRow(),e.WeekDay="Friday",this.dgvWeekShifts.addRow(e),e=this.dgvWeekShifts.NewRow(),e.WeekDay="Saturday",this.dgvWeekShifts.addRow(e),e=this.dgvWeekShifts.NewRow(),e.WeekDay="Sunday",this.dgvWeekShifts.addRow(e)}OnChkLstClear(e){this.CCList[0].Items.Clear()}OnPickerClick(e){const l=new W.$;l.SearchPickerViewModel_3(this,"COSTCENTER",e),n.d.page.ShowDialog(l,_.u,{ShowCenter:!0})}ParentCallBack(e){if("COSTCENTER"==e.PickerType){let l=this.CCList[0];e.SelectedNodes.forEach(i=>{i.IsGroup||0==l.Items.filter(t=>t.Value==i.Id.toString()).length&&(l.Items.push(u.oN.CheckedListBoxItem_5(i.Text[1],i.Id.toString(),!0)),l.Items[l.Items.length-1].Parent=i.Text[0])})}}OnButtonClick(e){"Cancel"==e?n.d.page.HideDialog(this.PopUpGUID):"Generate"==e?this.Generate_Click():"Load"==e&&this.Load_Click()}Load_Click(){if(!(this.dgv.Table.length>0))return this.DisplayMessage="Generate atleast for one Employee",void(this.MessageVisibility=!0);this.dtRotData=this.dgv.Table.Copy(),this.DialogResult=!0,n.d.page.HideDialog(this.PopUpGUID)}Generate_Click(){let e=!1,l=!1;for(let h=0;h<this.CCList[0].Items.length;h++)if(this.CCList[0].Items[h].IsChecked){e=!0;break}if(0==this.CCList[0].Items.length||!e)return this.DisplayMessage="Select atleast one Employee",void(this.MessageVisibility=!0);for(let h=0;h<this.dgvWeekShifts.Table.length;h++)if(!C.J0.IsEmpty(this.dgvWeekShifts.Table[h].Shift_Key)){l=!0;break}if(!l)return this.DisplayMessage="Assign atleast one Shift for Week day",void(this.MessageVisibility=!0);this.dgv.refreshDatawithIDs();let i,s,t=this.FromDate.Date,r=t,o=-1,g="",f=null,m=n.d.common.GetDataTable("SAV002","");for(let h=0;h<this.CCList[0].Items.length;h++)if(this.CCList[0].Items[h].IsChecked)for(t=this.FromDate.Date,r=t,o=-1,g="";t<=this.ToDate.Date;)if(50051==parseInt(this.dt[0].FeatureID)&&null!=m&&m.length>0&&(f=null,f=m.filter(y=>y.NodeID==this.CCList[0].Items[h].Value),null!=f&&f.length>0&&t<new Date(f[0].DateOfJoining)))t=t.AddDays(1);else{if(i=this.dgvWeekShifts.Table.filter(y=>y.WeekDay==t.getDayName().toString()+"'"),null!=i&&i.length>0){if(-1!=o){if(null!=i[0].Shift_Key&&null!=i[0].Shift_Key&&""!=i[0].Shift_Key.toString()&&o==parseInt(i[0].Shift_Key)){t==this.ToDate.Date&&(s=this.dgv.NewRow(),s.sno=this.dgv.Table.length+1,s.Employee=this.CCList[0].Items[h].Name,s.Employee_Key=this.CCList[0].Items[h].Value,s.From=r.ToString("dd/MMM/yyyy"),s.To=t.ToString("dd/MMM/yyyy"),s.Shift=g,s.Shift_Key=o,this.dgv.addRow(s)),t=t.AddDays(1);continue}s=this.dgv.NewRow(),s.sno=this.dgv.Table.length+1,s.Employee=this.CCList[0].Items[h].Name,s.Employee_Key=this.CCList[0].Items[h].Value,s.From=r.ToString("dd/MMM/yyyy"),s.To=t.AddDays(-1).ToString("dd/MMM/yyyy"),s.Shift=g,s.Shift_Key=o,this.dgv.addRow(s)}C.J0.IsEmpty(i[0].Shift_Key)?(r=t.AddDays(1),o=-1,g=""):(r=t,o=parseInt(i[0].Shift_Key),g=i[0].Shift.toString())}t=t.AddDays(1)}this.dgv.refreshDataView()}}}}]);