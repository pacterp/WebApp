"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[1387],{23768:(u,d,t)=>{t.r(d),t.d(d,{WebConfigViewModel:()=>c});var o=t(9659),r=t(66148),h=t(76199),C=t(29702),f=t(99393);class c extends h.g{get SelectedRow(){return this.ConfigPreferenceGrid.SelectedItem}set SelectedRow(i){i!=this.ConfigPreferenceGrid.SelectedItem&&(this.ConfigPreferenceGrid.SelectedItem=i)}constructor(i){let e;super(),this.DeletedConfig=[],this.setGridFocus=!0,this.SNO=1,this.Title=i,this.DisplayName=this.Title,this.ConfigPreferenceGrid=new C.vv,this.ConfigPreferenceGrid.Height=600,this.ConfigPreferenceGrid.BeginEdit.Subscribe(this,"onBeginEdit"),this.ConfigPreferenceGrid.Columns=[],this.ConfigPreferenceGrid.Width="",this.ConfigPreferenceGrid.CanUserAddRows=!0,this.ConfigPreferenceGrid.CanUserDeleteRows=!0,e=new f.O7,e.Header=o.d.GetResource("DocumentDesigner_Sno"),e.DisplayMember="Sno",e.ReadOnly=!0,e.Width=50,this.ConfigPreferenceGrid.Columns.push(e),e=new f.O7,e.Header="Name",e.DisplayMember="Name",e.Width=200,this.ConfigPreferenceGrid.Columns.push(e),e=new f.O7,e.Header="Value",e.Width=500,e.DisplayMember="Value",this.ConfigPreferenceGrid.Columns.push(e),this.ConfigPreferenceGrid.Table=[],this.ConfigPreferenceGrid.TableColumns.push("Sno"),this.ConfigPreferenceGrid.TableColumns.push("ConfigId"),this.ConfigPreferenceGrid.TableColumns.push("Name"),this.ConfigPreferenceGrid.TableColumns.push("Value"),this.GetConfigData()}onBeginEdit(i){let s=this.ConfigPreferenceGrid.Table.indexOf(i.args.item);if(s=-1==s||this.ConfigPreferenceGrid.Table.length-s<3?3:0,this.ConfigPreferenceGrid.CanUserAddRows)for(let a=0;a<s;a++){let g=this.ConfigPreferenceGrid.NewRow();g.Sno=this.ConfigPreferenceGrid.Table.length+1,g.ConfigId=0,this.ConfigPreferenceGrid.addRow(g)}}BeforeRowDeletingContextMenu(i){if(null!=this.SelectedRow&&null!=i&&i.length>=1){let e=[];if(i.forEach(n=>{null!=n&&e.push(n)}),confirm("Are you sure you want to delete?"))for(let n=0;n<e.length;n++){let l=e[n];null!=l&&(""!=r.J0.String(l.ConfigId)&&this.DeletedConfig.push(l.ConfigId.toString()),this.ConfigPreferenceGrid.removeRow(l))}}}UpdateSequence(){this.SNO=1,this.ConfigPreferenceGrid.Table.forEach(i=>{i.Sno=this.SNO++})}GetConfigData(){this.ConfigPreferenceGrid.Table.Clear();let i=o.d.common.getWebConfigData();if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0)for(let e=0;e<i.Tables[0].length;e++)if(""!=r.J0.String(i.Tables[0][e].Name)){let n=this.ConfigPreferenceGrid.NewRow();""!=r.J0.String(i.Tables[0][e].ConfigId)&&(n.ConfigId=i.Tables[0][e].ConfigId.toString()),n.Name=r.J0.String(i.Tables[0][e].Name),n.Value=r.J0.String(i.Tables[0][e].Value),n.Sno=this.ConfigPreferenceGrid.Table.length+1,this.ConfigPreferenceGrid.addRow(n)}}OnButtonClick(i){if("Save"==i){this.ConfigPreferenceGrid.angularGrid?.slickGrid&&this.ConfigPreferenceGrid.angularGrid?.slickGrid.getActiveCellNode()&&(this.ConfigPreferenceGrid.angularGrid.slickGrid.getActiveCell(),this.ConfigPreferenceGrid.angularGrid.slickGrid.getEditorLock().commitCurrentEdit());let e=o.d.common.setWebConfigData(this.GetConfigXML());null!=e&&e.Tables.length>0&&e.Tables[e.Tables.length-1].length>0&&e.Columns[e.Columns.length-1].Contains("ErrorMessage")&&(this.MessageVisibility=!0,this.DisplayMessage=e.Tables[e.Tables.length-1][0].ErrorMessage.toString())}else"Refresh"==i&&(this.GetConfigData(),this.UpdateSequence(),this.DeletedConfig.Clear())}GetConfigXML(){let i="";for(let e=0;e<this.ConfigPreferenceGrid.Table.length;e++)if(""!=r.J0.String(this.ConfigPreferenceGrid.Table[e].Name)){let n=0;null!=this.ConfigPreferenceGrid.Table[e].ConfigId&&""!=this.ConfigPreferenceGrid.Table[e].ConfigId.toString()&&(n=parseInt(this.ConfigPreferenceGrid.Table[e].ConfigId.toString())),i+=0==n?'<Row Action="NEW"':'<Row Action="MODIFY"',i+=' ConfigId="'+r.J0.String(this.ConfigPreferenceGrid.Table[e].ConfigId)+'"',i+=' Name="'+r.J0.String(this.ConfigPreferenceGrid.Table[e].Name)+'"',i+=' Value="'+r.J0.String(this.ConfigPreferenceGrid.Table[e].Value)+'"',i+=' IsVerified="Yes"',i+="/>"}for(let e=0;e<this.DeletedConfig.length;e++)""!=r.J0.String(this.DeletedConfig[e])&&(i+='<Row Action="DELETE"',i+=' ConfigId="'+this.DeletedConfig[e].toString()+'"/>');return i.length>0&&(i="<ConfigXML>"+i+"</ConfigXML>"),i.toString()}OnMessageCallBack(){this.res="Yes"}}}}]);