"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[9717],{95746:(re,W,f)=>{f.r(W),f.d(W,{BulkEditFilter:()=>V,BulkEditReplace:()=>oe,BulkEditViewModel:()=>ae});var w=f(74523),I=f(9659),t=f(66148),P=f(3955),R=f(76962),H=f(81322),v=f(4884),x=f(6532),Y=f(76199),L=f(29702),M=f(99393),B=f(5349),O=f(39107),U=f(12112),G=f(16645),X=f(43024),j=f(89417),p=f(41360),_=f(32881),Z=f(45319),Q=f(73955);function z(E,n){if(1&E&&(p.j41(0,"div",3),p.EFF(1,"\n            "),p.eu8(2,10),p.EFF(3,"\n        "),p.k0s()),2&E){const i=p.XpG();p.R7$(2),p.Y8G("obj",i.obj.AppRejDate)("group",i.form)}}function $(E,n){if(1&E){const i=p.RV6();p.j41(0,"button",6),p.bIt("click",function(){p.eBV(i);const a=p.XpG();return p.Njj(a.obj.onClickIkon("Suspend"))}),p.EFF(1),p.nI1(2,"translate"),p.k0s()}2&E&&(p.R7$(),p.JRh(p.bMT(2,1,"Suspend")))}let q=(()=>{class E{constructor(){}ngOnInit(){this.form=new j.gE({})}static{this.\u0275fac=function(r){return new(r||E)}}static{this.\u0275cmp=p.VBU({type:E,selectors:[["app-bulk-edit-approve-component"]],inputs:{obj:"obj"},standalone:!1,decls:35,vars:12,consts:[[1,"master-screen",2,"padding-bottom","4px","min-width","400px"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group row form-row col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"form-group","row","form-row","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],["class","primary-btn-wicon",3,"click",4,"ngIf"],[1,"fa-light","fa-rectangle-xmark"],["FieldDirective","",3,"obj","group"]],template:function(r,a){1&r&&(p.j41(0,"div",0),p.EFF(1,"\n    "),p.j41(2,"div",1),p.EFF(3,"\n        "),p.DNE(4,z,4,2,"div",2),p.EFF(5,"\n        "),p.j41(6,"div",3),p.EFF(7,"\n            "),p.eu8(8,4),p.EFF(9,"\n        "),p.k0s(),p.EFF(10,"\n        \n    "),p.k0s(),p.EFF(11,"\n    "),p.j41(12,"div",5),p.EFF(13,"\n      "),p.j41(14,"div"),p.EFF(15,"\n        "),p.j41(16,"button",6),p.bIt("click",function(){return a.obj.onClickIkon("Approve")}),p.EFF(17),p.nI1(18,"translate"),p.k0s(),p.EFF(19,"\n        "),p.j41(20,"button",7),p.bIt("click",function(){return a.obj.onClickIkon("Reject")}),p.EFF(21),p.nI1(22,"translate"),p.k0s(),p.EFF(23,"\n        "),p.DNE(24,$,3,3,"button",8),p.EFF(25,"\n        "),p.EFF(26,"\n        "),p.j41(27,"button",7),p.bIt("click",function(){return a.obj.Cancelclick()}),p.nrm(28,"i",9),p.EFF(29),p.nI1(30,"translate"),p.k0s(),p.EFF(31,"\n      "),p.k0s(),p.EFF(32,"\n      \n  "),p.k0s(),p.EFF(33,"\n"),p.k0s(),p.EFF(34,"\n")),2&r&&(p.R7$(4),p.Y8G("ngIf",a.obj.AppRejDate.Visible),p.R7$(4),p.Y8G("obj",a.obj.Remarks),p.R7$(9),p.JRh(p.bMT(18,6,"btnApprove")),p.R7$(4),p.JRh(p.bMT(22,8,"btnReject")),p.R7$(3),p.Y8G("ngIf",a.obj.SuspendVisiblity),p.R7$(5),p.JRh(p.bMT(30,10,"Cancel")))},dependencies:[_.bT,Z._,Q.D9],encapsulation:2})}}return E})();var ee=f(81188),F=f(76428),te=f(29461),ie=f(84402),se=f(27392),K=f(63076),ne=f(48876),le=f(1077),k=f(9503);class ae extends Y.g{get AppDisplayMessage(){return this._AppDisplayMessage}set AppDisplayMessage(n){n!=this._AppDisplayMessage&&(this._AppDisplayMessage=n,this.AppMessageVisibility=!t.J0.IsEmpty(this._AppDisplayMessage))}constructor(n,i=null){super(),this.ButtonApprove=new H.v,this.AppMessageVisibility=!1,this.HeaderAppearance=new O.bA,this.TextDataAppearance=new O.bA,this.NumberDataAppearance=new O.bA,this.SavePDF=new k.u("LW Document",10,"Group1"),this.SaveXLS=new k.u("LW Document",10,"Group1"),this.SaveXLSX=new k.u("LW Document",10,"Group1"),this._AppDisplayMessage="",this.VoucherData=new Array,this.TrasUserVisibility=!1,this.TranserUserVisiblity=!1,this.strOldUserID="",this.Remarks=new x.Dw(0),this.AppRejDate=new v.Lc(0),this.SuspendVisiblity=!1,this.CostCenterName="",this.ReplaceVisibility=!1,this.DeleteVisibility=!1,this.ShowRightPanel=!0,this.SaveButtonVisible=!1,this.ExportButtonVisible=!1,this.IsBarcode=!1,this.HideTitle=!1,this.Replace=null,this.IsLWApproval=!1,this.ID=0,this.intLinkDimCC=0,this.CostCenterID=0,this.MainTableName="",this.dvFields=null,this.dvFieldsNew=null,this.IsDetailVoucher=!1,this.IsSelectOnRowLeave=!0,this.IsApproval=!1,this.IsProductExists=!1,this.HideFilterDialog=!1,this.HideProductImage=!1,this.ShowFilter=!1,this.RemarksApprove=!1,this.RemarksReject=!1,this.RemarksSuspend=!1,this.SelectedFields=[],this.DateColIDs=new Array,this.EditColumns=new Array,this.EditColumnsDr=[],this.Entities=new P.bT,this.strWhereforAuctionHistory="",this.ProductImageVisibility=!1,this.ApproveVisibility=!1,this.PhotoTextVisibility=!1,this.ProductID=0,this.ProductPhoto="",this.ImportIsCode=!1,this.ImportVisiblity=!1,this.ExportVisibility=!1,this.ReportID=0,this.DB=null,this.IsDocument=!1,this.PrimaryKey="",this.PrimaryColumns="",this.ReportObj=null,this.Report=[],this.AddressFields=new Array,this.docAllowCols=["billno","billdate","linenarration","commonnarration","chequenumber","chequematuritydate"],this.ReportFilterVisible=!1,this.oDocPayroll=null,this.vnofield="",this.dimfield="",this.cprimary=null,this.strVoucherNo="VoucherNo",this.dicBarLayouts=new P.bT,this.ClassName="BulkEditViewModel",this.FromDate=new v.Lc,this.FromDate.Label=I.d.GetResource("Calender_FromDate"),this.ToDate=new v.Lc,this.ToDate.Label=I.d.GetResource("Calender_ToDate"),this.FromDate.CustomFormat=I.d.SessionManager.Preferences["Date Format"],this.ToDate.CustomFormat=I.d.SessionManager.Preferences["Date Format"],this.FromDate.Date=t.J0.ParseDate(I.d.SessionManager.AccountingDate),this.ToDate.Date=new Date,this.DateRanges=X.w.getDateRanges(),this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.AppRejDate.CustomFormat=I.d.SessionManager.Preferences["Date Format"],this.AppRejDate.Date=new Date,this.SavePDF.Label="PDF",this.SaveXLS.Label="Spreadsheet (xlsx)",this.SaveXLSX.Label="Spreadsheet (Open xlsx)",this.ID=n,this.DB=i,this.TargetUserID=new le.y$(0),this.TargetUserID.CCID=7,this.TargetUserID.TypeID=4,this.InitGrids(),this.EditGrid.SelectAll.Visible=!0,this.Margin="2",null!=i&&(this.HideFilterDialog=!0,this.ShowRightPanel=!1,this.HideTitle=!0,this.EditGrid.SearchCols.Width="140",this.EditGrid.SearchOptions.Width="100",this.EditGrid.SearchText.Width="130",this.Margin="2"),this.HideFilterDialog&&(this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,(null!=this.ReportObj&&this.ReportObj.IsDefaultSortColumnExists||I.d.SessionManager.IsWebApplication)&&(this.bgWorker_DoWork(null,null),this.bgWorker_RunWorkerCompleted(null,null)))}bgWorker_DoWork(n,i){null!=this.ReportObj?null!=this.ReportObj.oReportDialog?this.ReportObj.oReportDialog.OnOkClick("OK"):this.ReportObj.Filter.OnButtonClick("OK"):this.RefreshData()}bgWorker_RunWorkerCompleted(n,i){this.DisplayName=this.Title,null==this.DB&&this.HideFilterDialog&&null!=this.EditGrid.Table&&0==this.EditGrid.Table.length&&(this.DisplayMessage="No Data Available.")}AddAddressColumns(n,i){let r,a=["ContactPerson","Address1","Address2","Address3","City","State","Zip","Country","Phone1","Phone2","Fax","Email1","Email2","URL","AddressName"],C="Account",s=n.filter(u=>u.CostCenterID==i);s.length>0&&(C=s[0].CostCenterName.toString());for(let u=0;u<a.length;u++)r={},r.SysTableName="COM_Address",r.UserColumnName=r.SysColumnName=a[u],r.ColumnCostCenterID=r.CostCenterID=i,r.CostCenterName=C,r.CostCenterColID=4e5+u+200*i,r.IsForeignKey=!1,r.IsColumnUserDefined=!1,n.push(r)}AddPmsUserColumns(n,i){let r,C="User",s=n.filter(u=>u.CostCenterID==i);s.length>0&&(C=s[0].CostCenterName.toString()),r={},r.SysTableName="ADM_Users",r.UserColumnName="Transer User",r.SysColumnName="ccAlpha13",r.CostCenterID=i,r.CostCenterName=C,r.CostCenterColID=15408700,r.IsForeignKey=!1,r.IsColumnUserDefined=!1,r.UserColumnType="LISTBOX",r.ColumnDataType="LISTBOX",r.ParentCostCenterID=7,r.ColumnCostCenterID=7,r.ColumnCCListViewTypeID=4,n.push(r)}InitGrids(){this.SaveButtonVisible=!0,this.ExportButtonVisible=I.d.SessionManager.IsActionAssigned(49,"Bulk Export Data");let n=I.d.common.BulkEditDetals(6,this.ID,0);null!=n&&n.Tables[3].length>0&&!t.J0.IsEmpty(n.Tables[3][0].PrefValue)&&n.Tables[3].length>0&&!t.J0.IsEmpty(n.Tables[3][0].PrefValue.toString())&&(this.intLinkDimCC=t.J0.IntTryParse(t.J0.String(n.Tables[3][0].PrefValue))),this.CostCenterID=parseInt(n.Tables[0][0].CostCenterID),this.DisplayName=t.J0.String(n.Tables[0][0].Name),this.Title=this.DisplayName,this.MainTableName=t.J0.String(n.Tables[1][0].TableName),this.CostCenterName=t.J0.String(n.Tables[1][0].Name);let i=I.d.common.BulkEditDetals(2,0,this.CostCenterID);2==this.CostCenterID&&this.AddAddressColumns(i.Tables[0],this.CostCenterID),this.intLinkDimCC==this.CostCenterID&&this.AddPmsUserColumns(i.Tables[0],this.intLinkDimCC);let r=new t.VB,a=new t.VB;r.LoadXml(t.J0.String(n.Tables[0][0].Options)),this.IsSelectOnRowLeave=null!=r.SelectSingleNode("XML/SelectOnRowLeave"),this.IsDetailVoucher=null!=r.SelectSingleNode("XML/DetailsVoucher"),this.HideFilterDialog=null!=r.SelectSingleNode("XML/HideFilterDialog"),this.HideProductImage=null!=r.SelectSingleNode("XML/HideProductImage"),this.IsApproval=null!=r.SelectSingleNode("XML/ApproveDocuments"),this.ShowFilter=null!=r.SelectSingleNode("XML/ShowFilter"),this.IsApproval&&(this.RemarksApprove=null!=r.SelectSingleNode("XML/RemarksApprove"),this.RemarksReject=null!=r.SelectSingleNode("XML/RemarksReject"),this.RemarksSuspend=null!=r.SelectSingleNode("XML/RemarksSuspend"),this.ExportButtonVisible=!1),this.IsBarcode=null!=r.SelectSingleNode("XML/BarcodePrint"),this.IsBarcode&&(this.SaveButtonVisible=!1,this.IsDetailVoucher=!0,this.ExportButtonVisible=!1),3==this.CostCenterID&&!this.HideProductImage&&(this.ProductImageVisibility=!0),this.CostCenterID>4e4&&this.CostCenterID<5e4?(this.IsDocument=!0,this.IsLWApproval=!!(this.IsDetailVoucher&&n.Tables[2].length>0&&1==parseInt(n.Tables[2][0].IsLineWise)),this.AppRejDate.Visible=i.Tables[3].filter(d=>"AppDate"==d.PrefName&&"True"==d.PrefValue).length>0):this.AppRejDate.Visible=!1;let s,C=i.Tables[0];this.dvFields=C,this.dvFieldsNew=C,null!=r.SelectSingleNode("XML/Report")?(this.ReportID=parseInt(r.SelectSingleNode("XML/Report").innerHTML),this.InitReport()):this.ReportID=0,(this.IsDocument||2==this.CostCenterID||3==this.CostCenterID||92==this.CostCenterID||93==this.CostCenterID||95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID||this.CostCenterID>5e4)&&this.IsApproval&&I.d.SessionManager.IsActionAssigned(49,"Document Bulk Approval")?(this.ButtonApprove.Visible=!0,this.SaveButtonVisible=!1,this.IsDocument&&this.IsLWApproval&&(this.SuspendVisiblity=I.d.SessionManager.IsActionAssigned(this.CostCenterID,"Suspend"))):this.ButtonApprove.Visible=!1,(2==this.CostCenterID||3==this.CostCenterID||this.CostCenterID>5e4)&&(this.DeleteVisibility=I.d.SessionManager.IsActionAssigned(49,"Bulk Delete"),this.DeleteVisibility&&(this.DeleteVisibility=I.d.SessionManager.IsActionAssigned(this.CostCenterID,"Delete"))),this.EditGrid=new L.vv,this.EditGrid.Width="",this.EditGrid.Height=void 0,this.EditGrid.CanUserDeleteRows=!1,this.EditGrid.Columns=[],this.EditGrid.SearchVisible=!0,this.EditGrid.SearchColStartIndex=1,this.EditGrid.CanUserSortColumns=!0,this.EditGrid.Visible=!1,this.EditGrid.CellEditEnding.Subscribe(this,"EditGridOnCellEditEnding"),this.EditGrid.OnPreviewKeyDown.Subscribe(this,"OnKeyDown"),this.Report.length>0&&this.EditGrid.Clear(),s=new M.O7,s.Header="Select",s.DisplayMember="Select",s.DataType="CheckBox",s.Width=50,s.IsFrozen=!I.d.IsNativeMobile,s.DisableTab=!0,this.EditGrid.Columns.push(s);let u=0;r.LoadXml(t.J0.String(n.Tables[0][0].FieldsXML));let m=new Array;if(this.IsDocument){let d=new U.PE,e=[];i.Tables[1].forEach(l=>{e.Clear(),d.ParseFormula(t.J0.String(l.Formula),e);let h=null;for(let D=e.length-1;D>=0;D--)h=e[D],h.getTokenClass()==U.C3.OPERAND&&h.getTokenType()==U.Wz.REFERENCE&&!m.Contains(h.tokenValue.toString())&&m.push(h.tokenValue.toString())})}if(this.intLinkDimCC==this.CostCenterID){a.LoadXml(t.J0.String(n.Tables[0][0].FilterXML));for(let d=0;d<a.DocumentElement.children.length;d++){const e=a.DocumentElement.children[d];!t.J0.IsEmpty(e.attributes.Field.value)&&"15408700"==e.attributes.Field.value&&(t.J0.IsEmpty(e.attributes.Value_Key.value)||(this.strOldUserID=e.attributes.Value_Key.value,this.TrasUserVisibility=!0))}}for(let d=0;d<r.DocumentElement.children.length;d++){const e=r.DocumentElement.children[d];if(this.dvFields=t.J0.IsEmpty(e.attributes.ID.value)?[]:this.dvFieldsNew.filter(l=>l.CostCenterColID==e.attributes.ID.value),0!=this.dvFields.length){if(this.SelectedFields.push(this.dvFields[0]),u=parseInt(this.dvFields[0].CostCenterColID),s=new M.O7,s.DisplayMember="C"+(this.SelectedFields.length-1),s.SectionName=s.DisplayMember,s.Header=t.J0.String(this.dvFields[0].UserColumnName),s.Width=parseInt(e.attributes.Width.value),s.ReadOnly="YES"!=e.attributes.Edit.value,!t.J0.IsEmpty(e.attributes.ShowCode)&&"YES"==e.attributes.ShowCode.value&&(this.dvFields[0].ShowCode="YES"),this.ButtonApprove.Visible&&(s.ReadOnly=!0),s.ID=t.J0.String(this.dvFields[0].SysColumnName),"COM_ADDRESS"==t.J0.String(this.dvFields[0].SysTableName).toUpperCase()&&this.AddressFields.push(s.SectionName),s.CrRefID=u,null!=this.ReportObj&&(s.OPParams=e.attributes.RPTID.value),!s.ReadOnly&&!this.IsBarcode)if(this.IsDocument)if(s.ID.startsWith("dcAlpha")||s.ID.toLowerCase().startsWith("dcccnid")||this.docAllowCols.Contains(s.ID.toLowerCase())){(0!=i.Tables[1].filter(D=>D.CostCenterColID==u.toString()).length||m.Contains(s.Header))&&(alert(s.Header+" Used in formula hence its not editable"),s.ReadOnly=!0);let h=i.Tables[0].filter(D=>D.CostCenterColID==u.toString());0!=h.Length&&("dcCCNID2"==s.ID&&I.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"TRUE"==I.d.SessionManager.Preferences.EnableLocationWise.toUpperCase()?(alert(s.Header+" Used in Location wise"),s.ReadOnly=!0):"dcCCNID1"==s.ID&&I.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"TRUE"==I.d.SessionManager.Preferences.EnableDivisionWise.toUpperCase()?(alert(s.Header+" Used in Dimension wise"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&!t.J0.IsEmpty(h[0].ColumnCostCenterID)&&parseInt(h[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences["Maintain Dimensionwise stock"].toString()==h[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise stock"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Batches")&&!t.J0.IsEmpty(h[0].ColumnCostCenterID)&&parseInt(h[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences["Maintain Dimensionwise Batches"].toString()==h[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Batches"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise AverageRate")&&!t.J0.IsEmpty(h[0].ColumnCostCenterID)&&parseInt(h[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences["Maintain Dimensionwise AverageRate"].toString()==h[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise AverageRate"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Bills")&&!t.J0.IsEmpty(h[0].ColumnCostCenterID)&&parseInt(h[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences["Maintain Dimensionwise Bills"].toString()==h[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Bills"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("DimensionwiseBins")&&!t.J0.IsEmpty(h[0].ColumnCostCenterID)&&parseInt(h[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences.DimensionwiseBins.toString()==h[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Bins"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("DimensionwiseAssets")&&!t.J0.IsEmpty(h[0].ColumnCostCenterID)&&parseInt(h[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences.DimensionwiseAssets.toString()==h[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Assets"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("DimWiseCreditDebit")&&!t.J0.IsEmpty(h[0].ColumnCostCenterID)&&parseInt(h[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences.DimWiseCreditDebit.toString()==h[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Credit Debit"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("DimensionwiseCurrency")&&!t.J0.IsEmpty(h[0].ColumnCostCenterID)&&parseInt(h[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences.DimensionwiseCurrency.toString()==h[0].ColumnCostCenterID.toString()&&(alert(s.Header+" Used in Dimension wise Currency"),s.ReadOnly=!0))}else s.ReadOnly=!0;else if(2==this.CostCenterID&&s.ID.startsWith("AccountCode")){let l=i.Tables[2].filter(h=>0==h.IsGroupCode&&0==h.IsName);s.ReadOnly=null!=l&&l.length>0&&"true"==t.J0.String(l[0].IsEnable).toLowerCase()}else if(3==this.CostCenterID&&s.ID.startsWith("ProductCode")){let l=i.Tables[2].filter(h=>0==h.IsGroupCode&&0==h.IsName);s.ReadOnly=null!=l&&l.length>0&&"true"==t.J0.String(l[0].IsEnable).toLowerCase()}else if(16==this.CostCenterID&&s.ID.startsWith("BatchCode")){let l=i.Tables[3].filter(h=>"BatchCodeAutoGen"==h.Name);(l.length>0&&"true"==t.J0.String(l[0].Value).toLowerCase()||i.Tables[2].length>0&&!t.J0.IsEmpty(i.Tables[2][0].IsParentCodeInherited)&&(0,R.yG0)(i.Tables[2][0].IsParentCodeInherited))&&(s.ReadOnly=!0)}else if(93==this.CostCenterID&&s.ID.startsWith("Code")){let l=i.Tables[2].filter(h=>0==h.IsGroupCode&&0==h.IsName);s.ReadOnly=null!=l&&l.length>0&&"true"==l[0].IsEnable.toString().toLowerCase()}else if(this.CostCenterID>=50001&&s.ID.startsWith("Code")){let l=i.Tables[2].filter(h=>0==h.IsGroupCode&&0==h.IsName);s.ReadOnly=null!=l&&l.length>0&&"true"==t.J0.String(l[0].IsEnable).toLowerCase()}if(this.SelectedFields.length<3&&(s.IsFrozen=!I.d.IsNativeMobile),s.IsColumnUserDefined=!!(0,R.yG0)(this.dvFields[0].IsColumnUserDefined),s.DataType=t.J0.String(this.dvFields[0].UserColumnType).toUpperCase(),241==u)s.ValueMember="AccountTypeID",s.DisplayMember="AccountType",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=i.Tables[4],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(264==u)s.ValueMember="ProductTypeID",s.DisplayMember="ProductType",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=i.Tables[4],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(252==u)s.ValueMember="Value",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=V.GetBillWiseTable(),s.DataType="ComboBox";else if("StatusID"==s.ID||93==this.CostCenterID&&"Status"==s.ID)s.ValueMember="ID",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=this.IsDocument?i.Tables[2]:i.Tables[1],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if("Attachments"==s.ID)s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onAttachClick");else if(95!=this.CostCenterID&&103!=this.CostCenterID&&104!=this.CostCenterID&&129!=this.CostCenterID||"SNO"!=s.ID){if(s.ReadOnly||!t.J0.IsEmpty(this.dvFields[0].IsForeignKey)&&(0,R.yG0)(this.dvFields[0].IsForeignKey)&&parseInt(this.dvFields[0].ColumnCostCenterID)>0&&(s.DataType="LISTBOX",s.CostCenterID=parseInt(this.dvFields[0].ColumnCostCenterID),3==s.CostCenterID&&!this.HideProductImage&&(this.IsProductExists=!0,this.ProductImageVisibility=!0),s.TypeID=parseInt(this.dvFields[0].ColumnCCListViewTypeID)),"DATE"==s.DataType)s.DataType="DATE",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if(s.IsColumnUserDefined)if("DATE"==s.DataType||"DATETIME"==s.DataType)s.DataType="DATE",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if("TIME"==s.DataType)s.DataType="TIME",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if("NUMERIC"==s.DataType)s.DataType="FLOAT";else if("SELECTIONBOX"==s.DataType||"editablecombobox"==s.DataType)s.DataType="SELECTIONBOX",s.CostCenterID=this.CostCenterID;else if("COMBOBOX"==s.DataType){let l=[],h={};this.dvFields[0].UserProbableValues.toString().split(";").forEach(D=>{h={},h.Value=D,h.Name=D,l.push(h)}),s.ValueMember="Value",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=l,s.DataType="ComboBox"}else if("LISTBOX"==s.DataType)s.DataType="LISTBOX",I.d.SessionManager.IsWebApplication&&(s.ValueMember="C"+(this.SelectedFields.length-1)+"_Key"),s.CostCenterID=parseInt(t.J0.String(this.dvFields[0].ColumnCostCenterID)),s.TypeID=parseInt(t.J0.String(this.dvFields[0].ColumnCCListViewTypeID));else if("LOOKUP"==s.DataType){s.ValueBinding=s.ID,s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value";let l=I.d.common.GetDataSet("DOC019",parseInt(this.dvFields[0].ColumnCCListViewTypeID).toString());if(null!=l){let h=[];for(let D=0;D<l.length;D++)h.push(B._p.ComboBoxItems_2(l[D].Name.toString(),l[D].NodeID.toString()));s.ComboData=h}}}else s.DataType="LINK",s.Click.Subscribe(this,"onDimClick");if("FLOAT"==t.J0.String(this.dvFields[0].ColumnDataType)){s.DataType="FLOAT";let l=t.J0.String(this.dvFields[0].Decimal);s.ID.toLowerCase().Contains("dcnum")?!t.J0.IsEmpty(l)&&parseFloat(l)>=0?s.DecimalPoints=l:I.d.SessionManager.Preferences.ContainsKey("DecimalsinExtraFields")&&""!=I.d.SessionManager.Preferences.DecimalsinExtraFields&&(s.DecimalPoints=I.d.SessionManager.Preferences.DecimalsinExtraFields):"Quantity"==s.ID?""!=l&&parseFloat(l)>=0?s.DecimalPoints=l:I.d.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&""!=I.d.SessionManager.Preferences.DecimalsinQty&&(s.DecimalPoints=I.d.SessionManager.Preferences.DecimalsinQty):"Gross"==s.ID||"Rate"==s.ID?""!=l&&parseFloat(l)>=0?s.DecimalPoints=l:I.d.SessionManager.Preferences.ContainsKey("DecimalsinRate")&&""!=I.d.SessionManager.Preferences.DecimalsinRate&&(s.DecimalPoints=I.d.SessionManager.Preferences.DecimalsinRate):"Amount"==s.ID||"DebitAmount"==s.ID||"CreditAmount"==s.ID?""!=l&&parseFloat(l)>=0?s.DecimalPoints=l:I.d.SessionManager.Preferences.ContainsKey("DecimalsinAmount")&&""!=I.d.SessionManager.Preferences.DecimalsinAmount&&(s.DecimalPoints=I.d.SessionManager.Preferences.DecimalsinAmount):""!=l&&parseFloat(l)>=0&&(s.DecimalPoints=l)}else"COMBOTEXT"==t.J0.String(this.dvFields[0].ColumnDataType)&&(s.DataType="LINK",s.Click.Subscribe(this,"onDocClick"),this.vnofield=s.DisplayMember);95!=this.CostCenterID&&103!=this.CostCenterID&&104!=this.CostCenterID&&129!=this.CostCenterID||s.ReadOnly||s.ID.toLowerCase().Contains("alpha")||s.ID.toLowerCase().Contains("ccnid")||(s.ReadOnly=!0),s.ReadOnly?s.DisableTab=!0:(this.EditColumns.push(s),this.EditColumnsDr.push(this.dvFields[0].Row),s.DisableTab=!1),this.EditGrid.Columns.push(s),null!=this.ReportObj&&("LISTBOX"==s.DataType||"DATE"==s.DataType?(this.EditGrid.TableColumns.push(s.DisplayMember),this.EditGrid.TableColumns.push(s.DisplayMember+"_Key")):this.EditGrid.TableColumns.push("FLOAT"==s.DataType?s.DisplayMember:"ComboBox"==s.DataType?s.ValueBinding:s.DisplayMember))}else if(null!=this.ReportObj){var o=this.ReportObj.ReportColumns.find(l=>l.ID==e.attributes.RPTID.value);if(null==o||null==o)continue;s=new M.O7,s.DisplayMember="RC"+this.EditGrid.TableColumns.length,s.OPParams=e.attributes.RPTID.value,s.SectionName=s.DisplayMember,s.Header=o.HeaderText,s.Width=parseInt(e.attributes.Width.value),s.ReadOnly=!0,s.DataType=o.DataAppearance.ColumnType,this.EditGrid.Columns.push(s),"DATE"==s.DataType||"DATETIME"==s.DataType?(s.DataType="DATE",this.DateColIDs.push(s.SectionName),this.EditGrid.TableColumns.push(s.DisplayMember),this.EditGrid.TableColumns.push(s.DisplayMember+"_Key")):"FLOAT"==s.DataType?(s.DecimalPoints=o.DataFormat.DecimalsPoints.ToString(),this.EditGrid.TableColumns.push(s.DisplayMember),o.LinkType==F.T6.Dimension&&(s.DataType="LINK",s.Click.Subscribe(this,"onDimClick"),this.dimfield=s.DisplayMember+"_ID",this.EditGrid.TableColumns.push(s.DisplayMember+"_ID"))):(this.EditGrid.TableColumns.push(s.DisplayMember),(o.LinkType==F.T6.Attachment||o.LinkType==F.T6.Dimension||"11414"==o.FieldName&&o.LinkType==F.T6.Document)&&(s.DataType="LINK",o.LinkType==F.T6.Attachment?(s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onAttachClick")):o.LinkType==F.T6.Dimension?(s.Click.Subscribe(this,"onDimClick"),this.dimfield=s.DisplayMember+"_ID"):o.LinkType==F.T6.Document&&(s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onDocClick")),this.EditGrid.TableColumns.push(s.DisplayMember+"_ID")))}}s=new M.O7,s.Header="Message",s.DisplayMember="Message",s.Width=250,s.ReadOnly=!0,s.DisableTab=!0,this.EditGrid.Columns.push(s),this.EditGrid.AddSearchCols(),this.Filter=new V(i,this),this.StaticFilter=new V(i,this),this.ShowFilter?this.Filter.LoadXML(t.J0.String(n.Tables[0][0].FilterXML)):this.StaticFilter.LoadXML(t.J0.String(n.Tables[0][0].FilterXML)),this.IsDocument?(this.FromDate.Visible=!0,this.ToDate.Visible=!0):(this.FromDate.Visible=!1,this.ToDate.Visible=!1)}GetColumn(n,i,r,a,C){let s=new O.yL;"Millions"==I.d.SessionManager.Preferences.Commas?s.Commas=1:"Lakhs"==I.d.SessionManager.Preferences.Commas&&(s.Commas=2),s.DateType=I.d.SessionManager.Preferences["Date Format"];let u=new F.D_;return u.gridLines=3,u.ID=n,u.FieldName=n,u.HeaderText=I.d.GetResource(i),u.HeaderAppearance=a,u.DataAppearance=a,u.HeaderHeight=22,u.width=C,u.DataFormat=s,u.ColumnType=r,u}SetCellValue(n,i,r,a,C){G.ReportViewModel.SetCellValue(n,i,r,-1,a,C)}EditGridOnCellEditEnding(n){0!=n.cell&&this.IsSelectOnRowLeave&&(n.item.Select=!0)}onDocClick(n){var i=this;return(0,w.A)(function*(){if(null!=i.EditGrid.SelectedItem&&i.EditGrid.TableColumns.Contains(i.vnofield)){let r,a;if(a=t.J0.String(n?.command).Contains("-")?I.d.report.GetDocumentDetailsByVoucherNo(t.J0.String(n.command.trimLeft())):I.d.report.GetDocumentDetailsByVoucherNo(i.EditGrid.SelectedItem[i.vnofield].toString()),r=t.J0.Int(a.obj),r>0){let C;if(C=a.Tables[0].length>0?a.Tables[0][0]:a.Tables[1][0],40054==parseInt(C.CostCenterID)){const{MonthlyPayrollComponent:s}=yield Promise.resolve().then(f.bind(f,33798)),{MonthlyPayrollViewModel:u}=yield Promise.resolve().then(f.bind(f,28260));i.oDocPayroll=new u(C.DocumentName.toString(),"",C.VoucherNo.toString()),I.d.page.addNewTab({title:C.DocumentName.toString(),component:s,params:{obj:i.oDocPayroll}})}else if(40095==parseInt(C.CostCenterID)){const{FinalSettlementComponent:s}=yield Promise.resolve().then(f.bind(f,65692)),{FinalSettlementViewModel:u}=yield Promise.resolve().then(f.bind(f,46898));i.oDocPayroll=new u(C.DocumentName.toString(),C.VoucherNo.toString()),I.d.page.addNewTab({title:C.DocumentName.toString(),component:s,params:{obj:i.oDocPayroll}})}else{const{AddEditDocumentComponent:s}=yield Promise.resolve().then(f.bind(f,8405)),{AddEditDocumentViewModel:u}=yield Promise.resolve().then(f.bind(f,27490));let m=new u(parseInt(C.CostCenterID),C.DocumentName.toString(),!0);m.ScreenObject.DocPrefix.ComboBox.SelectedValue=C.DocPrefix.toString(),m.ScreenObject.DocPrefix.TextBox.Text=C.DocNumber.toString(),m.OnDocPrefixChanged("lostFocus"),m.ScreenObject.FillDocumentPrefix(!0),I.d.page.addNewTab({component:s,params:{obj:m}})}}}})()}onDimClick(n){if(t.J0.IsEmpty(this.dimfield)&&(this.dimfield=this.PrimaryKey),null!=this.EditGrid.SelectedItem&&this.EditGrid.TableColumns.Contains(this.dimfield)){this.EditGrid.TableColumns.Contains(n)&&(n=this.EditGrid.SelectedItem[n].toString());let i=new ne.DocumentViewerViewModel;i.DocumentViewerViewModel_ByVoucherNo_3(n,parseInt(t.J0.IsEmpty(this.EditGrid.SelectedItem[this.dimfield])?"0":this.EditGrid.SelectedItem[this.dimfield]),this.CostCenterID),i.IsDocumentFound?I.d.page.addNewTab({component:K.DocumentViewerComponent,params:{obj:i}}):(i.DocumentViewerViewModel_ByVoucherNo_3(n,0,this.CostCenterID),i.IsDocumentFound&&I.d.page.addNewTab({component:K.DocumentViewerComponent,params:{obj:i}}))}}onAttachClick(n){return(0,w.A)(function*(){if(null!=(n=n.command)){let i=t.J0.GetPath(n);I.d.IsMobile&&I.d.IsNativeMobile?yield se.P.open({url:i,isPDF:!1,isExport:!1}):window.open(i)}})()}InitReport(){let n=new G.ReportViewModel;n.ReportViewModel_1(this.ReportID,null!=this.DB,!0),this.ReportObj=n,this.ReportObj.ScreenName="BULK",this.ReportObj.BulkEdit=this,this.Report.push(this.ReportObj),this.ReportFilterVisible=!this.HideFilterDialog}OnButtonClick(n){if(this.DisplayMessage="","Save"==n){if(null==this.EditGrid.Table)return;let i=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==i.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4?this.SaveDocument(i):this.SaveDimension(i),this.DisplayMessage=95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID?"Saved successfully":"Posting Completed"}else if("Delete"==n){if(!this.DeleteVisibility)return;let i=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==i.length)return void(this.DisplayMessage="No Rows Selected");if(!confirm("Do you want to delete selected rows?"))return;this.CostCenterID>4e4&&this.CostCenterID<5e4||this.DeleteDimension(i)}else if("ShowAssigningUser"==n){if(this.strOldUserID.length<=0)return void(this.DisplayMessage="Please select user from filter before transfer");this.TranserUserVisiblity=!0,I.d.page.ShowDialog(this,ie.s,{ShowCenter:!1,HideClose:!0,NoWidth:!0,Title:"Transer User"})}else if("HideAssignUserPanel"==n)this.TranserUserVisiblity=!1,I.d.page.HideDialog(this.PopUpGUID);else if("TransferUser"==n){if(this.intLinkDimCC>0){if(null==this.EditGrid.Table)return;let i=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==i.length)return void(this.DisplayMessage="No Rows Selected");if(this.strOldUserID.length<=0)return void(this.DisplayMessage="Please select the before transfer");if(0==this.TargetUserID.SelectedValue)return void(this.DisplayMessage="Please select the user before transfer");if(t.J0.IntTryParse(this.strOldUserID.toString())==this.TargetUserID.SelectedValue)return void(this.DisplayMessage="Both Users are same");this.TransferUsers(i)}}else if("BACK"==n)this.EditGrid.Visible=!0;else if("OK"==n)this.EditGrid.Visible=!0,this.Filter.FilterGrid.commitEdit(),this.RefreshData();else if("Filter"==n)this.EditGrid.Visible=!1,this.Report.length>0&&(this.Report[0].ShowFilter=!0,this.ReportFilterVisible=!0);else if("Refresh"==n)this.Report.length>0?this.Report[0].Refresh():this.RefreshData();else if("Import"==n){let i=[];this.DtImport=[];let r=new M.O7;r.DisplayMember="FieldName",r.Header=I.d.GetResource("Import_FieldName"),r.DataType="TextBlock",r.Width=100,r.ReadOnly=!0,i.push(r),this.DtImport.Columns.push("FieldName"),r=new M.O7,r.DisplayMember="Name",r.ValueMember="Value",r.ValueBinding="FeatureFieldName",r.Header=I.d.GetResource("Import_FeatureFieldName"),r.DataType="ComboBox",r.Width=120;let a=new Array;a.push(B._p.ComboBoxItems_2("","")),this.EditGrid.Columns.forEach(C=>{null!=C.ID&&"DocDate"!=C.ID&&a.push(B._p.ComboBoxItems_2(C.Header,C.ID))}),r.ComboData=a,i.push(r),this.DtImport.Columns.push("FeatureFieldName"),this.IsImport=!0,this.ImportCols=i,this.ImportVisiblity=!0,this.ProductImageVisibility=!1,this.ExportVisibility=!1}else if("openfile"!=n)if("ImportOK"==n)null!=this.ExcelTable&&this.ExcelTable.length>0&&this.importWorker_DoWork(null,null);else if("ImportCancel"==n)this.ImportVisiblity=!1,3==this.CostCenterID&&!this.HideProductImage&&(this.ProductImageVisibility=!0);else if("PopUp"==n);else if("Approve"==n)this.ShowRightPanel=!0,this.ProductImageVisibility=!1,this.ReplaceVisibility=!1,this.ApproveVisibility=!0,this.AppDisplayMessage="",this.AppMessageVisibility=!1,this.Remarks.Text="",this.ExportVisibility=!1,I.d.page.ShowDialog(this,q,{ShowCenter:!0,HideClose:!0,NoWidth:!0,Title:I.d.GetResource("ApproveReject")});else if("CancelAction"==n)this.ApproveVisibility=!1,I.d.page.HideDialog(this.PopUpGUID),null!=this.DB&&(this.ShowRightPanel=!1);else if("Barcode"==n){if(null==this.EditGrid.Table)return;let i=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==i.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4&&this.BarcodeDocument(i)}else if("Export"==n)this.ExportVisibility=!0,this.ImportVisiblity=!1,this.ProductImageVisibility=!1,this.TranserUserVisiblity=!1;else if("CancelExport"==n)this.ExportVisibility=!1;else if("ExportData"==n){let r,i=new G.ReportViewModel;this.VoucherColumns=new Array,this.HeaderAppearance.Alignment="Left",this.HeaderAppearance.FontSize=12,this.HeaderAppearance.IsBold=!0,this.HeaderAppearance.BackColor="White",this.HeaderAppearance.ForeColor="Black",this.TextDataAppearance.Alignment="Left",this.TextDataAppearance.FontSize=12,this.TextDataAppearance.BackColor="White",this.TextDataAppearance.ForeColor="Black",this.NumberDataAppearance.Alignment="Right",this.NumberDataAppearance.FontSize=12,this.NumberDataAppearance.BackColor="White",this.NumberDataAppearance.ForeColor="Black";for(let m=0;m<this.EditGrid.Columns.length;m++)t.J0.IsEmpty(this.EditGrid.Columns[m].ID)||(r=this.GetColumn(this.EditGrid.Columns[m].DisplayMember,this.EditGrid.Columns[m].Header,this.EditGrid.Columns[m].DataType,this.TextDataAppearance,100),r.HeaderText=this.EditGrid.Columns[m].Header,null!=this.EditGrid.Columns[m].DataType&&"float"==this.EditGrid.Columns[m].DataType.toLowerCase()&&(r.DataFormat.DecimalsPoints=parseInt(this.EditGrid.Columns[m].DecimalPoints)),this.VoucherColumns.push(r));this.VoucherData.Clear(),this.EditGrid.Table.forEach(m=>{this.oRow=new O.Ji(this.VoucherColumns.length,22),this.oRow.Height=22;for(let o=0;o<this.VoucherColumns.length;o++){let d=this.VoucherColumns[o];t.J0.IsEmpty(m[d.ID])||G.ReportViewModel.SetCellValue(m[d.ID],d.DataFormat,d.ColumnType,-1,this.oRow.Cells[o],d.ID)}this.VoucherData.push(this.oRow)}),i.ReportColumns=this.VoucherColumns,i.Data=this.VoucherData,i.ScreenName=this.Title,i.SaveXLS=this.SaveXLS,i.SavePDF=this.SavePDF,i.SaveXLSX=this.SaveXLSX;let a=[],C={},u="<RptBody><LevelTree>None</LevelTree><LevelNo>10</LevelNo><_ColumnHeaderFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_ColumnHeaderFontStream><_GroupFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_GroupFontStream><_SubTotalFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_SubTotalFontStream><_GrandTotalFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_GrandTotalFontStream><BodyHeaderHeight>50</BodyHeaderHeight><ShowHeaderBackColors>true</ShowHeaderBackColors><ShowBodyHorizontalLines>true</ShowBodyHorizontalLines><ShowBodyVerticalLines>true</ShowBodyVerticalLines><ShowBodyBorders>false</ShowBodyBorders><ShowBodyBackColors>true</ShowBodyBackColors><CenterOnPage>false</CenterOnPage><VerticalAlignment>Center</VerticalAlignment><BodyPosition>Fixed</BodyPosition><BodyBottom>Fixed</BodyBottom><BodyHeight>800</BodyHeight><LeftMargin>15</LeftMargin><PageWidth>829</PageWidth><IsLandscape>false</IsLandscape><IgnoreBody>false</IgnoreBody><ReportHeaderHeight>101</ReportHeaderHeight><PageHeaderHeight>5</PageHeaderHeight><PageFooterHeight>5</PageFooterHeight><ReportFooterHeight>10</ReportFooterHeight><PageHeaderPosition>Fixed</PageHeaderPosition><ShowReportHeader>FirstPage</ShowReportHeader><ShowPageHeader>EveryPage</ShowPageHeader><ReportFooterPosition>Fixed</ReportFooterPosition><PageFooterPosition>Fixed</PageFooterPosition><ShowReportFooter>LastPage</ShowReportFooter><ShowPageFooter>EveryPage</ShowPageFooter><BodyFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</BodyFontStream></RptBody>\x01<VPText><Text>@@DATE@@</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>18</Height></Size><Left>99</Left><Top>35</Top><LineSpacing>0</LineSpacing></VPText>\x11<VPText><Text>@@AccountName@@</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>700</Width><Height>18</Height></Size><Left>100</Left><Top>75</Top><LineSpacing>0</LineSpacing></VPText>\x11<VPText><Text>##Account Name :##</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>97</Width><Height>18</Height></Size><Left>2</Left><Top>75</Top><LineSpacing>0</LineSpacing></VPText>\x12<VPVar><_DataSource>ReservedWords</_DataSource><_SysColumn>ReportTitle</_SysColumn><ROff>0</ROff><Decimals>2</Decimals><DateFormat>dd MMM yyyy</DateFormat><Commas>Million</Commas><InWords>false</InWords><UseOnce>false</UseOnce><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAQEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><SupressZero>false</SupressZero><SupressFractionZero>false</SupressFractionZero><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>25</Height></Size><Left>2</Left><Top>45</Top><LineSpacing>0</LineSpacing><DataSource>ReservedWords</DataSource><SysColumn>ReportTitle</SysColumn><UniqueID>C1</UniqueID></VPVar>\x11<VPVar><_DataSource>ReservedWords</_DataSource><_SysColumn>CompanyName</_SysColumn><ROff>0</ROff><Decimals>2</Decimals><DateFormat>dd MMM yyyy</DateFormat><Commas>Million</Commas><InWords>false</InWords><UseOnce>false</UseOnce><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAA9UaW1lcyBOZXcgUm9tYW4AAIBBBfz///8YU3lzdGVtLkRyYXdpbmcuRm9udFN0eWxlAQAAAAd2YWx1ZV9fAAgCAAAAAQAAAAX7////G1N5c3RlbS5EcmF3aW5nLkdyYXBoaWNzVW5pdAEAAAAHdmFsdWVfXwAIAgAAAAMAAAAL</FontStream><Alignment>TopLeft</Alignment><SupressZero>false</SupressZero><SupressFractionZero>false</SupressFractionZero><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>30</Height></Size><Left>2</Left><Top>5</Top><LineSpacing>0</LineSpacing><DataSource>ReservedWords</DataSource><SysColumn>CompanyName</SysColumn><UniqueID>C2</UniqueID></VPVar>".split("\x01");u[1]=u[1].Replace("@@AccountName@@",t.J0.EncodeXML(this.Title).TrimStart("[").TrimEnd("]")),u[1]=u[1].Replace("##Account Name :##","Document Name :"),u[1]=u[1].Replace("@@DATE@@",""),C.ReportName=this.Title,C.ReportBody=u[0],C.ReportHeader=u[1].Replace("@@AccountName@@",t.J0.EncodeXML(this.Title).TrimStart("[").TrimEnd("]")),C.PageHeader=u[2],C.PageFooter=u[3],C.ReportFooter=u[4],a.push(C),i.Reportds={},i.Reportds.Tables=[],i.Reportds.Tables.push(a),i.IsExportFromOthers=!0,i.Export(),t.J0.IsEmpty(this.DisplayMessage)&&(this.DisplayMessage="Exported sucessfully")}}importWorker_DoWork(n,i){let r="",a=new P.bT,C=new Array,s=new Array,u=new Array;for(let o=0;o<this.DtImport.length;o++){const d=this.DtImport[o];if(""==t.J0.String(d[1])||"0"==t.J0.String(d[1]))continue;let e=this.EditGrid.Columns.find(l=>l.ID==d[1].toString());if(null!=e){if(null!=e&&"LISTBOX"==e.DataType&&!a.ContainsKey(e.CostCenterID)){for(let h=0;h<this.ExcelTable.length;h++)""!=r&&(r+=","),r+="'"+this.ExcelTable[h][d[0].toString()].toString().Trim().Replace("'","''")+"'";let l=this.GetCCValues(r,e.CostCenterID,this.ImportIsCode?1:0,"CreditAccount_Key"==e.ValueMember||"DebitAccount_Key"==e.ValueMember?" and IsGroup=0 ":"");a.push(e.CostCenterID,l)}e.ReadOnly?C.push(d[0].toString()):(s.push(d[0].toString()),u.push(d[1].toString()))}}if(C.length>0){let o=this.ExcelTable.ToTable(!0,C);if(null!=o&&o.length>0){let D,d="",e="",l="",h="";for(let g=0;g<o.length;g++){e="",l="";for(let c=0;c<o.Columns.length;c++)e.length>0&&(e+=" AND "),e+=" ["+o.Columns[c].toString()+"]='"+o.Rows[g][c].toString()+"' ",l.length>0&&(l+=" AND "),d=this.DtImport.filter(S=>S.FieldName==o.Columns[c].toString())[0].FeatureFieldName.toString(),l+=" "+d+"='"+o[g][c].toString()+"' ";if(e.Trim().length>0){let c=[],S=[];if(null!=S&&S.length>0)for(let A=0;A<S.length;A++)for(let b=0;b<u.length;b++){var m=this.EditGrid.Columns.find(y=>y.ID==u[b]);null!=m&&(null!=m.DataType&&m.CostCenterID>0&&"LISTBOX"==m.DataType?(h="",h=this.ImportIsCode?"Code='"+c[0][s[b]]+"'":"Name='"+c[0][s[b]]+"'",D=a[m.CostCenterID].Select(h),null!=D&&D.length>0&&(S[A][m.DisplayMember+"_Key"]=D[0].ID,S[A][m.DisplayMember]=c[0][s[b]])):null!=m.DataType&&"COMBOBOX"==m.DataType.toUpperCase()?S[A][m.ValueBinding]=c[0][s[b]]:(null!=m.DataType&&"DATE"==m.DataType.toUpperCase()&&!t.J0.StringIsNullOrEmpty(c[0][s[b]].toString())&&(S[A][m.DisplayMember+"_Key"]=c[0][s[b]]),S[A][m.DisplayMember]=c[0][s[b]])),this.EditGrid.updateRow(S)}}}this.EditGrid.RefreshGrid=!0,this.DisplayMessage="Imported successfully.",this.MessageVisibility=!0}}else this.DisplayMessage="No column selected as readonly",this.MessageVisibility=!0}GetCCValues(n,i,r,a=""){Logger.InfoLog("Voucher Generator:: Inside GetCCValues");let C=[],s="";1==r?3==i?s="ProductCode":2==i?s="AccountCode":i>5e4&&(s="Code"):2==r?3==i?s="ProductID":2==i?s="AccountID":i>5e4&&(s="NodeID"):3==i?s="ProductName":2==i?s="AccountName":i>5e4&&(s="Name"),3==i?C.push("Select ProductID ID,ProductCode Code,ProductName name from inv_product WITH(NOLOCK) where "+s+" in("+n+")"):2==i?C.push("Select AccountID ID,AccountCode Code,AccountName name from Acc_Accounts WITH(NOLOCK) where "+s+" in("+n+")"+a):11==i?C.push("Select uomid ID,UNITNAME Code,UNITNAME name,ProductID from COM_UOM WITH(NOLOCK) where UNITNAME in("+n+")"):50051==i?C.push("Select NodeID ID,Code,name from "+this.GetTableName(i)+" WITH(NOLOCK) where (Code in("+n+") or Name in ("+n+"))"):i>5e4&&C.push("Select NodeID ID,Code,name from "+this.GetTableName(i)+" WITH(NOLOCK) where "+s+" in("+n+")"),C.push(I.d.SessionManager.UserID),C.push(I.d.SessionManager.LanguageID);let u=I.d.document.GetCCValues(n,i,r,a);return Logger.InfoLog("Voucher Generator: DBH.GetCCValues "),null!=u&&u.Tables.length>0?u.Tables[0]:null}GetTableName(n){return 2==n?"ACC_Accounts":3==n?"INV_Product":50001==n?"COM_Division":50002==n?"COM_Location":50003==n?"COM_Branch":50004==n?"COM_Department":50005==n?"COM_Salesman":50006==n?"COM_Category":50007==n?"COM_Area":50008==n?"COM_Teritory":"COM_CC"+n}RefreshData(){if(this.DisplayMessage="",2==this.CostCenterID?(this.PrimaryKey="AccountID",this.PrimaryColumns="D.AccountID,D.AccountCode,D.AccountName,D.AccountTypeID,D.IsGroup,D.StatusID,D.GUID"):3==this.CostCenterID?(this.PrimaryKey="ProductID",this.PrimaryColumns="D.ProductID,D.ProductCode,D.ProductName,D.ProductTypeID,D.GUID"):16==this.CostCenterID?(this.PrimaryKey="BatchID",this.PrimaryColumns="D.BatchID,D.BatchCode,D.BatchNumber, CONVERT(DATETIME,D.MfgDate) MfgDate, D.ProductID,CONVERT(DATETIME, D.ExpiryDate) ExpiryDate, D.MRPRate, D.RetailRate, D.StockistRate,CONVERT(DATETIME, D.RetestDate) RetestDate, D.GUID"):this.CostCenterID>5e4?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.NodeID,D.Code,D.Name,D.StatusID,D.GUID"):92==this.CostCenterID?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.*"):93==this.CostCenterID?(this.PrimaryKey="UnitID",this.PrimaryColumns="D.*"):94==this.CostCenterID?(this.PrimaryKey="TenantID",this.PrimaryColumns="D.*"):95==this.CostCenterID||104==this.CostCenterID?(this.PrimaryKey="ContractID",this.PrimaryColumns="D.ContractID,D.SNO,D.ContractNumber,D.StatusID,D.GUID"):103==this.CostCenterID||129==this.CostCenterID?(this.PrimaryKey="QuotationID",this.PrimaryColumns="D.QuotationID,D.SNO,D.Number,D.StatusID,D.GUID"):(this.PrimaryKey=0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",this.PrimaryColumns=this.IsDetailVoucher?0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"D.AccDocDetailsID,D.VoucherNo":"D.InvDocDetailsID,D.VoucherNo":"D.VoucherNo"),this.Report.length>0)return this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,void this.LoadDataFromReport();let a,C,s,u,n="",i="",m=0,d="";this.Entities.Clear(),this.Entities.push(this.MainTableName,"D"),n+=this.PrimaryColumns,i+=this.MainTableName+" D with(nolock)",this.SelectedFields.forEach(h=>{if(s="T"+m,C=t.J0.String(h.SysTableName),a=t.J0.String(h.SysColumnName),2==this.CostCenterID||3==this.CostCenterID||16==this.CostCenterID||92==this.CostCenterID||93==this.CostCenterID||94==this.CostCenterID||95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID||this.CostCenterID>=50001)if(C=C.toUpperCase(),0==t.J0.stringCompare(C,"ACC_ACCOUNTSEXTENDED")||0==t.J0.stringCompare(C,"INV_PRODUCTEXTENDED")||0==t.J0.stringCompare(C,"REN_PROPERTYEXTENDED")||0==t.J0.stringCompare(C,"REN_UNITSEXTENDED")||0==t.J0.stringCompare(C,"REN_TENANTEXTENDED")||0==t.J0.stringCompare(C,"REN_CONTRACTEXTENDED")||0==t.J0.stringCompare(C,"REN_QUOTATIONEXTENDED"))if(this.Entities.ContainsKey(C)||(this.Entities.push(C,"EXT"),i+=95==this.CostCenterID||104==this.CostCenterID?" INNER JOIN "+C+" EXT with(nolock) ON EXT.NODEID=D."+this.PrimaryKey:" INNER JOIN "+C+" EXT with(nolock) ON EXT."+this.PrimaryKey+"=D."+this.PrimaryKey),a="EXT."+a,"DATE"==t.J0.String(h.ColumnDataType))a="convert(datetime,"+a+")",n+=",'' AS C"+m,n+=","+a+" AS C"+m+"_Key";else if("LISTBOX"==t.J0.String(h.UserColumnType)){let D;if("44"==t.J0.String(h.ColumnCostCenterID))D=",case when "+a+" is not null and isnumeric("+a+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+a+") else '' end";else{let g=I.d.report.GetTableColumns(parseInt(h.ColumnCostCenterID));D=g.ColumnName,u=g.PrimaryKey,C=g.TableName,D=",case when "+a+" is not null and isnumeric("+a+")=1 then (SELECT "+D+" FROM "+C+" with(nolock) WHERE "+u+"="+a+") else '' end"}n+=D+" AS C"+m,n+=",case when isnumeric("+a+")=1 then "+a+" else convert(bigint,-1) end AS C"+m+"_Key"}else n+=","+a+" AS C"+m;else 0==t.J0.stringCompare(C,"COM_CCCCDATA")?(this.Entities.ContainsKey("COM_CCCCDATA")||(this.Entities.push("COM_CCCCDATA","CCDATA"),i+=" INNER JOIN COM_CCCCData CCDATA with(nolock) ON CCDATA.NodeID=D."+this.PrimaryKey+" AND CCDATA.CostCenterID="+this.CostCenterID),this.Entities.ContainsKey(a)||(this.Entities.push(a,s),i+=" INNER JOIN "+t.J0.GetTagTableName(parseInt(h.ParentCostCenterID))+" "+s+" with(nolock) ON "+s+".NodeID=CCDATA."+a),n+=","+this.Entities[a]+".Name AS C"+m,n+=",CCDATA."+a+" AS C"+m+"_Key"):0==t.J0.stringCompare(C,"COM_ADDRESS")?(this.Entities.ContainsKey("COM_ADDRESS")||(this.Entities.push("COM_ADDRESS","CCADD"),n+=",CCADD.AddressID",i+=" INNER JOIN COM_ADDRESS CCADD with(nolock) ON CCADD.AddressTypeID=1 and CCADD.FeaturePK=D."+this.PrimaryKey+" AND CCADD.FeatureID="+this.CostCenterID),n+=",CCADD."+a+" C"+m):null!=h.IsForeignKey&&(0,R.yG0)(h.IsForeignKey)?(this.Entities.ContainsKey(a)||(this.Entities.push(a,s),i+=" INNER JOIN "+t.J0.String(h.ParentCostCenterSysName)+" "+this.Entities[a]+" with(nolock) ON "+this.Entities[a]+"."+t.J0.String(h.ParentCostCenterColSysName)+"=D."+a),n+=","+this.Entities[a]+"."+this.GetColumnName(h)+" AS C"+m,n+=",D."+a+" AS C"+m+"_Key"):"Attachments"==a?(n+=",stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+this.CostCenterID+" AND FeaturePK=D."+this.PrimaryKey+" FOR XML PATH('')),1,1,'') AS C"+m+"_ID",n+=",stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+this.CostCenterID+" AND FeaturePK=D."+this.PrimaryKey+" FOR XML PATH('')),1,2,'') AS C"+m):"RentAmount"==a&&95==this.CostCenterID?n+=",FORMAT(isnull((select sum(RentAmount) from REN_ContractParticulars WITH(NOLOCK) where contractid=D.ContractID  and CCNodeID=3 ),0),'N0') AS C"+m:(a="D."+a,"DATE"==t.J0.String(h.ColumnDataType)?(a="convert(datetime,"+a+")",n+=",'' AS C"+m,n+=","+a+" AS C"+m+"_Key"):(("D.IsBillwise"==a||"D.Status"==a)&&(a="convert(int,"+a+")"),n+=","+a+" AS C"+m));else if(this.CostCenterID>4e4)if(0==t.J0.stringCompare(C,"COM_DocTextData"))if(this.Entities.ContainsKey("COM_DocTextData")||(this.Entities.push("COM_DocTextData","TXT"),i+=" INNER JOIN COM_DocTextData TXT with(nolock) ON TXT."+this.PrimaryKey+"=D."+this.PrimaryKey),d="TXT."+a,a=this.GetMaxColumn("TXT."+a,t.J0.String(h.ColumnDataType)),"DATE"==t.J0.String(h.ColumnDataType))n+=",'' AS C"+m,n+=",case when isdate("+a+")=1 then convert(datetime,"+a+") else null end AS C"+m+"_Key";else if("LISTBOX"==t.J0.String(h.UserColumnType)){let D;if("44"==t.J0.String(h.ColumnCostCenterID))D=",case when "+a+" is not null and isnumeric("+a+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+a+") else '' end";else{let g=I.d.report.GetTableColumns(parseInt(h.ColumnCostCenterID));D=g.ColumnName,u=g.PrimaryKey,C=g.TableName,D=",case when "+a+" is not null and isnumeric("+a+")=1 then (SELECT "+D+" FROM "+C+" with(nolock) WHERE "+u+"="+a+") else '' end"}n+=D+" AS C"+m,n+=",case when isnumeric("+a+")=1 then "+a+" else convert(bigint,-1) end AS C"+m+"_Key"}else"LOOKUP"==t.J0.String(h.UserColumnType)?(n+=","+a+" AS C"+m,n+=","+a+" AS C"+m+"_Key"):"FLOAT"==t.J0.String(h.ColumnDataType)?n+=",case when isnumeric("+a+")=1 then convert(float,"+a+") else null end AS C"+m:n+=","+a+" AS C"+m;else 0==t.J0.stringCompare(C,"COM_DocNumData")?(this.Entities.ContainsKey("COM_DocNumData")||(this.Entities.push("COM_DocNumData","NUM"),i+=" INNER JOIN COM_DocNumData NUM with(nolock) ON NUM."+this.PrimaryKey+"=D."+this.PrimaryKey),a=this.GetMaxColumn("NUM."+a,t.J0.String(h.ColumnDataType)),n+=","+a+" AS C"+m):0==t.J0.stringCompare(C,"COM_DocCCData")?(this.Entities.ContainsKey("COM_DocCCData")||(this.Entities.push("COM_DocCCData","DCC"),u=0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",i+=" INNER JOIN COM_DocCCData DCC with(nolock) ON DCC."+u+"=D."+u),this.Entities.ContainsKey(a)||(this.Entities.push(a,s),i+=" INNER JOIN "+t.J0.GetTagTableName(parseInt(h.ParentCostCenterID))+" "+s+" with(nolock) ON "+s+".NodeID=DCC."+a),"YES"==t.J0.String(h.ShowCode)?n+=","+this.GetMaxColumn(this.Entities[a]+".Code","")+" AS C"+m:n+=","+this.GetMaxColumn(this.Entities[a]+".Name","")+" AS C"+m,n+=","+this.GetMaxColumn("convert(bigint,DCC."+a,"")+") AS C"+m+"_Key"):null!=h.IsForeignKey&&(0,R.yG0)(h.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(a)?(this.Entities.ContainsKey(a)||(this.Entities.push(a,s),i+=" INNER JOIN "+t.J0.String(h.ParentCostCenterSysName)+" "+this.Entities[a]+" with(nolock) ON "+this.Entities[a]+"."+t.J0.String(h.ParentCostCenterColSysName)+"=D."+a,!t.J0.IsEmpty(h.ParentCostCenterSysName)&&"inv_product"==t.J0.String(h.ParentCostCenterSysName).toLowerCase()&&(this.IsProductExists=!0)),n+=","+this.GetMaxColumn(this.Entities[a]+"."+this.GetColumnName(h),"")+" AS C"+m,n+=","+this.GetMaxColumn("D."+a,"")+" AS C"+m+"_Key"):("DebitAmount"==a||"CreditAmount"==a?a=this.GetMaxColumn("case when D."+a.Replace("Amount","Account")+">0 then D.Amount else 0 end",t.J0.String(h.ColumnDataType)):t.J0.IsEmpty(h.ColumnDataType)||"listbox"!=h.ColumnDataType.toString().toLowerCase()||"Unit"!=a?a=this.GetMaxColumn("D."+a,t.J0.String(h.ColumnDataType)):(i+=" INNER JOIN  COM_UOM UM with(nolock) ON UM.UOMID=D."+a,a=this.GetMaxColumn("D."+a,h.ColumnDataType.toString()),a=a.Replace("D.Unit","UM.UnitName")),"DATE"==t.J0.String(h.ColumnDataType)?(a="convert(datetime,"+a+")",n+=",'' AS C"+m,n+=","+a+" AS C"+m+"_Key"):n+=","+a+" AS C"+m);m++}),(3==this.CostCenterID||this.IsProductExists)&&!this.HideProductImage&&(this.ImportVisiblity||(this.ProductImageVisibility=!0),this.ReplaceVisibility=!1,this.ApproveVisibility=!1,n+=this.IsDetailVoucher||3==this.CostCenterID?",f.GUID FileGUID, f.FileExtension FileExtension":",max(f.GUID) FileGUID, max(f.FileExtension) FileExtension",i+=" left join com_files f with(nolock) on F.featureid=3 and featurepk=d.productid  and f.isProductImage=1 and f.isDEfaultImage=1 "),this.IsDocument&&this.CostCenterID>4e4&&this.CostCenterID<5e4&&(n+=",DID.GUID GUID",i+=" Left Join Com_DOCID DID with(nolock) on DID.ID = D.DocID"),this.IsDocument&&this.IsLWApproval&&(n+=",D.WorkflowID"),n="SELECT "+n,n+=" FROM "+i.toString(),n+=" ^",this.CostCenterID>4e4&&this.CostCenterID<5e4&&(n+=" AND D.CostCenterID="+this.CostCenterID,this.FromDate.Visible&&(n+=" AND D.DocDate>=convert(float,convert(datetime,'"+this.FromDate.Date.ToString("dd MMM yyyy")+"'))",n+=" AND D.DocDate<=convert(float,convert(datetime,'"+this.ToDate.Date.ToString("dd MMM yyyy")+"'))"));let e=this.StaticFilter.GetWhere(i,100).Trim();e.length>0&&(n+=" AND ("+e+")");let l=this.Filter.GetWhere(i,500).Trim();l.length>0&&(n+=" AND ("+l+")"),2==this.CostCenterID?n+=" ORDER BY D.AccountName":3==this.CostCenterID?n+=" ORDER BY D.ProductName":16==this.CostCenterID?n+=" ORDER BY D.BatchNumber":92==this.CostCenterID||93==this.CostCenterID?n+=" ORDER BY D.Name":94==this.CostCenterID?n+=" ORDER BY D.FirstName":this.CostCenterID>=50001?n+=" ORDER BY D.Name":this.CostCenterID>4e4&&(this.IsDetailVoucher?n+=" ORDER BY D.DocDate,D.VoucherNo,D.DocSeqNo":(n+=" GROUP BY D.DocDate,D.VoucherNo,DID.GUID",n+=" ORDER BY D.DocDate,D.VoucherNo"));try{this.EditGrid.Clear(),n.length>0&&(this.strWhereforAuctionHistory=" WHERE 1=1 "+n.split("^")[1],this.strWhereforAuctionHistory=this.strWhereforAuctionHistory.Replace("'",""),this.strWhereforAuctionHistory=this.strWhereforAuctionHistory.Replace("%","~")),n=n.Replace("^"," WHERE 1=1"),n=n.Replace("%","~");let D,g,h=I.d.common.GetDataSetQuery(n.toString());h.Columns[0].push("Select"),h.Columns[0].push("Message"),h.Tables[0].forEach(c=>{c.Select=!1,this.DateColIDs.forEach(S=>{D=S+"_Key",!t.J0.IsEmpty(c[D])&&c[D].toString().length>0&&(g=t.J0.ParseDate(c[D]),c[S]=g.ToString(I.d.SessionManager.Preferences["Date Format"]))})});for(let c=0;c<h.Tables[0].length;c++)h.Tables[0][c].id=c+1;this.EditGrid.Table.AddRange(h.Tables[0]),h.Columns&&h.Columns.length>0&&(this.EditGrid.TableColumns=h.Columns[0]),this.EditGrid.refreshDataView()}catch(h){this.DisplayMessage="Error in loading data",Logger.ErrorLog("Bulk Edit-RefreshData:",h.Message)}}ShowEditGrid(){this.ReportFilterVisible=!1,this.EditGrid.Visible=!0}LoadDataFromReport(){if(this.cprimary=null,this.EditGrid.Clear(),this.IsDocument){if(this.EditGrid.TableColumns.Contains("Message")||(this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.EditGrid.TableColumns.Contains("GUID")||this.EditGrid.TableColumns.push("GUID"),this.IsDetailVoucher?(this.cprimary=this.Report[0].BaseReportColumns.find(o=>"2"==o.LinkType.SelectedValue),this.EditGrid.TableColumns.Contains("ReportPK")||this.EditGrid.TableColumns.push("ReportPK"),this.IsLWApproval&&!this.EditGrid.TableColumns.Contains("WorkFlowID")&&this.EditGrid.TableColumns.push("WorkFlowID")):this.cprimary=this.Report[0].BaseReportColumns.find(o=>"1"==o.LinkType.SelectedValue||"2"==o.LinkType.SelectedValue),null==this.cprimary||null==this.cprimary)return void(this.DisplayMessage="Please set voucher no column link type as "+(this.IsDetailVoucher?"'Document Detail'":"'Document'"));var i=this.EditGrid.Columns.find(o=>o.OPParams==this.cprimary.ID);if(null==i&&null==i)return void(this.DisplayMessage="Please select voucher no column");this.strVoucherNo=i.SectionName}else if(this.EditGrid.TableColumns.Contains("ReportPK")||(this.EditGrid.TableColumns.push("ReportPK"),this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.cprimary=this.Report[0].BaseReportColumns.find(o=>(o.CDGDO.CategoryValue==this.CostCenterID||o.CDGDO.ColumnCostCenterID==this.CostCenterID||null!=o.CDGDO.ChildCDGDO&&o.CDGDO.ChildCDGDO.CategoryValue==this.CostCenterID)&&("3"==o.LinkType.SelectedValue||"4"==o.LinkType.SelectedValue)),null==this.cprimary)return void(this.DisplayMessage="Please set dimension column link type");let r,a,C=new P.bT,s=new P.bT;for(let o=0;o<this.EditGrid.Columns.length;o++){const d=this.EditGrid.Columns[o];if(null==d.OPParams)continue;let e=this.Report[0].BaseReportColumns.find(l=>l.ID==d.OPParams);null!=e&&s.push(d.OPParams,e)}for(let o=0;o<this.Report[0].Data.length;o++){const d=this.Report[0].Data[o];if(d.Type==O.QS.Detail){a=this.EditGrid.NewRow(),a.Select=!1,null!=d.DataRow&&null!=d.DataRow[this.cprimary.ID+"_ID"]&&t.J0.String(d.DataRow[this.cprimary.ID+"_ID"]).length>0&&null!=a.ReportPK&&(a.ReportPK=d.DataRow[this.cprimary.ID+"_ID"]),this.IsLWApproval&&(a.WorkFlowID=d.DataRow.WorkFlowID),null!=d.DataRow&&this.EditGrid.TableColumns.Contains("GUID")&&null!=d.DataRow&&null!=d.DataRow.GUID&&(a.GUID=d.DataRow.GUID),null!=this.Report[0].LevelColumn&&d.IsGroup&&(a.Row_Foreground=null);for(let e=0;e<this.EditGrid.Columns.length;e++){const l=this.EditGrid.Columns[e];if(null!=l.OPParams)if("LISTBOX"==l.DataType){if(null!=d.DataRow&&null!=d.DataRow[l.OPParams])if(a[l.DisplayMember]=d.DataRow[l.OPParams],null!=d.DataRow[l.OPParams+"_ID"])a[l.DisplayMember+"_Key"]=d.DataRow[l.OPParams+"_ID"];else if(C.ContainsKey(l.OPParams)||C.push(l.OPParams,new P.bT),C[l.OPParams].ContainsKey(t.J0.String(d.DataRow[l.OPParams])))a[l.DisplayMember+"_Key"]=C[l.OPParams][t.J0.String(d.DataRow[l.OPParams])];else if(this.dvFields=this.dvFieldsNew.filter(h=>h.CostCenterColID==l.CrRefID),this.dvFields.length>0){let D=I.d.common.GetDataSet3("BULK001",t.J0.String(this.dvFields[0].ParentCostCenterColSysName),t.J0.String(this.dvFields[0].ParentCostCenterSysName),t.J0.String(d.DataRow[l.OPParams])).Tables[0];D.length>0&&!t.J0.IsEmpty(D[0].ID)&&(C[l.OPParams].push(t.J0.String(d.DataRow[l.OPParams]),parseInt(D[0].ID)),a[l.DisplayMember+"_Key"]=C[l.OPParams][t.J0.String(d.DataRow[l.OPParams])])}}else if("DATE"==l.DataType)null!=d.DataRow&&null!=d.DataRow[l.OPParams]&&!t.J0.IsEmpty(d.DataRow[l.OPParams])&&t.J0.String(d.DataRow[l.OPParams]).length>0&&(r=t.J0.ParseDate(d.DataRow[l.OPParams]),a[l.DisplayMember]=r.ToString(I.d.SessionManager.Preferences["Date Format"]),a[l.DisplayMember+"_Key"]=r);else if("TIME"==l.DataType)null!=d.DataRow&&null!=d.DataRow[l.OPParams]&&!t.J0.IsEmpty(d.DataRow[l.OPParams])&&t.J0.String(d.DataRow[l.OPParams]).length>0&&(r=t.J0.ParseDate(d.DataRow[l.OPParams]),a[l.DisplayMember]=r.ToString("hh:mm:ss tt"),a[l.DisplayMember+"_Key"]=r);else if("ComboBox"==l.DataType){if(null!=d.DataRow&&null!=d.DataRow[l.OPParams])if("StatusID"==l.ID&&null!=l.ComboDataTable){let h=l.ComboDataTable.filter(D=>D[l.DisplayMember]==d.DataRow[l.OPParams]);h[l.ValueBinding]=h.length>0?h[0][l.ValueMember]:d.DataRow[l.OPParams]}else a[l.ValueBinding]=d.DataRow[l.OPParams]}else null!=d.DataRow&&null!=d.DataRow[l.OPParams]&&(a[l.DisplayMember]=d.DataRow[l.OPParams],this.EditGrid.TableColumns.Contains(l.DisplayMember+"_ID")&&Object.keys(d.DataRow).Contains(l.OPParams+"_ID")?a[l.DisplayMember+"_ID"]=d.DataRow[l.OPParams+"_ID"]:"MULTI_LINK"==l.DataType&&this.EditGrid.TableColumns.Contains(l.DisplayMember+"_ID")&&(a[l.DisplayMember+"_ID"]=d.DataRow[l.OPParams]))}this.EditGrid.addRow(a)}}}GetColumnName(n){let i,r;return i="parentid"==t.J0.String(n.SysColumnName).toLowerCase()?this.CostCenterID:parseInt(n.ColumnCostCenterID),r=t.J0.IntTryParse(t.J0.String(n.ParentCCDefaultColID)),2==i?238==r?"AccountCode":"AccountName":3==i?261==r?"ProductCode":"ProductName":93==i?25624==r?"Code":"Name":94==i?25697==r?"FirstName":"LastName":16==i?"BatchNumber":"Name"}GetMaxColumn(n,i){return this.IsDetailVoucher||(n="FLOAT"!=i||n.Contains("dcAlpha")||n.Contains("ExchangeRate")?"max("+n+")":"sum("+n+")"),n}SaveDocument(n){this.setActionHistroy("Save Document");let i,u,m,r="",a="",C="",s=0;m=0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",u=null!=this.ReportObj?"ReportPK":m;let o=t.J0.NewGuid();n.forEach(d=>{if(s++,C="",a="",r="",this.EditColumns.forEach(e=>{"LISTBOX"==e.DataType&&0!=e.CostCenterID&&e.ID.toLowerCase().startsWith("dcccnid")?a+=e.ID+"="+t.J0.String(d[e.ValueMember])+",":e.IsColumnUserDefined?"SELECTIONBOX"==e.DataType?r+=e.ID+"=N'"+t.J0.String(d[e.DisplayMember]).Replace("'","''")+"',":e.DisplayMember.toLowerCase().Contains("dcnum")||("DATE"==e.DataType?t.J0.IsEmpty(d[e.DisplayMember+"_Key"])||(r+=e.ID+"='"+t.J0.ParseDate(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',"):"DATETIME"==e.DataType||"TIME"==e.DataType?t.J0.IsEmpty(d[e.DisplayMember+"_Key"])||(r+=e.ID+"='"+t.J0.ParseDate(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',"):r+="ComboBox"==e.DataType?e.ID+"=N'"+t.J0.String(d[e.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==e.DataType?e.ID+"=N'"+t.J0.String(d[e.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==e.DataType&&0!=e.CostCenterID?e.ID+"='"+t.J0.String(d[e.ValueMember]).Replace("'","''")+"',":e.ID+"=N'"+t.J0.String(d[e.DisplayMember]).Replace("'","''")+"',"):this.docAllowCols.Contains(e.ID.toLowerCase())&&("DATE"==e.DataType?t.J0.IsEmpty(d[e.DisplayMember+"_Key"])||(C+=e.ID+"=CONVERT(INT,CONVERT(DATETIME,'"+t.J0.ParseDate(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"')),"):C+=e.ID+"=N'"+t.J0.String(d[e.DisplayMember]).Replace("'","''")+"',")}),r.length>0||a.length>0||C.length>0){r.length>0&&(r=r.substr(0,r.length-1),r=r.Insert(0,"UPDATE TXT SET "),r+=" FROM "+this.MainTableName+" D WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK) ON D."+m+"=TXT."+m,this.IsDetailVoucher?(r+=" WHERE ",0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?r+="D.AccDocDetailsID="+t.J0.String(d[u]):r+="D.InvDocDetailsID="+t.J0.String(d[u])):r+=" WHERE D.VoucherNo='"+t.J0.String(d[this.strVoucherNo])+"'"),a.length>0&&(a=a.substr(0,a.length-1),a=a.Insert(0,"   UPDATE TXT SET "),a+=" FROM "+this.MainTableName+" D WITH(NOLOCK) INNER JOIN COM_DocCCData TXT WITH(NOLOCK) ON D."+m+"=TXT."+m,this.IsDetailVoucher?(a+=" WHERE ",0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?a+="D.AccDocDetailsID="+t.J0.String(d[u]):a+="D.InvDocDetailsID="+t.J0.String(d[u])):a+=" WHERE D.VoucherNo='"+t.J0.String(d[this.strVoucherNo])+"'"),r+=a.toString(),C.length>0&&(C=C.substr(0,C.length-1),C=C.Insert(0,"   UPDATE "+this.MainTableName+" SET "),this.IsDetailVoucher?(C+=" WHERE ",0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?C+="AccDocDetailsID="+t.J0.String(d[u]):C+="InvDocDetailsID="+t.J0.String(d[u])):C+=" WHERE VoucherNo='"+t.J0.String(d[this.strVoucherNo])+"'"),r+=C.toString();try{let l,e=null;l=s==n.length||t.J0.String(d[this.strVoucherNo])!=t.J0.String(n[s][this.strVoucherNo])?I.d.common.BulkEditDetals_7(7,this.ID,this.CostCenterID,o,r.toString(),t.J0.String(d[this.strVoucherNo]),""):I.d.common.BulkEditDetals_7(7,this.ID,this.CostCenterID,o,r.toString(),"",""),e=l,i=t.J0.Int(l.obj),d.Message=i>0?"Success":e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("ServerMessage")?"Failure : "+t.J0.String(e.Tables[0][0].ServerMessage):e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("ErrorMessage")?"Failure : "+t.J0.String(e.Tables[0][0].ErrorMessage):"Failure",this.EditGrid.updateRow(d)}catch(e){Logger.ErrorLog("BulkEdit-SAVE: ",e.Message)}}else d.Message="NO DATA",this.EditGrid.updateRow(d)})}SaveDimension(n){var i=this;return(0,w.A)(function*(){i.setActionHistroy("Save Dimension");let r,a="",C="",s="",u="",m="";for(let d=0;d<n.length;d++){const e=n[d];if(C="",s="",u="",m="",i.EditColumns.forEach(l=>{"SELECTIONBOX"==l.DataType?l.ID.toLowerCase().Contains("alpha")?s+=l.ID+"='"+t.J0.String(e[l.DisplayMember]).Replace("'","''")+"',":C+=l.ID+"='"+t.J0.String(e[l.DisplayMember]).Replace("'","''")+"',":"DATE"==l.DataType?t.J0.IsEmpty(e[l.DisplayMember+"_Key"])||(l.ID.toLowerCase().Contains("alpha")?s+=l.ID+"='"+t.J0.ParseDate(e[l.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',":16==i.CostCenterID&&(l.ID.Contains("MfgDate")||l.ID.Contains("ExpiryDate")||l.ID.Contains("RetestDate"))||(C+=l.ID+"='"+t.J0.ParseDate(e[l.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"DATETIME"==l.DataType||"TIME"==l.DataType?t.J0.IsEmpty(e[l.DisplayMember+"_Key"])||(l.ID.toLowerCase().Contains("alpha")?s+=l.ID+"='"+t.J0.ParseDate(e[l.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',":16==i.CostCenterID&&(l.ID.Contains("MfgDate")||l.ID.Contains("ExpiryDate")||l.ID.Contains("RetestDate"))||(C+=l.ID+"='"+t.J0.ParseDate(e[l.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"ComboBox"==l.DataType?l.ID.toLowerCase().Contains("alpha")?s+=l.ID+"='"+t.J0.String(e[l.ValueBinding]).Replace("'","''")+"',":C+=l.ID+"='"+t.J0.String(e[l.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==l.DataType?l.ID.toLowerCase().Contains("alpha")?s+=l.ID+"='"+t.J0.String(e[l.ValueBinding+"_Key"]).Replace("'","''")+"',":C+=l.ID+"='"+t.J0.String(e[l.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==l.DataType&&0!=l.CostCenterID?l.ID.toLowerCase().Contains("alpha")?s+=l.ID+"='"+t.J0.String(e[l.ValueMember]).Replace("'","''")+"',":l.ID.toLowerCase().startsWith("ccnid")?u+=l.ID+"="+t.J0.String(e[l.ValueMember])+",":C+=l.ID+"="+t.J0.String(e[l.ValueMember])+",":i.AddressFields.Contains(l.SectionName)?m+=l.ID+"='"+t.J0.String(e[l.DisplayMember]).Replace("'","''")+"',":l.IsColumnUserDefined?s+=l.ID+"='"+t.J0.String(e[l.DisplayMember]).Replace("'","''")+"',":C+=l.ID+"='"+t.J0.String(e[l.DisplayMember]).Replace("'","''")+"',"}),C.length>0||s.length>0||u.length>0||m.length>0)try{if(r=0,null!=i.ReportObj){if(null==e.ReportPK)continue;let h=I.d.common.GetDataSet3("BULK002",i.PrimaryColumns,i.MainTableName,i.PrimaryKey+","+t.J0.String(e.ReportPK)).Tables[0];if(0==h.length)continue;h.Columns.forEach(D=>{i.EditGrid.TableColumns.Contains(D.ColumnName)||i.EditGrid.TableColumns.push(D.ColumnName),e[D.ColumnName]=h[0][D.ColumnName]})}if(2==i.CostCenterID){let l={};l.AccountID=parseInt(e.AccountID),l.GUID=t.J0.String(e.GUID);var o=i.EditColumns.find(h=>"AccountCode"==h.ID);l.AccountCode=t.J0.String(null!=o?e[o.DisplayMember]:e.AccountCode),l.CodePrefix=l.AccountCode,o=i.EditColumns.find(h=>"AccountName"==h.ID),l.AccountName=t.J0.String(null!=o?e[o.DisplayMember]:e.AccountName),o=i.EditColumns.find(h=>"StatusID"==h.ID),l.StatusID=null!=o&&t.J0.String(e[o.ValueBinding]).length>0?parseInt(e[o.ValueBinding]):parseInt(e.StatusID),o=i.EditColumns.find(h=>"AccountTypeID"==h.ID),l.AccountTypeID=null!=o&&t.J0.String(e[o.ValueBinding]).length>0?parseInt(e[o.ValueBinding]):parseInt(e.AccountTypeID),l.IsGroup=(0,R.yG0)(e.IsGroup),l.StaticFieldsQuery=C.toString(),l.CustomFieldsQuery=s.toString(),l.CustomCostCenterFieldsQuery=u.toString(),m.length>0&&(m=m.substr(0,m.length-1),m=' <Data><Row Action="MODIFY" AddressID="'+t.J0.String(e.AddressID)+'" AddressTypeID="1"  StaticFields ="'+m,m+='"/></Data>'),l.AddressXML=m.toString(),l.CCMapXML=null,I.d.accounting.SaveAccount(l,"SaveAccountQuick").subscribe(h=>{if(a=h.Message,r=h.RetValue,r>0){e.Message="Success",i.EditGrid.updateRow(e);let g=I.d.common.BulkEditDetals_7(8,r,i.CostCenterID,"","","","").ds;null!=g&&g.Tables.length>0&&g.Tables[0].length>0&&g.Columns[0].Contains("GUID")&&(e.GUID=t.J0.String(g.Tables[0][0].GUID))}else e.Message="Failure : "+a,i.EditGrid.updateRow(e)},h=>{alert(JSON.stringify(h)),console.log("Bulk Edit Account Save : "+JSON.stringify(h))})}else if(3==i.CostCenterID){let l=new te.c;l.ProductID=parseInt(e.ProductID),l.GUID=t.J0.String(e.GUID);let h=i.EditColumns.find(g=>"ProductCode"==g.ID);l.ProductCode=t.J0.String(null!=h?e[h.DisplayMember]:e.ProductCode),l.CodePrefix=l.ProductCode,h=i.EditColumns.find(g=>"ProductName"==g.ID),l.ProductName=t.J0.String(null!=h?e[h.DisplayMember]:e.ProductName),h=i.EditColumns.find(g=>"ProductTypeID"==g.ID),l.ProductType=null!=h&&t.J0.String(e[h.ValueBinding]).length>0?parseInt(e[h.ValueBinding]):parseInt(e.ProductTypeID),l.CustomFieldsQuery=s.toString(),l.CustomCostCenterFieldsQuery=u.toString(),l.CCCCMapDATA=null;let D=l.SetProductQuick(C.toString());if(!t.J0.IsEmpty(D))if(a=D?.Message,r=D?.RetValue,r>0){e.Message="Success",i.EditGrid.updateRow(e);let c=I.d.common.BulkEditDetals_7(8,r,i.CostCenterID,"","","","").ds;null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&c.Columns[0].Contains("GUID")&&(e.GUID=t.J0.String(c.Tables[0][0].GUID))}else e.Message="Failure : "+a,i.EditGrid.updateRow(e)}else if(16==i.CostCenterID){let l={};l.BatchID=parseInt(e.BatchID),l.GUID=t.J0.String(e.GUID),o=i.EditColumns.find(c=>"BatchCode"==c.ID),l.BatchCode=t.J0.String(null!=o?e[o.DisplayMember]:e.BatchCode),l.CodePrefix=l.BatchCode,l.StaticFieldsQuery=C.toString(),l.CustomFieldsQuery=s.toString(),l.CustomCostCenterFieldsQuery=u.toString();let D=[];D.push(t.J0.String(e.BatchNumber)),o=i.EditColumns.find(c=>"MfgDate"==c.ID),D.push(null!=o?t.J0.ParseDate(t.J0.String(e[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):t.J0.IsEmpty(e.MfgDate)?"1/JAN/1900":t.J0.ParseDate(e.MfgDate.toString()).ToString("dd/MMM/yyyy")),o=i.EditColumns.find(c=>"ExpiryDate"==c.ID),D.push(null!=o?t.J0.ParseDate(t.J0.String(e[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):t.J0.IsEmpty(e.ExpiryDate)?"1/JAN/1900":t.J0.ParseDate(e.ExpiryDate.toString()).ToString("dd/MMM/yyyy")),o=i.EditColumns.find(c=>"MRPRate"==c.ID),D.push(null!=o?parseFloat(t.J0.String(e[o.DisplayMember])):parseFloat(t.J0.String(e.MRPRate))),o=i.EditColumns.find(c=>"RetailRate"==c.ID),D.push(null!=o?parseFloat(t.J0.String(e[o.DisplayMember])):parseFloat(t.J0.String(e.RetailRate))),o=i.EditColumns.find(c=>"StockistRate"==c.ID),D.push(null!=o?parseFloat(t.J0.String(e[o.DisplayMember])):parseFloat(t.J0.String(e.StockistRate))),D.push(t.J0.String(e.ProductID)),o=i.EditColumns.find(c=>"RetestDate"==c.ID),D.push(null!=o?t.J0.ParseDate(t.J0.String(e[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):t.J0.IsEmpty(e.RetestDate)?null:t.J0.ParseDate(e.RetestDate.toString()).ToString("dd/MMM/yyyy")),D.push(0),l.StaticFieldsQuery=C.toString(),l.CustomFieldsQuery=s.toString(),l.CustomCostCenterFieldsQuery=u.toString()}else if(92==i.CostCenterID){let l={};l.PropertyID=parseInt(e.NodeID),l.GUID=e.GUID.toString(),l.IsGroup=(0,R.yG0)(e.IsGroup);let h=i.EditColumns.find(D=>"Code"==D.ID);l.Code=null!=h?e[h.DisplayMember].toString():e.Code.toString(),h=i.EditColumns.find(D=>"Name"==D.ID),l.Name=null!=h?e[h.DisplayMember].toString():e.Name.toString(),h=i.EditColumns.find(D=>"Status"==D.ID),l.StatusID=null!=h&&e[h.ValueBinding].toString().length>0?parseInt(e[h.ValueBinding]):parseInt(e.Status),l.DetailsXML=C.toString(),l.CustomFieldsQuery=s.toString(),l.CustomCostCenterFieldsQuery=u.toString(),I.d.rental.SaveProperty(l,"SaveProperty").subscribe(D=>{i.DisplayMessage=D.Message,i.MessageVisibility=!0},D=>{console.log(" Property Save : "+JSON.stringify(D))})}else if(93==i.CostCenterID){let l={};l.UnitID=parseInt(e.UnitID),l.GUID=e.GUID.toString(),l.IsGroup=(0,R.yG0)(e.IsGroup),o=i.EditColumns.find(D=>"PropertyID"==D.ID),l.Property=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.PropertyID)&&e.PropertyID.toString().length>0?parseInt(e.PropertyID):0,o=i.EditColumns.find(D=>"Code"==D.ID),l.Code=null!=o?e[o.DisplayMember].toString():e.Code.toString(),o=i.EditColumns.find(D=>"Name"==D.ID),l.Name=null!=o?e[o.DisplayMember].toString():e.Name.toString(),o=i.EditColumns.find(D=>"Status"==D.ID),l.StatusID=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):parseInt(e.Status),o=i.EditColumns.find(D=>"NodeID"==D.ID),l.UnitType=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.NodeID)&&e.NodeID.toString().length>0?parseInt(e.NodeID):0,o=i.EditColumns.find(D=>"UnitType"==D.ID),l.TypeofUnit=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.UnitType)&&e.UnitType.toString().length>0?parseInt(e.UnitType):0,o=i.EditColumns.find(D=>"UnitStatus"==D.ID),l.UnitStatus=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.UnitStatus)&&e.UnitStatus.toString().length>0?parseInt(e.UnitStatus):0,o=i.EditColumns.find(D=>"RentableArea"==D.ID),l.RentalArea=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.RentableArea)&&e.RentableArea.toString().length>0?parseFloat(e.RentableArea):0,o=i.EditColumns.find(D=>"BuildUpArea"==D.ID),l.BuildUpArea=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.BuildUpArea)&&e.BuildUpArea.toString().length>0?parseFloat(e.BuildUpArea):0,o=i.EditColumns.find(D=>"FloorLookupID"==D.ID),l.Floor=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.FloorLookupID)&&e.FloorLookupID.toString().length>0?parseInt(e.FloorLookupID):0,o=i.EditColumns.find(D=>"ViewLookupID"==D.ID),l.View=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.ViewLookupID)&&e.ViewLookupID.toString().length>0?parseInt(e.ViewLookupID):0,o=i.EditColumns.find(D=>"NoOfBathrooms"==D.ID),l.NoOfBathrooms=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.NoOfBathrooms)&&e.NoOfBathrooms.toString().length>0?parseFloat(e.NoOfBathrooms):0,o=i.EditColumns.find(D=>"NoOfParkings"==D.ID),l.NoOfParkings=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.NoOfParkings)&&e.NoOfParkings.toString().length>0?parseFloat(e.NoOfParkings):0,o=i.EditColumns.find(D=>"ElectricityCode"==D.ID),l.ElectricityCode=null!=o?e[o.DisplayMember].toString():t.J0.IsEmpty(e.ElectricityCode)?"":e.ElectricityCode.toString(),o=i.EditColumns.find(D=>"ElectricityKW"==D.ID),l.Electricity=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.ElectricityKW)&&e.ElectricityKW.toString().length>0?parseFloat(e.ElectricityKW):0,o=i.EditColumns.find(D=>"Rent"==D.ID),l.Amount=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.Rent)&&e.Rent.toString().length>0?parseFloat(e.Rent):0,o=i.EditColumns.find(D=>"RentTypeID"==D.ID),l.AmountType=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentTypeID)&&e.RentTypeID.toString().length>0?parseInt(e.RentTypeID):0,o=i.EditColumns.find(D=>"DiscountAmount"==D.ID),l.Discount=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.DiscountAmount)&&e.DiscountAmount.toString().length>0?parseFloat(e.DiscountAmount):0,o=i.EditColumns.find(D=>"DiscountPercentage"==D.ID),l.DiscountPercentage=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.DiscountPercentage)&&e.DiscountPercentage.toString().length>0?parseFloat(e.DiscountPercentage):0,o=i.EditColumns.find(D=>"AnnualRent"==D.ID),l.AnnaulRent=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.AnnualRent)&&e.AnnualRent.toString().length>0?parseFloat(e.AnnualRent):0,o=i.EditColumns.find(D=>"MonthlyRent"==D.ID),l.MonthlyRent=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.MonthlyRent)&&e.MonthlyRent.toString().length>0?parseFloat(e.MonthlyRent):0,o=i.EditColumns.find(D=>"RentPerSQFT"==D.ID),l.RentperSqft=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.RentPerSQFT)&&e.RentPerSQFT.toString().length>0?parseFloat(e.RentPerSQFT):0,o=i.EditColumns.find(D=>"TermsConditions"==D.ID),l.TermsConditions=null!=o?e[o.DisplayMember].toString():t.J0.IsEmpty(e.TermsConditions)?"":e.TermsConditions.toString(),o=i.EditColumns.find(D=>"AccountantID"==D.ID),l.Accountant=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AccountantID)&&e.AccountantID.toString().length>0?parseInt(e.AccountantID):0,o=i.EditColumns.find(D=>"SalesmanID"==D.ID),l.Salesman=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.SalesmanID)&&e.SalesmanID.toString().length>0?parseInt(e.SalesmanID):0,o=i.EditColumns.find(D=>"LandlordID"==D.ID),l.Landlord=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.LandlordID)&&e.LandlordID.toString().length>0?parseInt(e.LandlordID):0,o=i.EditColumns.find(D=>"RentalIncomeAccountID"==D.ID),l.RentalIncomeAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentalIncomeAccountID)&&e.RentalIncomeAccountID.toString().length>0?parseInt(e.RentalIncomeAccountID):0,o=i.EditColumns.find(D=>"PenaltyAccountID"==D.ID),l.PenaltyAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.PenaltyAccountID)&&e.PenaltyAccountID.toString().length>0?parseInt(e.PenaltyAccountID):0,o=i.EditColumns.find(D=>"RentalReceivableAccountID"==D.ID),l.RentalReceivableAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentalReceivableAccountID)&&e.RentalReceivableAccountID.toString().length>0?parseInt(e.RentalReceivableAccountID):0,o=i.EditColumns.find(D=>"AdvanceRentAccountID"==D.ID),l.AdvanceRentAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AdvanceRentAccountID)&&e.AdvanceRentAccountID.toString().length>0?parseInt(e.AdvanceRentAccountID):0,o=i.EditColumns.find(D=>"ProvisionAccountID"==D.ID),l.ProvisionAccountID=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.ProvisionAccountID)&&e.ProvisionAccountID.toString().length>0?parseInt(e.ProvisionAccountID):0,o=i.EditColumns.find(D=>"BankAccount"==D.ID),l.BankAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.BankAccount)&&e.BankAccount.toString().length>0?parseInt(e.BankAccount):0,o=i.EditColumns.find(D=>"BankLoanAccount"==D.ID),l.BankLoanAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.BankLoanAccount)&&e.BankLoanAccount.toString().length>0?parseInt(e.BankLoanAccount):0,o=i.EditColumns.find(D=>"AdvanceReceivableAccountID"==D.ID),l.AdvanceReceivableAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AdvanceReceivableAccountID)&&e.AdvanceReceivableAccountID.toString().length>0?parseInt(e.AdvanceReceivableAccountID):0,o=i.EditColumns.find(D=>"AdvReceivableCloseAccID"==D.ID),l.AdvReceivableCloseAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AdvReceivableCloseAccID)&&e.AdvReceivableCloseAccID.toString().length>0?parseInt(e.AdvReceivableCloseAccID):0,o=i.EditColumns.find(D=>"RentalAccount"==D.ID),l.RentAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentalAccount)&&e.RentalAccount.toString().length>0?parseInt(e.RentalAccount):0,o=i.EditColumns.find(D=>"RentPayableAccount"==D.ID),l.RentPayableAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentPayableAccount)&&e.RentPayableAccount.toString().length>0?parseInt(e.RentPayableAccount):0,o=i.EditColumns.find(D=>"AdvanceRentPaid"==D.ID),l.AdvanceRentPaid=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AdvanceRentPaid)&&e.AdvanceRentPaid.toString().length>0?parseInt(e.AdvanceRentPaid):0,o=i.EditColumns.find(D=>"TenantID"==D.ID),l.TenantID=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.TenantID)&&e.TenantID.toString().length>0?parseInt(e.TenantID):0,o=i.EditColumns.find(D=>"LocationID"==D.ID),l.LocationID=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.LocationID)&&e.LocationID.toString().length>0?parseInt(e.LocationID):0,o=i.EditColumns.find(D=>"BasedOn"==D.ID),l.BasedOn=null!=o?e[o.DisplayMember].toString():e.BasedOn.toString(),l.PostIncome=t.J0.String(e.PostIncome),l.CustomFieldsQuery=s.toString(),l.CustomCCQuery=u.toString(),I.d.rental.SaveUnits(l,"SaveUnits").subscribe(D=>{i.DisplayMessage=D.Message},D=>{console.log(" Unit Save : "+JSON.stringify(D))})}else if(95==i.CostCenterID||103==i.CostCenterID||104==i.CostCenterID||129==i.CostCenterID){s.length>1&&(s=s.substr(0,s.length-1)),u.length>1&&(u=u.substr(0,u.length-1));let l=null;Object.keys(e).Contains("ContractID")?l=yield I.d.common.BulkEditDetals_7(11,parseInt(e.ContractID),i.CostCenterID,"",s.toString(),u,u.toLowerCase().Replace("ccnid","dcccnid")):e.Table.Columns.Contains("QuotationID")&&(l=yield I.d.common.BulkEditDetals_7(11,parseInt(e.QuotationID),i.CostCenterID,"",s.toString(),u,u.toLowerCase().Replace("ccnid","dcccnid"))),e.Message=l.obj&&l.obj>0?"Success":null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Columns[0].Contains("ServerMessage")?"Failure : "+l.Tables[0][0].ServerMessage.toString():null!=l&&l.Tables.length>0&&l.Tables[0].length>0&&l.Columns[0].Contains("ErrorMessage")?"Failure : "+l.Tables[0][0].ErrorMessage.toString():"Failure",i.EditGrid.updateRow(e)}else if(i.CostCenterID>=50001){let l={};l.NodeID=parseInt(e.NodeID),l.GUID=t.J0.String(e.GUID),l.CostCenterID=i.CostCenterID;let h=i.EditColumns.find(D=>"Code"==D.ID);l.Code=t.J0.String(null!=h?e[h.DisplayMember]:e.Code),h=i.EditColumns.find(D=>"Name"==D.ID),l.Name=t.J0.String(null!=h?e[h.DisplayMember]:e.Name),h=i.EditColumns.find(D=>"StatusID"==D.ID),l.Status=null!=h&&t.J0.String(e[h.ValueBinding]).length>0?parseInt(t.J0.String(e[h.ValueBinding])):parseInt(e.StatusID),l.StaticFieldsQuery=C.toString(),l.CustomFieldsQuery=s.toString(),l.CustomCostCenterFieldsQuery=u.toString(),l.CCXML="",I.d.common.SaveCostCenterQuick(l,"SaveCostCenterQuick").subscribe(D=>{if(a=D.Message,r=D.RetValue,r>0){e.Message="Success",i.EditGrid.updateRow(e);let c=I.d.common.BulkEditDetals_7(8,r,i.CostCenterID,"","","","").ds;null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&c.Columns[0].Contains("GUID")&&(e.GUID=t.J0.String(c.Tables[0][0].GUID))}else e.Message="Failure : "+a,i.EditGrid.updateRow(e)},D=>{alert(JSON.stringify(D)),console.log("Bulk Quick Add CostCenter Save : "+JSON.stringify(D))})}}catch(l){Logger.ErrorLog("BulkEdit-SAVE: ",l.Message)}else e.Message="NO DATA",i.EditGrid.updateRow(e)}})()}TransferUsers(n){let i="";if(n.forEach(r=>{i+=t.J0.String(r.NodeID)+","}),i=i.substr(0,i.length-1),i.length>0){let r=I.d.admin.TransferUser(this.CostCenterID,0,i,this.strOldUserID,this.TargetUserID.SelectedValue.toString());r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Columns[1].Contains("ErrorMessage")&&(this.DisplayMessage=r.Tables[r.Tables.length-1][0].ErrorMessage.toString()),this.RefreshData()}}DeleteDimension(n){this.setActionHistroy("Delete Dimension");let i,r="",a="";r=null!=this.ReportObj?"ReportPK":this.PrimaryKey;let C=0;for(let s=0;s<n.length;s++){const u=n[s];try{if(i=0,null!=this.ReportObj&&t.J0.IsEmpty(u.ReportPK))continue;if(2==this.CostCenterID){let m={};m.AccountID=parseInt(u[r]);let o=I.d.accounting.DeleteAccount(m.AccountID);a=o.Message,i=o.RetValue}else if(3==this.CostCenterID){let m=I.d.inventory.DeleteProduct(parseInt(u[r]));a=m.Message,i=m.RetValue}else if(this.CostCenterID>=50001){let m={};m.NodeID=parseInt(u[r]),m.CostCenterID=this.CostCenterID;let o=I.d.common.DeleteCostCenter(m.CostCenterID,m.NodeID);a=o.Message,i=o.RetValue}else a="Functionality not implemented";i>0?(C++,this.EditGrid.removeRow(u)):(u.Message="Failure : "+a,this.EditGrid.updateRow(u))}catch(m){Logger.ErrorLog("BulkEdit-DELETE: ",m.Message)}}this.DisplayMessage=C+" Records Deleted"}OnRowSelection(n){return!1}OnKeyDown(n,i){!i.ctrlKey&&117==i.which&&(i.preventDefault(),this.onCopy(this.EditGrid.getArgsObj(n)))}onCopy(n){if(null!=n){let r,a,C=n.column.className;n.grid.getEditorLock().commitCurrentEdit(),a=n.column.field;for(let s=0;s<this.EditGrid.Columns.length;s++){const u=this.EditGrid.Columns[s];if(null!=u.SectionName&&u.SectionName.toString()==a.toString()){r=u;for(let o=this.EditGrid.SelectedIndex;o<this.EditGrid.Table.length;o++)if((0,R.yG0)(this.EditGrid.Table[o].Select)){if(this.EditGrid.Table[o][a]=n.item[a].toString(),"DataGridDateTimeColumn"!=C&&"DataGridDateColumn"!=C||!this.EditGrid.TableColumns.Contains(a+"_Key")){if("DataGridPactListBoxColumn"==n.column.className){var i=this.EditGrid.Columns.find(d=>d.DisplayMember==a);null!=i&&(this.EditGrid.Table[o][i.ValueMember]=n.item[i.ValueMember].toString())}}else this.EditGrid.Table[o][a+"_Key"]=n.item[a+"_Key"].toString();this.EditGrid.updateRow(this.EditGrid.Table[o])}break}}}}Cancelclick(){this.ApproveVisibility=!1,I.d.page.HideDialog(this.PopUpGUID),null!=this.DB&&(this.ShowRightPanel=!1)}onClickIkon(n){this.ApprovalClick(n,null)}ApprovalClick(n,i){if(this.DisplayMessage="","Approve"==n||"Reject"==n||"Suspend"==n){if(this.RemarksApprove&&"Approve"==n&&t.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Approve Remarks Mandatory",-1;if(this.RemarksReject&&"Reject"==n&&t.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Reject Remarks Mandatory",-1;if(this.RemarksSuspend&&"Suspend"==n&&t.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Suspend Remarks Mandatory",-1;if(2==this.CostCenterID?this.strVoucherNo="AccountID":3==this.CostCenterID?this.strVoucherNo="ProductID":93==this.CostCenterID?this.strVoucherNo="UnitID":95==this.CostCenterID||104==this.CostCenterID?this.strVoucherNo="ContractID":103==this.CostCenterID||129==this.CostCenterID?this.strVoucherNo="QuotationID":92==this.CostCenterID||this.CostCenterID>5e4?this.strVoucherNo="NodeID":null!=this.ReportObj&&this.EditGrid.TableColumns.Contains("ReportPK")&&(this.strVoucherNo="ReportPK"),null==i&&(i=this.EditGrid.Table.filter(u=>1==u.Select||1==u.Select)),0==i.length)return this.DisplayMessage="No Rows Selected",-1;let r="",a="",C=!1,s=0;if(C=0!=t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0),"Approve"==n?s=1:"Suspend"==n&&(s=2),this.IsDocument)if(this.IsLWApproval&&"Suspend"!=n){let u=this.PrimaryKey;null!=this.ReportObj&&(u="ReportPK");let o,m=null,d="";i.forEach(e=>{o=t.J0.String(e[this.strVoucherNo]),o!=m&&(d.length>0&&(r.length>0&&(r+="\x11"),r+='<XML No="'+m+'">'+d+"</XML>"),d="",m=o),d+='<Row ID="'+t.J0.String(e[u])+'"  GUID="'+t.J0.String(e.GUID)+'"  Remarks="'+t.J0.EncodeXML(this.Remarks.Text)+'" WID="'+t.J0.String(e.WorkflowID)+'"/>'}),d.length>0&&(r.length>0&&(r+="\x11"),r+='<XML No="'+m+'">'+d+"</XML>")}else r+="<DOCXML>",i.forEach(u=>{if(r+='<Row VoucherNo="'+t.J0.String(u[this.strVoucherNo])+'" GUID = "'+t.J0.String(u.GUID)+'" />',!t.J0.IsEmpty(u[this.strVoucherNo])&&"BUA-"==u[this.strVoucherNo].toString().substr(0,4)){let m=0,d=I.d.common.GetDataSet3("BULK003",t.J0.String(u[this.strVoucherNo]),"","").Tables[0];if(null!=d&&d.length>0){m=parseInt(d[0].EmpSeqNo);let e=ee.RibbonExtPay.GetAppraisal(d);e.length>0&&(a+='<Row EmpNodeID="'+m+'" ',a+=' VoucherNo ="'+u[this.strVoucherNo].toString()+'" ',a+=' Query ="'+e+'" ',a+="/>")}}}),r+="</DOCXML>",a.length>0&&(a="<Data>"+a+"</Data>");else r+="<DOCXML>",i.forEach(u=>{r+='<Row VoucherNo="'+t.J0.String(u[this.strVoucherNo])+'" GUID = "'+t.J0.String(u.GUID)+'" />'}),r+="</DOCXML>";if(r.length>0){this.setActionHistroy(n);let u=0,m=I.d.common.BulkApprovals(this.CostCenterID,C,this.Remarks.Text,r.toString(),s,this.AppRejDate.Date.ToString("dd/MMM/yyyy"),a);return u=t.J0.Int(m.obj),u>0?(this.Remarks.Text="",i.forEach(o=>{this.EditGrid.removeRow(o)}),"Suspend"==n&&(this.Report.length>0?this.Report[0].Refresh():this.RefreshData()),this.DisplayMessage="Approve"==n?n+"d Successfully":n+"ed Successfully"):this.DisplayMessage="Error in Save",u}}return 0}setActionHistroy(n){let i="";null!=this.Report&&this.Report.length>0&&!t.J0.IsEmpty(this.Report[0].WhereTag)?i=this.Report[0].WhereTag:t.J0.IsEmpty(this.strWhereforAuctionHistory)||(i=this.strWhereforAuctionHistory),I.d.common.GetDataSet3("BULK005","Bulk Edit - "+n,i,I.d.SessionManager.UserName)}BarcodeDocument(n){if(0==this.EditColumns.length)return void(this.DisplayMessage="Please select ateleast one editable column.");if(null==n[0][this.EditColumns[0].DisplayMember])return void(this.DisplayMessage="Selected editable column not found.");let r,a,i="";if(!(this.CostCenterID>4e4&&this.CostCenterID<5e4))return void(this.DisplayMessage="Not implemented");a=0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",r=null!=this.ReportObj?"ReportPK":a;let C,u,s=new P.bT;n.forEach(m=>{C=t.J0.String(m[this.strVoucherNo]),s.ContainsKey(C)||s.push(C,[]),s[C].push(m)}),s.keys.forEach(m=>{let o={Key:m,Value:s[m]};i="",i+="<XML IgnorePositionDialog='1'>",o.Value.forEach(e=>{e.Message=null,u=t.J0.IntTryParse(t.J0.String(e[this.EditColumns[0].DisplayMember])),u>0?i+='<R DocDetailsID="'+t.J0.String(e[r])+'" Qty="'+t.J0.String(e[this.EditColumns[0].DisplayMember])+'"/>':e.Message="Invalid Quantity"}),i+="</XML>";let d=this.PrintBarcode(o.Key,i.toString());o.Value.forEach(e=>{null==e.Message&&(e.Message=d)})})}PrintBarcode(n,i){let s,r=0,a=0,u=I.d.report.GetDocumentDetailsByVoucherNo(n);if(s=t.J0.Int(u.obj),!(s>0))return"Voucher Not Found";{let m;m=u.Tables[0].length>0?u.Tables[0][0]:u.Tables[1][0],r=parseInt(m.CostCenterID),a=parseInt(m.DocID)}return"Success"}OnDateRangesSelectionChanged(n){null!=this.DateRanges.SelectedValue&&X.w.SetDateRanges(this.DateRanges.SelectedValue,this.FromDate,this.ToDate)}}class V{constructor(n,i){this.dsFields=null,this.CostCenterID=0,this.ClassName="BulkEditViewModel",this.dsFields=n,this.Parent=i,(i.ClassName="BulkEditViewModel")&&(this.CostCenterID=i.CostCenterID),this.FilterGrid=new L.vv,this.FilterGrid.Width="",this.FilterGrid.Height=200,this.FilterGrid.CanUserAddRows=!0,this.FilterGrid.CanUserDeleteRows=!0,this.FilterGrid.BeginEdit.Subscribe(this,"OnBeginEditing"),this.FilterGrid.CellEditEnding.Subscribe(this,"OnCellEditCommiting");let r=[],a=new M.O7,C=[],s={AND:"AND",Value:"AND"};C.push(s),s={},s.AND="OR",s.Value="OR",C.push(s),s={},s.AND="(",s.Value="(",C.push(s),s={},s.AND=")",s.Value=")",C.push(s),a=new M.O7,a.ComboData=C,a.DisplayMember="AND",a.ValueMember="Value",a.ValueBinding="And",a.Header="AND/OR",a.DataType="ComboBox",a.Width=80,a.IsVisible=!0,r.push(a),a=new M.O7,null!=n&&(a.ComboData=n.Tables[0]),a.DisplayMember="UserColumnName",a.ValueMember="CostCenterColID",a.ValueBinding="Field",a.DataType="ComboBox",a.Header="Column",a.Width=200,a.IsVisible=!0,r.push(a),a=new M.O7,a.ComboData=this.ReturnCondition(),a.DisplayMember="Condition",a.ValueMember="Value",a.ValueBinding="Condition",a.DataType="ComboBox",a.Header="Condition",a.Width=120,a.IsVisible=!0,r.push(a),a=new M.O7,a.Header="Value",a.DisplayMember="MULTI",a.ValueMember="MULTI_LISTBOX",a.DataType="MULTI_TYPE",a.Width=150,r.push(a),this.FilterGrid.Columns=r,this.FilterGrid.Clear(),this.FilterGrid.TableColumns.push("And"),this.FilterGrid.TableColumns.push("Column"),this.FilterGrid.TableColumns.push("Field"),this.FilterGrid.TableColumns.push("Condition"),this.FilterGrid.TableColumns.push("MULTI"),this.FilterGrid.TableColumns.push("MULTI_TYPE"),this.FilterGrid.TableColumns.push("MULTI_FLOAT"),this.FilterGrid.TableColumns.push("MULTI_DATE"),this.FilterGrid.TableColumns.push("MULTI_LISTBOX"),this.FilterGrid.TableColumns.push("MULTI_COMBOBOX");for(let u=0;u<10;u++){let m=this.FilterGrid.NewRow();this.FilterGrid.addRow(m)}}LoadXML(n){let i=new t.VB;i.LoadXml(n),this.FilterGrid.Clear(),i.DocumentElement.childNodes.length>0&&i.DocumentElement.childNodes.forEach(r=>{let a=this.FilterGrid.NewRow();if(a.And=r.attributes.And.value,t.J0.IsEmpty(r.attributes.Field.value)||(a.Field=r.attributes.Field.value),a.Condition=r.attributes.Condition.value,a.MULTI_TYPE=r.attributes.ValueType.value,a.MULTI=r.attributes.Value.value,null!=r.attributes.Value_Key&&!t.J0.IsEmpty(r.attributes.Value_Key.value))switch(t.J0.String(a.MULTI_TYPE)){case"DATE":case"DATETIME":a.MULTI_DATE=r.attributes.Value_Key.value;break;case"LISTBOX":a.MULTI_LISTBOX=r.attributes.Value_Key.value;break;case"COMBOBOX":a.MULTI_COMBOBOX=r.attributes.Value_Key.value}this.FilterGrid.addRow(a)});for(let r=0;r<10;r++){let a=this.FilterGrid.NewRow();this.FilterGrid.addRow(a)}}GetXML(){let n="";n+="<XML>";let i=0;for(let r=0;r<this.FilterGrid.Table.length;r++){const a=this.FilterGrid.Table[r];if(i++,""!=t.J0.String(a.And)||""!=t.J0.String(a.Field)){switch(n+='<Row And="',(1!=i||"("==t.J0.String(a.And))&&(n+=t.J0.String(a.And)),n+='"',n+=' Field="'+t.J0.String(a.Field)+'"',n+=' Condition="'+t.J0.EncodeXML(t.J0.String(a.Condition))+'"',n+=' ValueType="'+t.J0.EncodeXML(t.J0.String(a.MULTI_TYPE))+'"',n+=' Value="'+t.J0.EncodeXML(t.J0.String(a.MULTI))+'"',t.J0.String(a.MULTI_TYPE)){case"DATE":n+=' Value_Key="'+t.J0.EncodeXML(t.J0.String(a.MULTI_DATE))+'"';break;case"LISTBOX":n+=' Value_Key="'+t.J0.EncodeXML(t.J0.String(a.MULTI_LISTBOX))+'"';break;case"COMBOBOX":n+=' Value_Key="'+t.J0.EncodeXML(t.J0.String(a.MULTI_COMBOBOX))+'"'}n+="/>"}}return n+="</XML>",n.toString()}SetFieldsData(n,i){this.dsFields=n,this.CostCenterID=i;let r=[];this.FilterGrid.Columns[1].ComboData=n.Tables[0],this.FilterGrid.Columns.forEach(a=>{r.push(a)}),this.FilterGrid.Columns=r}ReturnCondition(){let n=[],i={Condition:"Equals",Value:"=",Type:"3"};return n.push(i),i={},i.Condition="Does Not Equals",i.Value="<>",i.Type="3",n.push(i),i={},i.Condition="Is greater than",i.Value=">",i.Type="2",n.push(i),i={},i.Condition="Is greater than or equals to",i.Value=">=",i.Type="2",n.push(i),i={},i.Condition="Is less than",i.Value="<",i.Type="2",n.push(i),i={},i.Condition="Is less than or equals to",i.Value="<=",i.Type="2",n.push(i),i={},i.Condition="Contains",i.Value="LIKE",i.Type="1",n.push(i),i={},i.Condition="Does Not Contains",i.Value="NOT LIKE",i.Type="1",n.push(i),i={},i.Condition="Is Null",i.Value="IS NULL",i.Type="1",n.push(i),i={},i.Condition="Is Not Null",i.Value="IS NOT NULL",i.Type="1",n.push(i),n}OnCellEditCommiting(n){let i=n.item;if("Field"==n.column.field){if(null==this.dsFields)return;let a=""==t.J0.String(i.Field)?[]:this.dsFields.Tables[0].filter(u=>u.CostCenterColID==t.J0.String(i.Field));if(0==a.length)return i.MULTI="",i.MULTI_TYPE="",i.MULTI_FLOAT=null,i.MULTI_DATE=null,i.MULTI_LISTBOX=null,void(i.MULTI_COMBOBOX=null);let C=parseInt(i.Field),s=t.J0.String(a[0].UserColumnType).toUpperCase();i.MULTI_TYPE="DATE"==s?"DATE":"FLOAT"==s||"NUMERIC"==s?"FLOAT":"LISTBOX"==s?"="==t.J0.String(i.Condition)||"<>"==t.J0.String(i.Condition)?"LISTBOX":"":241==C||264==C||252==C||"StatusID"==t.J0.String(a[0].SysColumnName)||93==this.CostCenterID&&"Status"==t.J0.String(a[0].SysColumnName)?"="==t.J0.String(i.Condition)||"<>"==t.J0.String(i.Condition)?"COMBOBOX":"":"TEXT"}this.FilterGrid.onMultiTypeColumnChanged.next(i)}OnCommitCell(n){let i=this.FilterGrid.Columns.find(s=>"MULTI"==s.DisplayMember),r=""==t.J0.String(n.Field)?[]:this.dsFields.Tables[0].filter(s=>s.CostCenterColID==t.J0.String(n.Field));if(0==r.length)return;let a=parseInt(n.Field),C=t.J0.String(r[0].UserColumnType).toUpperCase();if(i.DataType=C,"DATE"==C)n.MULTI_TYPE="DATE",i.DisplayMember="MULTI_DATE";else if("FLOAT"==C||"NUMERIC"==C)n.MULTI_TYPE="FLOAT",i.DisplayMember="MULTI_FLOAT";else if("LISTBOX"==C)i.CostCenterID=parseInt(t.J0.String(r[0].ColumnCostCenterID)),i.TypeID=parseInt(t.J0.String(r[0].ColumnCCListViewTypeID)),i.DisplayMember="MULTI_LISTBOX",n.MULTI_TYPE="="==t.J0.String(n.Condition)||"<>"==t.J0.String(n.Condition)?"LISTBOX":"";else if(241==a||264==a||252==a||"StatusID"==t.J0.String(r[0].SysColumnName)||93==this.CostCenterID&&"Status"==t.J0.String(r[0].SysColumnName))if("="==n.Condition.toString()||"<>"==t.J0.String(n.Condition)){n.MULTI_TYPE="COMBOBOX",i.DisplayMember="MULTI_COMBOBOX";let s=new Array,u=null;241==a||264==a?u=this.dsFields.Tables[4]:252==a?u=V.GetBillWiseTable():"StatusID"==t.J0.String(r[0].SysColumnName)&&(u=this.CostCenterID>4e4&&this.CostCenterID<5e4?this.dsFields.Tables[2]:this.dsFields.Tables[1]),u.forEach(m=>{s.push(B._p.ComboBoxItems_2(t.J0.String(m[Object.keys(m)[1]]),t.J0.String(m[Object.keys(m)[0]])))}),i.ComboData=i.ComboItems=s}else n.MULTI_TYPE="";else n.MULTI_TYPE="";this.FilterGrid.RefreshColumns()}OnBeginEditing(n){let i=n.args.item,r=this.FilterGrid.Columns.find(C=>"MULTI"==C.DisplayMember),a=n.args.column.field;if("Field"!=a&&"Condition"!=a&&"MULTI"==a){let C=""==t.J0.String(i.Field)?[]:this.dsFields.Tables[0].filter(m=>m.CostCenterColID==t.J0.String(i.Field));if(0==C.length)return void(n.Cancel=!0);let s=parseInt(i.Field),u=t.J0.String(C[0].UserColumnType).toUpperCase();if(n.args.column.DgCol.DataType=u,"DATE"==u)i.MULTI_TYPE="DATE";else if("FLOAT"==u||"NUMERIC"==u)i.MULTI_TYPE="FLOAT";else if("LISTBOX"==u)r.CostCenterID=parseInt(t.J0.String(C[0].ColumnCostCenterID)),r.TypeID=parseInt(t.J0.String(C[0].ColumnCCListViewTypeID)),n.args.column.DataGridColumn.CostCenterID=n.args.column.DgCol.CostCenterID=parseInt(t.J0.String(C[0].ColumnCostCenterID)),n.args.column.DataGridColumn.TypeID=n.args.column.DgCol.TypeID=parseInt(t.J0.String(C[0].ColumnCCListViewTypeID)),i.MULTI_TYPE="="==t.J0.String(i.Condition)||"<>"==t.J0.String(i.Condition)?"LISTBOX":"";else if(241==s||264==s||252==s||"StatusID"==t.J0.String(C[0].SysColumnName)||93==this.CostCenterID&&"Status"==t.J0.String(C[0].SysColumnName))if("="==i.Condition.toString()||"<>"==t.J0.String(i.Condition)){i.MULTI_TYPE="COMBOBOX";let m=new Array,o=null;241==s||264==s?o=this.dsFields.Tables[4]:252==s?o=V.GetBillWiseTable():"StatusID"==t.J0.String(C[0].SysColumnName)&&(o=this.CostCenterID>4e4&&this.CostCenterID<5e4?this.dsFields.Tables[2]:this.dsFields.Tables[1]),o.forEach(d=>{m.push(B._p.ComboBoxItems_2(t.J0.String(d[Object.keys(d)[1]]),t.J0.String(d[Object.keys(d)[0]])))}),r.ComboData=n.args.column.DgCol.ComboData=n.args.column.DgCol.ComboItems=m}else i.MULTI_TYPE="TEXT";else i.MULTI_TYPE="TEXT";this.FilterGrid.onMultiTypeColumnChanged.next(i)}}GetWhere(n,i){let C,u,m,d,e,l,r="",a=0,s=this.Parent,o="0",h="",D="",g=s.Entities,c=i;if(a=s.CostCenterID,C=s.IsDetailVoucher,s.IsDocument&&(D=0==t.J0.stringCompare(s.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID"),a>4e4&&a<5e4){for(let S=0;S<this.FilterGrid.Table.length;S++){const A=this.FilterGrid.Table[S];if(c++,t.J0.IsEmpty(A.And)&&t.J0.IsEmpty(A.Field))continue;(c!=i+1||"("==t.J0.String(A.And))&&(r+=" "+t.J0.String(A.And)+" ");let b=t.J0.IsEmpty(A.Field)?[]:this.dsFields.Tables[0].filter(T=>T.CostCenterColID==t.J0.String(A.Field));if(0==b.length)continue;let y=b[0];if(l="T"+c.toString(),e=t.J0.String(y.SysTableName),d=t.J0.String(y.SysColumnName),u=m="",0==t.J0.stringCompare(e,"COM_DocTextData"))if(g.ContainsKey("COM_DocTextData")||g.push("COM_DocTextData","TXT"),d="TXT."+d,"DATE"==t.J0.String(y.ColumnDataType)&&"IS NOT NULL"!=t.J0.String(A.Condition)&&"IS NULL"!=t.J0.String(A.Condition))d=" isdate("+d+")=1 and convert(datetime,"+d+")",u=m=d;else if("LISTBOX"==t.J0.String(y.UserColumnType)){let T;if("44"==t.J0.String(y.ColumnCostCenterID))T="case when "+d+" is not null and isnumeric("+d+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+d+") else '' end";else{let J=I.d.report.GetTableColumns(parseInt(y.ColumnCostCenterID));T=J.ColumnName,h=J.PrimaryKey,e=J.TableName,T="case when "+d+" is not null and isnumeric("+d+")=1 then (SELECT "+T+" FROM "+e+" with(nolock) WHERE "+h+"="+d+") else '' end"}u=T,m=d}else"LOOKUP"==t.J0.String(y.UserColumnType)||(u=m=d);else 0==t.J0.stringCompare(e,"COM_DocCCData")?(g.ContainsKey("COM_DocCCData")||g.push("COM_DocCCData","DCC"),g.ContainsKey(d)||(g.push(d,l),t.J0.GetTagTableName(parseInt(y.ParentCostCenterID))),u=null==y||t.J0.IsEmpty(y.ShowCode)||"YES"!=t.J0.String(y.ShowCode)?g[d]+".Name":g[d]+".Code",m="DCC."+d):null!=y.IsForeignKey&&(0,R.yG0)(y.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(d)?(g.ContainsKey(d)||(g.push(d,l),t.J0.String(y.ParentCostCenterSysName),t.J0.String(y.ParentCostCenterColSysName)),u=g[d]+"."+s.GetColumnName(y),m="D."+d):(d="D."+d,"DATE"==t.J0.String(y.ColumnDataType)&&(d="convert(datetime,"+d+")"),u=m=d);let N=t.J0.String(A.MULTI_TYPE);switch(t.J0.String(A.Condition)){case"=":case"<>":if("LISTBOX"==N){let T;T=t.J0.IntTryParse(t.J0.String(A.MULTI_LISTBOX)),r+=" "+m+t.J0.String(A.Condition)+T.toString()}else"COMBOBOX"==N?t.J0.String(A.MULTI_COMBOBOX).length>0&&(r+=" "+m+t.J0.String(A.Condition)+"'"+t.J0.String(A.MULTI_COMBOBOX)+"'"):"DATE"==N?t.J0.IsEmpty(A.MULTI_DATE)?r+=" "+m+t.J0.String(A.Condition)+"''":r+=" "+m+t.J0.String(A.Condition)+"'"+t.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":r+=" "+u+t.J0.String(A.Condition)+"'"+t.J0.String(A.MULTI)+"'";break;case"LIKE":case"NOT LIKE":r+=" "+u+" "+t.J0.String(A.Condition)+" '%"+t.J0.String(A.MULTI)+"%'";break;case"IS NULL":case"IS NOT NULL":r+=" "+u+" "+t.J0.String(A.Condition);break;case">":case">=":case"<":case"<=":r+="DATE"==N?" "+m+t.J0.String(A.Condition)+"'"+t.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+u+t.J0.String(A.Condition)+"'%"+t.J0.String(A.MULTI)+"'%"}}s.IsApproval&&500==i&&(r.length>0&&(r+=" and "),I.d.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"TRUE"==I.d.SessionManager.Preferences.CanApproveFunction.toUpperCase()?r+=" D.WorkFlowID>0 AND dbo.fnExt_CanApprove(D."+D+",D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+I.d.SessionManager.UserID+","+I.d.SessionManager.RoleID+")=1":r+=" D.WorkFlowID>0 AND dbo.[fnRPT_CanApprove](D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+I.d.SessionManager.UserID+","+I.d.SessionManager.RoleID+")=1")}else{for(let S=0;S<this.FilterGrid.Table.length;S++){const A=this.FilterGrid.Table[S];if(c++,t.J0.IsEmpty(A.And)&&t.J0.IsEmpty(A.Field))continue;(c!=i+1||"("==t.J0.String(A.And))&&(r+=" "+t.J0.String(A.And)+" ");let b=""==t.J0.String(A.Field)?[]:this.dsFields.Tables[0].filter(T=>T.CostCenterColID==t.J0.String(A.Field));if(0==b.length)continue;let y=b[0];if(l="T"+c.toString(),e=t.J0.String(y.SysTableName),d=t.J0.String(y.SysColumnName),u=m="",0==t.J0.stringCompare(e,"ACC_AccountsExtended")||0==t.J0.stringCompare(e,"INV_ProductExtended")||0==t.J0.stringCompare(e,"REN_UnitsExtended")||0==t.J0.stringCompare(e,"REN_ContractExtended")||0==t.J0.stringCompare(e,"REN_QuotationExtended"))if(g.ContainsKey(e)||g.push(e,"EXT"),d="EXT."+d,"DATE"==t.J0.String(y.ColumnDataType))d="convert(datetime,"+d+")",u=m=d;else if("LISTBOX"==t.J0.String(y.UserColumnType)){let T;if("44"==t.J0.String(y.ColumnCostCenterID))T="case when "+d+" is not null and isnumeric("+d+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+d+") else '' end";else{let J=I.d.report.GetTableColumns(parseInt(y.ColumnCostCenterID));T=J.ColumnName,h=J.PrimaryKey,e=J.TableName,T="case when "+d+" is not null and isnumeric("+d+")=1 then (SELECT "+T+" FROM "+e+" with(nolock) WHERE "+h+"="+d+") else '' end"}u=T,m=d}else u=m=d;else 0==t.J0.stringCompare(e,"COM_CCCCData")?(g.ContainsKey("COM_CCCCData")||g.push("COM_CCCCData","CCDATA"),g.ContainsKey(d)||(g.push(d,l),t.J0.GetTagTableName(parseInt(y.ParentCostCenterID))),u=g[d]+".Name",m="CCDATA."+d):null!=y.IsForeignKey&&(0,R.yG0)(y.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(d)?(g.ContainsKey(d)||(g.push(d,l),t.J0.String(y.ParentCostCenterSysName),t.J0.String(y.ParentCostCenterColSysName)),u=g[d]+"."+s.GetColumnName(y),m="D."+d):(d="D."+d,"DATE"==t.J0.String(y.ColumnDataType)&&(d="convert(datetime,"+d+")"),u=m=d);let N=t.J0.String(A.MULTI_TYPE);switch(t.J0.String(A.Condition)){case"=":case"<>":if("LISTBOX"==N)if("15408700"==t.J0.String(y.CostCenterColID))r+="("+u+"='"+A.MULTI.toString()+"' OR ",r+=u+" like '"+A.MULTI.toString()+",%' OR ",r+=u+" like '%,"+A.MULTI.toString()+"' OR ",r+=u+" like '%,"+A.MULTI.toString()+",%' ) ";else{let T;T=t.J0.IntTryParse(t.J0.String(A.MULTI_LISTBOX)),r+=" "+m+t.J0.String(A.Condition)+T.toString()}else"COMBOBOX"==N?t.J0.String(A.MULTI_COMBOBOX).length>0&&(r+=" "+m+t.J0.String(A.Condition)+"'"+A.MULTI_COMBOBOX.toString()+"'"):r+="DATE"==N?" "+m+t.J0.String(A.Condition)+"'"+t.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+u+t.J0.String(A.Condition)+"'"+t.J0.String(A.MULTI)+"'";break;case"LIKE":case"NOT LIKE":r+=" "+u+" "+t.J0.String(A.Condition)+" '%"+t.J0.String(A.MULTI)+"%'";break;case">":case">=":case"<":case"<=":r+="DATE"==N?" "+m+t.J0.String(A.Condition)+"'"+t.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+u+t.J0.String(A.Condition)+"'%"+t.J0.String(A.MULTI)+"'%"}}s.IsApproval&&500==i&&(u=2==a?"D.AccountID":3==a?"D.ProductID":93==a?"D.UnitID":94==a?"D.TenantID":95==a||104==a?"D.ContractID":103==a||129==a?"D.QuotationID":"D.NodeID",(2==a||3==a||93==a||94==a||a>5e4)&&(o=50051==a||50054==a?"0":"ISNULL(D.WorkFlowID,0)"),r.length>0&&(r+=" and "),r+=95==a||103==a||104==a||129==a?" D.StatusID IN (470,440,465)":93==a?" D.Status IN (1001,1003)":" D.StatusID IN (1001,1003)",r+=95==a||103==a||104==a||129==a?" AND dbo.[fnREN_CanContractApprove]("+a+","+u+","+I.d.SessionManager.UserID+","+I.d.SessionManager.RoleID+")=1 ":" AND dbo.[fnRPT_CanCostCentetApprove]("+a+","+u+","+I.d.SessionManager.UserID+","+I.d.SessionManager.RoleID+","+o+")=1 ")}return r.toString()}static GetBillWiseTable(){let n=[],i={Value:1,Name:"YES"};return n.push(i),i.Value=0,i.Name="NO",n.push(i),n}}class oe{constructor(n,i){this.Title="",this.ApplyToAll=!1,this.Parent=n,this.SourceColumn=i,this.Title=i.Header,this.FindGrid=new L.vv,this.FindGrid.CanUserDeleteRows=!0,this.FindGrid.Columns=[],this.FindGrid.Columns.push(i),this.FindGrid.Columns[0].Header="Find What",this.FindGrid.Columns[0].Width=233,this.FindGrid.Table=n.EditGrid.Table;let r=this.FindGrid.NewRow();this.FindGrid.addRow(r),this.FindGrid.SelectedItem=this.FindGrid.Table[0],this.FindGrid.SelectedIndex=0,this.ReplaceGrid=new L.vv,this.ReplaceGrid.CanUserDeleteRows=!0,this.ReplaceGrid.Columns=[],this.ReplaceGrid.Columns.push(i),this.ReplaceGrid.Columns[0].Header="Replace With",this.ReplaceGrid.Columns[0].Width=233,this.ReplaceGrid.Table=n.EditGrid.Table,r=this.ReplaceGrid.NewRow(),this.ReplaceGrid.addRow(r),this.ReplaceGrid.SelectedItem=this.ReplaceGrid.Table[0],this.ReplaceGrid.SelectedIndex=0}OnButtonClick(n){if(this.Parent.DisplayMessage="","Replace"==n){let i=!1,r=this.SourceColumn.SectionName+"_Key";this.Parent.EditGrid.TableColumns.Contains(r)?i=!0:r=this.SourceColumn.SectionName;let a=t.J0.String(this.FindGrid.Table[0][r]);if(this.ApplyToAll)this.Parent.EditGrid.Table.forEach(C=>{C[this.SourceColumn.SectionName]=this.ReplaceGrid.Table[0][this.SourceColumn.SectionName],i&&(C[r]=this.ReplaceGrid.Table[0][r]),C.Select=!0,this.Parent.EditGrid.updateRow(C)}),this.Parent.DisplayMessage=this.Parent.EditGrid.Table.length+" Rows Replaced";else{let C=0;this.Parent.EditGrid.Table.forEach(s=>{0==t.J0.stringCompare(a,t.J0.String(s[r]),!0)&&(s[this.SourceColumn.SectionName]=this.ReplaceGrid.Table[0][this.SourceColumn.SectionName],i&&(s[r]=this.ReplaceGrid.Table[0][r]),s.Select=!0,this.Parent.EditGrid.updateRow(s),C++)}),this.Parent.DisplayMessage=0==C?"No Rows Found":C+" Rows Replaced"}}else"Cancel"==n&&(this.Parent.ReplaceVisibility=!1,this.Parent.ApproveVisibility=!1)}}}}]);