"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[8114],{75733:(k,M,u)=>{u.r(M),u.d(M,{ACC_Asset:()=>g});var p=u(32040),C=u(43767),R=u(26336),y=u(54581),f=u(76260),w=u(61488);class g extends f.A{constructor(r){super(r),this.i=0,this.k=0,this.jAccount=0,this.dsTrail=null,this.Balance=0,this.OpBalance=0,this.colBalanceIndex=-1,this.colDebitIndex=-1,this.colCreditIndex=-1,this.colSpanBF=-1,this.colSubTotalStartIndex=0,this.GroupTotalIndex=0,this.CntMonths=0,this.dtStart=Date.Today(),this.IncludeBFInTotals=!1,this.AccountsWithOutTransactions=!1,this.AccountsWithZeroBalance=!1,this.PDCSeperate=!1,this.PDCDrCrSeperate=!1,this.STAccountWise=!1,this.STMonthWise=!1,this.STDayWise=!1,this.ShowGeneralLedgerDetailReport=!1,this.TBIsAccountWise=!1,this.TBOpeningDrCrSeperately=!1,this.TBTransactionsDrCrSeperately=!1,this.OpenCompany=!1,this.ShowTagWise=!1,this.TBShowdetailsofControlGroups=!1,this.UnPostedDocsSeparately=!1,this.AllowAddRows=!1,this.GroupTotalsAtEnd=!1,this.GroupTotalsSeperate=!1,this.DontShowSummaryGroupTotals=!1,this.TagID=0,this.TagTableName=null,this.CountMonths=0,this.IsNewAccount=!0,this.Col1=0,this.Col2=0,this.dec="",this.LocationWhere="",this.filter="",this.LevelNo=0,this.dvDepr=null,this.dvDeprTable=null,this.lstTotal=null,this.lstParents=new Array}LoadReport(){if(this.GrdRow=-1,this.GroupTotalIndex=-1,this.colSubTotalStartIndex=-1,this.lstTotal=new Array,this.DataSetCollection.Clear(),this.ViewModel.lstGroupIndex.Clear(),this.ViewModel.lstGroup.length>0)for(this.k=0;this.k<this.oColumns.length;this.k++)if(this.ViewModel.lstGroup[0].TotalCols.ContainsKey(this.oColumns[this.k].ID)){this.colSubTotalStartIndex=this.k;break}let r="",e="";if(this.ViewModel.oReportDialog.Locations.Visible&&null!=this.ViewModel.oReportDialog.LocationWhere&&(e=" AND A.LocationID IN ("+this.ViewModel.oReportDialog.LocationWhere+")"),116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType){let t=this.ViewModel.oReportDialog.GetSeqNosList();this.dec="N2",r=" select A.IsGroup,A.AssetID,Convert(datetime,A.DeprStartDate) as DeprStartDate,A.AssetName,A.PurchaseValue as OriginalPurchase,A.DeprStartValue as PurchaseCurrent,A.EstimateLife as LifeYrs\n,isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ToDateDepreciation,\n(A.PurchaseValue+A.DeprStartValue)-isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as OpeningValue,\nisnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) + isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ReportDepreciation,\n(A.PurchaseValue+A.DeprStartValue)-(isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) + isnull((select sum(DepAmount) from ACC_AssetDepSchedule ADS where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as NetValue,\n(select Count(*) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"') as Number \n, A.lft,A.Depth,A.ParentID from ACC_Assets A with(nolock) where A.AssetID IN ("+t+") and A.AssetID > 1 "+e+" Order By A.lft\n\n                        select AssetID,Convert(datetime,DeprStartDate) DeprStartDate,DepAmount from ACC_AssetDepSchedule with(nolock)\n                        WHERE AssetID IN ("+t+") and Convert(datetime,DeprStartDate)>='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,DeprEndDate )<='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'"}else if(118==this.ViewModel.StaticReportType){let t=this.ViewModel.oReportDialog.GetSeqNosList();r="select G.AssetName AssetGroup,G.AssetName+ ' Upto '+'"+this.ViewModel.FromDatePicker.Date.ToString("MMM yyyy")+"'+' (Last Year)' DATEGROUP,A.IsGroup,A.AssetID,A.AssetName,Convert(datetime,A.DeprStartDate) as DateofCapitalisation,A.PurchaseValue as Cost,\n                        Convert(nvarchar(50),(isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0)/A.PurchaseValue)*100)+'%' as Rate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as AccDepreciation,\n                        A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as WDVToDate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprEndDate) <'"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ChargedUpto,\n                        (A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0))-\n                        (isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprEndDate) <'"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as WDVTillDate \n                        , A.lft,A.Depth,A.ParentID,0 as History "+this.ViewModel.SelectTag+"\n                        from  Acc_Assets A with(nolock) LEFT JOIN Acc_Assets G with(nolock) ON G.AssetID=A.ParentID"+this.ViewModel.FromTag+"\n                        where  A.IsGroup=0 AND A.AssetID in ("+t+") and A.AssetID > 1 "+e,r+=" UNION ALL\n                        select G.AssetName AssetGroup,G.AssetName+ ' - CURRENT YEAR' DATEGROUP,A.IsGroup,A.AssetID,A.AssetName,Convert(datetime,A.DeprStartDate) as DateofCapitalisation,A.PurchaseValue as Cost,\n                        Convert(nvarchar(50),(isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) <'"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"'),0)/A.PurchaseValue)*100)+'%' as Rate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"' ),0) as AccDepreciation,\n                        A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as WDVToDate,\n                        isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0) as ChargedUpto,\n                        (A.PurchaseValue-isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0))-\n                        (isnull((select sum(ADS.DepAmount) from ACC_AssetDepSchedule ADS with(nolock) where ADS.AssetID=A.AssetID and Convert(datetime,ADS.DeprStartDate) >='"+this.ViewModel.FromDatePicker.Date.ToString("dd MMM yyyy")+"' and Convert(datetime,ADS.DeprEndDate) <='"+this.ViewModel.ToDatePicker.Date.ToString("dd MMM yyyy")+"'),0)) as WDVTillDate \n                        , A.lft,A.Depth,A.ParentID,1 as History "+this.ViewModel.SelectTag+"\n                        from  Acc_Assets A with(nolock) LEFT JOIN Acc_Assets G with(nolock) ON G.AssetID=A.ParentID "+this.ViewModel.FromTag+"\n                        where A.IsGroup=0 AND A.AssetID in ("+t+") and A.AssetID > 1 "+e+" Order By AssetGroup,DATEGROUP desc"}if(120==this.ViewModel.StaticReportType){let t=0,o="",l="",s="",h="";new R.bT,this.ViewModel.ReportGroups.forEach(i=>{i.CDGDO.ColumnCostCenterID>5e4?(i.CDGDO.ParentTableAlias="C"+i.CDGDO.ColumnCostCenterID,l+=i.CDGDO.ParentTableAlias+"."+i.CDGDO.Column+" AS "+i.ID+",",s+=" INNER JOIN "+i.CDGDO.ParentCostCenterSysName+" AS "+i.CDGDO.ParentTableAlias,s+=" with(nolock) ON "+i.CDGDO.ParentTableAlias+".NodeID=CC."+i.CDGDO.ParentColumn,o+=i.ID+","):72==i.CDGDO.ColumnCostCenterID&&"ParentID"==i.CDGDO.ParentColumn&&(l+="AG."+i.CDGDO.Column+" AS "+i.ID+",",o+=i.ID+","),"1"!=i.ShowAsColumn.SelectedValue&&t++}),s.length>0&&(s=" INNER JOIN COM_CCCCData CC with(nolock) ON CC.CostCenterID=72 AND CC.NodeID=A.AssetID"+s),o.length>0&&(o=" ORDER BY "+o.TrimEnd(",")),this.ViewModel.Preferences.ContainsKey("Status")&&"Active"==this.ViewModel.Preferences.Status&&(h=" and A.StatusID=1  "),this.ViewModel.Preferences.ContainsKey("Status")&&"Dispose"==this.ViewModel.Preferences.Status&&(h=" and A.StatusID=0");let m=this.ViewModel.oReportDialog.GetSeqNosList(),d=new Date((new Date).getFullYear(),p.d.SessionManager.AccountingFromMonth-1,1);d>Date.Today()&&(d=d.AddYears(-1)),r=" select A.AssetID,"+l+"\nA.AssetCode,A.AssetName,AG.AssetCode GroupCode,AG.AssetName GroupName,AG.PurchaseInvoiceNo,Convert(datetime,A.PurchaseDate) PurchaseDate,A.PurchaseValue,\nisnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0) as Addition,\nisnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end  from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0) as Deletion,\n((A.PurchaseValue+isnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0))-isnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0)) as NetCost,\nA.EstimateLife,\nA.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+d+"' and D.DocID IS NOT NULL),0) as PreviousDepreciation,\nisnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+d+"' and D.DocID IS NOT NULL),0) as CurrentYearDepreciation,\n(A.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+d+"' and D.DocID IS NOT NULL),0))+(isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+d+"' and D.DocID IS NOT NULL),0)) as TotalDepreciation,\n(((A.PurchaseValue+isnull((select sum(AC.AssetNewValue-AC.AssetOldValue) from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (0,2)),0))-isnull((select case when sum(AC.AssetNewValue-AC.AssetOldValue)<0 then sum(AC.AssetNewValue-AC.AssetOldValue)*(-1) else sum(AC.AssetNewValue-AC.AssetOldValue) end from ACC_AssetChanges AC with(nolock) where AC.AssetID=A.AssetID and  AC.ChangeType in (1,3)),0))\n-((A.PreviousDepreciation+isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)<'"+d+"' and D.DocID IS NOT NULL),0))+(isnull((select sum(D.DepAmount) from ACC_AssetDepSchedule D with(nolock) where D.AssetID=A.AssetID and Convert(datetime,D.DeprStartDate)>='"+d+"' and D.DocID IS NOT NULL),0)))) as NetBalance\nFROM ACC_Assets A with(nolock) INNER JOIN ACC_Assets AG with(nolock) ON AG.AssetID=A.ParentID\n"+s+" WHERE A.AssetID IN ("+m+") and A.IsGroup=0 "+h+o+e,p.d.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,r).then(i=>{this.ds=i,this.dv=this.dvTable=this.ds.Tables[0],this.dvColumns=this.ds.Columns[0],this.ViewModel.ReportData=this.ds.Tables[0],this.ViewModel.ConstructFormulaFields(!0),this.ViewModel.totals=C.J0.NumArray(this.ViewModel.ReportColumns.length,this.ViewModel.lstGroup.length+1),this.ViewModel.hiddenTotals=C.J0.NumArray(this.ViewModel.HiddenNumericColumns.length,this.ViewModel.lstGroup.length+1),this.ViewModel.RenderData(this.dv),this.ViewModel.CheckAndAddTotals(this.dv),this.LoadReport_Complete()})}if(116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType)this.CntMonths=0,p.d.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,r).then(t=>{this.ds=t,120!=this.ViewModel.StaticReportType&&(this.dvDepr=this.dvDeprTable=this.ds.Tables[1]);let o=new Array;for(let l=0;l<this.ViewModel.ColumnSource.length;l++)if(o.push(this.ViewModel.ColumnSource[l]),116==this.ViewModel.StaticReportType&&"MONTHS"==this.ViewModel.ColumnSource[l].ID){for(this.dtStart=this.ViewModel.FromDatePicker.Date;this.dtStart<=this.ViewModel.ToDatePicker.Date;){let s=o[7].Clone();s.HeaderText=this.dtStart.ToString("MMM yyyy"),s.ID=this.dtStart.ToString("MMMyyyy"),o.push(s),this.ds.Tables[0].Columns.push(s.ID),this.CntMonths++,this.dtStart=this.dtStart.AddMonths(1)}o.Remove(this.ViewModel.ColumnSource[l])}this.ViewModel.ReportColumns=o,this.oColumns=this.ViewModel.ReportColumns,this.dv=this.ds.Tables[0],this.addTrialBalance(),this.AddReportTotals(),this.LoadReport_Complete()});else if(118==this.ViewModel.StaticReportType){let t=-1,o=-1,l=-1,s=-1,h=-1;this.AggTotal=C.J0.NumArray(this.oColumns.length+1,2),p.d.report.ReportDataSetAsync("RPT022",this.ViewModel.IsReportDB,r).then(V=>{this.ds=V,this.ViewModel.RenderData(this.ds.Tables[0]),this.ViewModel.CheckAndAddTotals(this.ds.Tables[0]),this.oRow=this.NewReportRow_2(w.QS.Header,this.HeaderAppearance),this.oRow.Cells[0].Text="SUMMARY",this.oRow.Cells[0].CellAppearance.IsUnderline=!0,this.oRow.Cells[0].ColSpan=this.oRow.Cells.length,this.ViewModel.addRow(this.oRow);for(let a=0;a<this.oColumns.length;a++)"Cost"==this.oColumns[a].ID.toString()&&(t=a),"AccDepreciation"==this.oColumns[a].ID.toString()&&(o=a),"WDVToDate"==this.oColumns[a].ID.toString()&&(l=a),"ChargedUpto"==this.oColumns[a].ID.toString()&&(s=a),"WDVTillDate"==this.oColumns[a].ID.toString()&&(h=a);let m,d,i,S=this.ds.Tables[0].ToTable(!0,["ParentID","AssetGroup"]),A=new R.bT,D=C.J0.NumArray(this.oColumns.length,2);for(let a=0;a<3;a++){0==a?(m="1",d=" (CURRENT YEAR)"):1==a?(m="0",d=" (LAST YEAR)"):(m="0",d=" (CURRENT + LAST YEAR)");for(let c=0;c<S.length;c++){if(this.oRow=this.NewReportRow(),this.oRow.Cells[0].ColSpan=3,i=S[c].AssetGroup.toString(),2!=a){A.ContainsKey(i)||A.push(i,C.J0.NumArray(this.oColumns.length,2)),this.oRow.Cells[0].Text="TOTAL - "+S[c].AssetGroup.toString()+d;let T=this.ds.Tables[0].filter(I=>I.History==m&&I.ParentID==S[c][S.Columns[0][0]]),n=T.Compute("sum","Cost");-1!=t&&(this.ViewModel.SetCellValue(n,this.oColumns[t].DataFormat,"FLOAT",this.oRow.Cells[t]),null!=n&&(A[i][t][a]+=parseFloat(n),D[t][a]+=parseFloat(n))),n=T.Compute("sum","AccDepreciation"),-1!=o&&(this.ViewModel.SetCellValue(n,this.oColumns[o].DataFormat,"FLOAT",this.oRow.Cells[o]),null!=n&&(A[i][o][a]+=parseFloat(n),D[o][a]+=parseFloat(n))),n=T.Compute("sum","WDVToDate"),-1!=l&&(this.ViewModel.SetCellValue(n,this.oColumns[l].DataFormat,"FLOAT",this.oRow.Cells[l]),null!=n&&(A[i][l][a]+=parseFloat(n),D[l][a]+=parseFloat(n))),n=T.Compute("sum","ChargedUpto"),-1!=s&&(this.ViewModel.SetCellValue(n,this.oColumns[s].DataFormat,"FLOAT",this.oRow.Cells[s]),null!=n&&(A[i][s][a]+=parseFloat(n),D[s][a]+=parseFloat(n))),n=T.Compute("sum","WDVTillDate"),-1!=h&&(this.ViewModel.SetCellValue(n,this.oColumns[h].DataFormat,"FLOAT",this.oRow.Cells[h]),null!=n&&(A[i][h][a]+=parseFloat(n),D[h][a]+=parseFloat(n)))}else this.oRow.Cells[0].Text="GRAND TOTAL - "+i+d,A.ContainsKey(i)&&(-1!=t&&this.ViewModel.SetCellValue(A[i][t][0]+A[i][t][1],this.oColumns[t].DataFormat,"FLOAT",this.oRow.Cells[t]),-1!=o&&this.ViewModel.SetCellValue(A[i][o][0]+A[i][o][1],this.oColumns[o].DataFormat,"FLOAT",this.oRow.Cells[o]),-1!=l&&this.ViewModel.SetCellValue(A[i][l][0]+A[i][l][1],this.oColumns[l].DataFormat,"FLOAT",this.oRow.Cells[l]),-1!=s&&this.ViewModel.SetCellValue(A[i][s][0]+A[i][s][1],this.oColumns[s].DataFormat,"FLOAT",this.oRow.Cells[s]),-1!=h&&this.ViewModel.SetCellValue(A[i][h][0]+A[i][h][1],this.oColumns[h].DataFormat,"FLOAT",this.oRow.Cells[h]));this.ViewModel.addRow(this.oRow)}this.oRow=this.NewReportRow_2(w.QS.SubTotal,this.GrossTotalAppearance),this.oRow.Cells[0].ColSpan=3,this.oRow.Cells[0].Text="GRAND TOTAL - "+d,2!=a?(-1!=t&&(this.ViewModel.SetCellValue(D[t][a],this.oColumns[t].DataFormat,"FLOAT",this.oRow.Cells[t]),this.oRow.Cells[t].CellAppearance.Alignment="Right"),-1!=o&&(this.ViewModel.SetCellValue(D[o][a],this.oColumns[o].DataFormat,"FLOAT",this.oRow.Cells[o]),this.oRow.Cells[o].CellAppearance.Alignment="Right"),-1!=l&&(this.ViewModel.SetCellValue(D[l][a],this.oColumns[l].DataFormat,"FLOAT",this.oRow.Cells[l]),this.oRow.Cells[l].CellAppearance.Alignment="Right"),-1!=s&&(this.ViewModel.SetCellValue(D[s][a],this.oColumns[s].DataFormat,"FLOAT",this.oRow.Cells[s]),this.oRow.Cells[s].CellAppearance.Alignment="Right"),-1!=h&&(this.ViewModel.SetCellValue(D[h][a],this.oColumns[h].DataFormat,"FLOAT",this.oRow.Cells[h]),this.oRow.Cells[h].CellAppearance.Alignment="Right")):(-1!=t&&(this.ViewModel.SetCellValue(D[t][0]+D[t][1],this.oColumns[t].DataFormat,"FLOAT",this.oRow.Cells[t]),this.oRow.Cells[t].CellAppearance.Alignment="Right"),-1!=o&&(this.ViewModel.SetCellValue(D[o][0]+D[o][1],this.oColumns[o].DataFormat,"FLOAT",this.oRow.Cells[o]),this.oRow.Cells[o].CellAppearance.Alignment="Right"),-1!=l&&(this.ViewModel.SetCellValue(D[l][0]+D[l][1],this.oColumns[l].DataFormat,"FLOAT",this.oRow.Cells[l]),this.oRow.Cells[l].CellAppearance.Alignment="Right"),-1!=s&&(this.ViewModel.SetCellValue(D[s][0]+D[s][1],this.oColumns[s].DataFormat,"FLOAT",this.oRow.Cells[s]),this.oRow.Cells[s].CellAppearance.Alignment="Right"),-1!=h&&(this.ViewModel.SetCellValue(D[h][0]+D[h][1],this.oColumns[h].DataFormat,"FLOAT",this.oRow.Cells[h]),this.oRow.Cells[h].CellAppearance.Alignment="Right")),this.ViewModel.addRow(this.oRow)}this.LoadReport_Complete()})}}LoadReport_Complete(){this.ViewModel.FormulasCalculated=!0,this.ViewModel.process_RunWorkerCompleted()}AddReportTotals(){if(116==this.ViewModel.StaticReportType||117==this.ViewModel.StaticReportType||120==this.ViewModel.StaticReportType){this.UpdateTreeTotals(0),this.row=this.NewReportRow_2(w.QS.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance),this.ViewModel.GrpReportTotal.Height>0&&(this.row.Height=this.ViewModel.GrpReportTotal.Height),this.row.LevelNo=0;let r=-1;for(this.k=0;this.k<this.ViewModel.ColumnSource.length;this.k++)0!=this.ViewModel.GrpReportTotal.TotalCols.length&&this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(this.oColumns[this.k].ID)&&(-1==r&&(r=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.lstTotal[0][this.k].toString(),this.oColumns[this.k].DataFormat,this.oColumns[this.k].ColumnType,this.row.Cells[this.k]));for(this.k=this.ViewModel.ColumnSource.length;this.k<this.oColumns.length;this.k++)-1==r&&(r=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.lstTotal[0][this.k].toString(),this.oColumns[this.k].DataFormat,this.oColumns[this.k].ColumnType,this.row.Cells[this.k]);this.row.Cells[0].Text=p.d.GetResource("Reports_ReportTotal"),r>0&&(this.GrdRow++,this.row.Cells[0].ColSpan=r,this.ViewModel.addRow(this.row))}else{this.GrdRow++,this.row=this.NewReportRow_2(w.QS.ReportTotal,this.ViewModel.GrpReportTotal.SubTotalAppearance),this.ViewModel.GrpReportTotal.Height>0&&(this.row.Height=this.ViewModel.GrpReportTotal.Height),this.row.LevelNo=1;let r=-1;for(this.k=0;this.k<this.oColumns.length;this.k++)this.ViewModel.GrpReportTotal.TotalCols.ContainsKey(this.oColumns[this.k].ID)&&(-1==r&&(r=this.k),this.row.Cells[this.k].CellAppearance.Alignment="Right",this.ViewModel.SetCellValue(this.AggTotal[0].toString(),this.oColumns[this.k].DataFormat,"FLOAT",this.row.Cells[this.k]));this.row.Cells[0].Text=p.d.GetResource("Reports_ReportTotal"),r>0&&(this.row.Cells[0].ColSpan=r,this.ViewModel.addRow(this.row))}}LoadReportWithPostFilters(r){}addTrialBalance(){for(this.lstParents.Clear(),this.lstTotal.Clear(),this.lstParents.push(this.NewReportRow()),this.lstTotal.push(new Array(this.oColumns.length).fill(0)),this.k=0;this.k<this.dv.length;this.k++){this.oRow=this.NewReportRow(),this.oRow.LevelNo=parseInt(this.dv[this.k].Depth)-1,this.oRow.Cells[1].IsNormal=!1,this.oRow.IsGroup=(0,y.yG0)(this.dv[this.k].IsGroup),this.oRow.DataRow=this.dv[this.k];let r=parseInt(this.dv[this.k].AssetID);if(this.oRow.Cells[1].level=this.oRow.LevelNo,this.UpdateTreeTotals(this.oRow.LevelNo),(0,y.yG0)(this.dv[this.k].IsGroup)){this.lstParents.push(this.oRow),new Array(this.oColumns.length).fill(0),this.oRow.Type=w.QS.BalanceBF;for(let e=0;e<this.oRow.Cells.length;e++)this.oRow.Cells[e].IsNormal=!1,this.oRow.Cells[e].CellAppearance=this.BalanceBFAppearance_Data.Clone(),this.oRow.Cells[e].CellAppearance.Alignment=this.oColumns[e].DataAppearance.Alignment}else 120!=this.ViewModel.StaticReportType&&(this.dvDepr=this.dvDeprTable.filter(e=>e.AssetID==r),this.dvDepr.forEach(e=>{let t=C.J0.ParseDate(e.DeprStartDate).ToString("MMMyyyy");this.dvColumns.Contains(t)&&(this.dv[this.k][t]=e.DepAmount)}));for(let e=0;e<this.oColumns.length;e++)this.CellValue=null,C.J0.IsEmpty(this.dv[this.k][this.oColumns[e].ID])||(this.CellValue=this.dv[this.k][this.oColumns[e].ID]),null!=this.CellValue&&(this.ViewModel.SetCellValue(this.CellValue,this.oColumns[e].DataFormat,this.oColumns[e].ColumnType,this.oRow.Cells[e]),C.J0.IsNum(this.CellValue)&&(this.dbl=C.J0.Double(this.CellValue),this.lstTotal.length>0&&(this.lstTotal[this.lstTotal.length-1][e]+=this.dbl)));if(this.GrdRow++,this.ViewModel.addRow(this.oRow),120!=this.ViewModel.StaticReportType&&!this.oRow.IsGroup){let e=0,t=this.ViewModel.FromDatePicker.Date,o=this.ViewModel.FromDatePicker.Date,l=parseInt(this.dv[this.k].Number);for(let s=0;s<this.ViewModel.ReportColumns.length;s++)this.ViewModel.ReportColumns[s].ID==t.ToString("MMMyyyy")&&(e=s);if(t=t.AddMonths(1),this.oRow=this.NewReportRow(),this.oRow.LevelNo=parseInt(this.dv[this.k].Depth)-1,this.oRow.Cells[0].IsNormal=!1,this.oRow.Cells[0].Text=null!=this.dv[this.k].DeprStartDate?l.toString()+" & "+C.J0.ParseDate(this.dv[this.k].DeprStartDate).ToString("dd/MMM/yyyy"):l.toString(),116==this.ViewModel.StaticReportType){for(let s=0;s<this.CntMonths;s++)this.dvColumns.Contains(o.ToString("MMMyyyy"))&&null!=this.dv[this.k][o.ToString("MMMyyyy")]&&(this.oRow.Cells[e].Text=(l+1).toString(),l++),s>0&&1==l&&(this.oRow.Cells[0].Text=-s+" & "+C.J0.ParseDate(this.dv[this.k].DeprStartDate).ToString("dd/MMM/yyyy")),e++,o=o.AddMonths(1);this.CntMonths>0&&0==l&&(this.oRow.Cells[0].Text=-this.CntMonths+" & "+C.J0.ParseDate(this.dv[this.k].DeprStartDate).ToString("dd/MMM/yyyy"))}this.ViewModel.addRow(this.oRow),o=this.ViewModel.FromDatePicker.Date,e=0;for(let s=0;s<this.ViewModel.ReportColumns.length;s++)this.ViewModel.ReportColumns[s].ID==t.ToString("MMMyyyy")&&(e=s);if(this.oRow=this.NewReportRow(),this.oRow.LevelNo=parseInt(this.dv[this.k].Depth)-1,this.oRow.Cells[0].IsNormal=!1,this.oRow.Cells[0].Text="Net Book Value",116==this.ViewModel.StaticReportType){let s=0;for(let h=0;h<this.CntMonths;h++)this.dvColumns.Contains(o.ToString("MMMyyyy"))&&(null!=this.dv[this.k][o.ToString("MMMyyyy")]&&(0==s?s=parseFloat(this.dv[this.k].OpeningValue.toString())-parseFloat(this.dv[this.k][o.ToString("MMMyyyy")].toString()):s-=parseFloat(this.dv[this.k][o.ToString("MMMyyyy")].toString()),this.oRow.Cells[e-1].Text=s.toString()),e++,o=o.AddMonths(1))}this.GrdRow++,this.ViewModel.addRow(this.oRow)}}}UpdateTreeTotals(r){for(let e=this.lstTotal.length-1;e>r;e--){if(e>0)for(let t=0;t<this.lstTotal[e].length;t++)this.lstTotal[e-1][t]+=this.lstTotal[e][t];if(!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.lstParents[e].IsExpanded)for(let t=0;t<this.oColumns.length;t++)"FLOAT"==this.oColumns[t].ColumnType&&this.ViewModel.SetCellValue(this.lstTotal[e][t],this.oColumns[t].DataFormat,"FLOAT",this.lstParents[e].Cells[t]);if(r<=this.LevelNo){let t=!1;if(0==this.AccountsWithOutTransactions&&0==this.lstTotal[e][2]&&0==this.lstTotal[e][3]&&0==this.lstTotal[e][4]&&0==this.lstTotal[e][5]&&(this.GrdRow--,t=!0,this.ViewModel.Data.Remove(this.lstParents[e])),!this.AccountsWithZeroBalance&&!t&&0==this.lstTotal[e][6]&&0==this.lstTotal[e][7]&&(this.GrdRow--,t=!0,this.ViewModel.Data.Remove(this.lstParents[e])),!t){let o=this.ViewModel.Data.indexOf(this.lstParents[e]);if(o>=0)if(!this.GroupTotalsAtEnd||this.DontShowSummaryGroupTotals&&!this.lstParents[e].IsExpanded)this.GroupTotalsSeperate&&-1!=this.colBalanceIndex&&(this.lstParents[e].Cells[this.GroupTotalIndex].Text=this.lstParents[e].Cells[this.colBalanceIndex].Text,this.lstParents[e].Cells[this.colBalanceIndex].Text=""),this.ViewModel.Data.Remove(this.lstParents[e]),this.ViewModel.Data.Insert(o,this.lstParents[e]);else{this.oSubTotal=this.NewReportRow(),this.oSubTotal.Type=w.QS.BalanceBF,this.oSubTotal.Parent=this.lstParents[e].Parent,this.oSubTotal.LevelNo=this.lstParents[e].LevelNo,this.oSubTotal.Cells[1].IsNormal=!1,this.oSubTotal.IsGroup=!0,this.oSubTotal.Visible=this.lstParents[e].Visible,this.oSubTotal.Cells[1].level=this.lstParents[e].LevelNo,this.oSubTotal.Cells[1].Text=this.lstParents[e].Cells[1].Text+" - Total ",this.oSubTotal.Cells[1].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[1].CellAppearance.Alignment=this.oColumns[1].DataAppearance.Alignment;for(let l=0;l<this.oColumns.length;l++)"FLOAT"==this.oColumns[l].ColumnType&&(this.oSubTotal.Cells[l].IsNormal=!1,this.oSubTotal.Cells[l].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[l].CellAppearance.Alignment=this.oColumns[l].DataAppearance.Alignment,this.ViewModel.SetCellValue(this.lstTotal[e][l],this.oColumns[l].DataFormat,"FLOAT",this.oSubTotal.Cells[l]));this.GroupTotalsSeperate&&-1!=this.colBalanceIndex&&(this.oSubTotal.Cells[this.GroupTotalIndex].IsNormal=!1,this.oSubTotal.Cells[this.GroupTotalIndex].CellAppearance=this.GrossTotalAppearance_Data.Clone(),this.oSubTotal.Cells[this.GroupTotalIndex].CellAppearance.Alignment=this.oColumns[this.GroupTotalIndex].DataAppearance.Alignment,this.oSubTotal.Cells[this.GroupTotalIndex].Text=this.oSubTotal.Cells[this.colBalanceIndex].Text,this.oSubTotal.Cells[this.colBalanceIndex].Text=""),this.GrdRow++,this.ViewModel.addRow(this.oSubTotal)}}}this.lstParents.RemoveAt(e),this.lstTotal.RemoveAt(e)}}}}}]);