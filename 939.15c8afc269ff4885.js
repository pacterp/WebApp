"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[939],{93320:(ae,O,u)=>{u.r(O),u.d(O,{AddEditOpportunity:()=>ie});var w=u(74523),d=u(9659),a=u(66148),f=u(76962),E=u(76199),M=u(47044),x=u(41520),P=u(26419),c=u(5349),D=u(81322),A=u(11311),F=u(92014),C=u(6532),p=u(4884),b=u(1077),N=u(53724),j=u(51499),J=u(75965),B=u(54786),G=u(89621),g=u(35789),y=u(90673),R=u(12112),S=u(79352),U=u(35147),k=u(22804);class Q extends E.g{constructor(i){super(),this.ButtonClick=new g.Yk,this.ds=[],this.dr1=[],this.Date=new p.Lc(0),this.Status=new c.y$(0),this.Reason=new c.y$(0),this.EstimatedRevenue=new C.Dw(0),this.Remark=new C.Dw(0),this.oparent=i,this.ButtonClick.Subscribe(this,"OnSave"),i.ScreenObject.Data.Tables[0].forEach(e=>{"24320"==e.CostCenterColID.toString()&&(this.Status.Label=e.ResourceData.toString()),"25403"==e.CostCenterColID.toString()&&(this.EstimatedRevenue.Label=e.ResourceData.toString()),"25405"==e.CostCenterColID.toString()&&(this.Date.Label=e.ResourceData.toString()),"53583"==e.CostCenterColID.toString()&&(this.Reason.Label=e.ResourceData.toString(),this.Reason.Mandatory=(0,f.yG0)(e.IsMandatory)),"25953"==e.CostCenterColID.toString()&&(this.Remark.Label=e.ResourceData.toString(),this.Remark.Mandatory=(0,f.yG0)(e.IsMandatory))});let t=d.d.admin.GetLookupDataByType(0);if(this.dr1=t.Tables[1].filter(e=>19==e.LookupType),this.dr1.length>0){for(let e=0;e<this.dr1.length;e++)this.Reason.Items.push(c._p.ComboBoxItems_2(this.dr1[e].Name.toString(),this.dr1[e].NodeID.toString()));this.Reason.SelectedValue=this.Reason.Items[0].Value.toString()}if(null==i.ds)return;this.drr=i.ds.Tables[0].filter(e=>"CloseStatus"==e.Name);let s=null;if(this.drr.length>0&&""!=this.drr[0].Value.toString()&&(s=this.drr[0].Value.toString().split(";")),null!=s&&s.length>0)for(let e=0;e<s.length;e++)for(let m=0;e<i.Status.Items.length;m++){let h=i.Status.Items[m];if(s[e]==h.Value){this.Status.Items.push(h);break}}this.Status.Items.length>0&&(this.Status.SelectedValue=this.Status.Items[0].Value),this.Title=this.DisplayName=d.d.GetResource("CRMOpportunity_CloseOpportunity")}OnSave(i){"Cancel"==i?d.d.page.HideDialog(this.PopUpGUID):"OK"==i&&(null!=this.oparent.Status&&this.oparent.Status.Mandatory&&a.J0.StringIsNullOrEmpty(this.Status.SelectedValue)?(this.DisplayMessage=d.d.GetResource("Select")+"  Status",this.MessageVisibility=!0):null!=this.Reason&&this.Reason.Mandatory&&a.J0.StringIsNullOrEmpty(this.Reason.SelectedValue)?(this.DisplayMessage=d.d.GetResource("Select")+" Status",this.MessageVisibility=!0):null!=this.oparent.EstimatedRevenue&&this.oparent.EstimatedRevenue.Mandatory&&a.J0.StringIsNullOrEmpty(this.EstimatedRevenue.Text)?(this.DisplayMessage=" Please Enter Revenue",this.MessageVisibility=!0):(this.oparent.Status.SelectedValue=this.Status.SelectedValue,this.oparent.EstimateRevenceData(this.EstimatedRevenue.Text,Date.Today(),this.Reason.SelectedValue),d.d.page.HideDialog(this.PopUpGUID)))}}var H=u(89417),o=u(41360),W=u(45319),X=u(73955);let $=(()=>{class T{constructor(){this.group=new H.gE({})}ngOnInit(){}static{this.\u0275fac=function(s){return new(s||T)}}static{this.\u0275cmp=o.VBU({type:T,selectors:[["app-estimate-revenue"]],standalone:!1,decls:44,vars:13,consts:[[1,"master-screen"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","row","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(s,e){1&s&&(o.j41(0,"div",0),o.EFF(1,"\n    "),o.j41(2,"div",1),o.EFF(3,"\n        "),o.j41(4,"div",2),o.EFF(5,"\n            "),o.eu8(6,3),o.EFF(7,"\n        "),o.k0s(),o.EFF(8,"\n        "),o.j41(9,"div",2),o.EFF(10,"\n            "),o.eu8(11,3),o.EFF(12,"\n        "),o.k0s(),o.EFF(13,"\n        "),o.j41(14,"div",2),o.EFF(15,"\n            "),o.eu8(16,3),o.EFF(17,"\n        "),o.k0s(),o.EFF(18,"\n        "),o.j41(19,"div",2),o.EFF(20,"\n            "),o.eu8(21,3),o.EFF(22,"\n        "),o.k0s(),o.EFF(23,"\n        "),o.j41(24,"div",2),o.EFF(25,"\n            "),o.eu8(26,3),o.EFF(27,"\n        "),o.k0s(),o.EFF(28,"\n         \n  "),o.k0s(),o.EFF(29,"\n  "),o.j41(30,"div",4),o.EFF(31,"\n    "),o.j41(32,"div"),o.EFF(33,"\n        "),o.j41(34,"button",5),o.bIt("click",function(){return e.obj.OnSave("OK")}),o.EFF(35,"Ok"),o.k0s(),o.EFF(36,"\n        "),o.j41(37,"button",6),o.bIt("click",function(){return e.obj.OnSave("Cancel")}),o.nrm(38,"i",7),o.EFF(39),o.nI1(40,"translate"),o.k0s(),o.EFF(41,"\n    "),o.k0s(),o.EFF(42,"      \n  "),o.k0s(),o.EFF(43,"\n"),o.k0s()),2&s&&(o.R7$(6),o.Y8G("obj",e.obj.Status)("group",e.group),o.R7$(5),o.Y8G("obj",e.obj.Date)("group",e.group),o.R7$(5),o.Y8G("obj",e.obj.EstimatedRevenue)("group",e.group),o.R7$(5),o.Y8G("obj",e.obj.Reason)("group",e.group),o.R7$(5),o.Y8G("obj",e.obj.Remark)("group",e.group),o.R7$(13),o.JRh(o.bMT(40,11,"Cancel")))},dependencies:[W._,X.D9],encapsulation:2})}}return T})();var K=u(45444),I=u(43715),V=u(95589),Y=u(25360),z=u(35235),Z=u(19439),q=u(98936),_=u(86084),ee=u(19387),te=u(79609),se=u(59744),v=u(75961),L=u(3955);class ie extends E.g{get ReportInfoVisibility(){return this._ReportInfoVisibility}set ReportInfoVisibility(i){i!=this._ReportInfoVisibility&&(this._ReportInfoVisibility=i)}OnAddContact(){this.Contact=new M.Z,this.Contact.QuickAddDContactViewModel_1(this)}OnAddNote(){this.Note=new x.AddNoteViewModel,this.Note.AddNoteViewModel_2(this)}OnAddAttachment(){this.Attachment=new P.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this)}constructor(i,t,s){super(),this.PrintVisible=!1,this.PrintViewVisible=!1,this.AssignVisiblity=!1,this.Owner=new C.Dw(26691),this.btnHistoryVisible=!1,this.BtnApprove=new D.v,this.IsClone=!1,this.lstEventCtrls=[],this.ReportsList=[],this.dsData=null,this._ReportInfoVisibility=!0,this.dt=null,this.Opp=new te.Y,this.OppID=0,this.ButtonCopy=new D.v,this.ScreenObject=new F.ControlGenerator,this.ButtonEnable=!0,this.CloseVisible=!1,this.Salutation=new c.y$(26670),this.FirstName=new C.Dw(26661),this.MiddleName=new C.Dw(26662),this.LastName=new C.Dw(26663),this.JobTitle=new C.Dw(26664),this.Phone1=new C.Dw(26665),this.Phone2=new C.Dw(26666),this.Email=new C.Dw(26667),this.Fax=new C.Dw(26668),this.Department=new C.Dw(26669),this.Code=new C.s3(24317),this.Date=new p.Lc(24319),this.Status=new c.y$(24320),this.Subject=new C.Dw(24318),this.Company=new b.gH(25400),this.AssignedTo=new C.Dw(27252),this.Campaign=new c.y$(25399),this.Mode=new c.y$(26639),this.Lead=new b.y$(25401),this.ContactCombo=new c.y$(25402),this.EstimateRow=0,this.EstimateColumn=0,this.EstimateColumnSpan=1,this.EstimatedRevenue=new C.Dw(25403),this.Currency=new b.y$(25404),this.EstimatedCloseDate=new p.P6(25405),this.Probability=new b.y$(25406),this.Rating=new b.y$(25407),this.CloseDate=new C.Dw(25408),this.Document=new c.y$(0),this.Activity=new c.y$(0),this.Address1=new C.Dw(26679),this.Address2=new C.Dw(26680),this.Address3=new C.Dw(26681),this.City=new C.Dw(26682),this.State=new C.Dw(26683),this.Zip=new C.Dw(26684),this.Country=new c.y$(26685),this.ActivityGridData=[],this.ActivityColumnSource=new Array,this.ContactPersonColID=0,this.Ret=0,this.CostCenterID=0,this.NodeID=0,this.NextPreviousVisibility=!0,this.ContactVisibility=!1,this.PrimaryVisibility=!1,this.ParentId=1,this.LeadModeID=0,this.LeadMode=0,this.IsGroup=!1,this.dtStatusProbability=null,this.dvContacts=null,this.dvContactsTable=null,this.lstModeDetails=new Array,this.ErrorMessage="Missing Report Parameter ' ",this.ParentId=t,this.IsGroup=s,this.ClassName="AddEditOpportunity",this.ButtonReport=new D.v,this.Opp.SelectedNodeID=this.ParentId,this.CostCenterID=89,this.NodeID=i,this.OppID=i;let e=d.d.admin.GetLookupDataByType(0);if(this.BtnApprove.Visible=!1,this.LeadsProduct=new J.z(this,89),this.ViewFeedback=new se.T(this),d.d.SessionManager.IsWebApplication&&(this.Feedback=new j.e(this.ViewFeedback)),this.ViewContacts=new K.W(this),this.PrimaryContact=new M.Z,this.PrimaryContact.QuickAddDContactViewModel_1(this),this.PrimaryContact.IsPrimaryContact=!0,this.ViewActivities=new A.ViewActivitiesViewModel(this),this.Activities=new N.ActivitiesViewModel(this,!1),this.ViewActivities.Activities=this.Activities,this.ViewNotes=new B.i(this),this.ViewAttachments=new G.ViewAttachmentViewModel(this),this.ViewAssignHistroy=new ee.X(this),this.ScreenObject.LoadScreen_2(this,89),this.EstimateRow=this.EstimatedRevenue.Row,this.EstimateColumn=this.EstimatedRevenue.Column,this.EstimateColumnSpan=this.EstimatedRevenue.ColumnSpan,this.Mode.Items.push(c._p.ComboBoxItems_2("New","0")),this.Mode.Items.push(c._p.ComboBoxItems_2("Converted","4")),null!=this.ScreenObject.Data&&this.ScreenObject.Data.Tables[4].length>0){let n=this.ScreenObject.Data.Tables[4].filter(l=>"ActContactPerson"==l.Name);n.length>0&&!a.J0.IsEmpty(n[0].Value)&&(this.ContactPersonColID=parseInt(n[0].Value)),n=this.ScreenObject.Data.Tables[4].filter(l=>"CapsLock"==l.Name),n.length>0&&(0,f.yG0)(n[0].Value)&&(this.Company.IsAllCaps=!0),n=this.ScreenObject.Data.Tables[4].filter(l=>"CapsToFirstLetter"==l.Name),n.length>0&&(0,f.yG0)(n[0].Value)&&(this.Company.IsFirstLetterCaps=!0),n=this.ScreenObject.Data.Tables[4].filter(l=>"AccountLinkDimension"==l.Name),n.length>0&&!a.J0.IsEmpty(n[0].Value)&&(this.Mode.Items.push(c._p.ComboBoxItems_2("Account","2")),this.lstModeDetails.push(c._p.ComboBoxItems_2(n[0].Value.toString(),"Account"))),n=this.ScreenObject.Data.Tables[4].filter(l=>"CustomerInMode"==l.Name),n.length>0&&(0,f.yG0)(n[0].Value)&&(this.Mode.Items.push(c._p.ComboBoxItems_2("Customer","3")),this.lstModeDetails.push(c._p.ComboBoxItems_2(n[0].Value.toString(),"Customer"))),n=this.ScreenObject.Data.Tables[4].filter(l=>"HidePrimaryContact"==l.Name),this.PrimaryVisibility=n.length>0&&!(0,f.yG0)(n[0].Value)}this.Company.Code.Visible=!1,this.Company.TextVisible=!0,this.ScreenObject.Data.Tables.length>5&&(this.dtStatusProbability=this.ScreenObject.Data.Tables[6]),this.Lead.SelectionChangedCommand.Subscribe(this,"onClickLeadCommand"),this.Mode.SelectionChangedCommand.Subscribe(this,"OnModeChange"),this.Status.SelectionChangedCommand.Subscribe(this,"onStatusSelectionChanged"),this.ContactCombo.SelectionChangedCommand.Subscribe(this,"onContactSelectionChanged"),this.EstimatedRevenue.Enable=!1,this.Company.Code.SelectionChangedCommand.Subscribe(this,"onCompanySelectionChanged");let h,m=e.Tables[1].filter(n=>56==n.LookupType);m.length>0&&c.y$.FillComboWithDefaultOption(m,this.Status),m=e.Tables[1].filter(n=>20==n.LookupType),m.length>0&&c.y$.FillComboWithDefaultOption(m,this.Salutation),m=e.Tables[1].filter(n=>16==n.LookupType);for(let n=0;n<this.ScreenObject.CustomTab.Pages.length;n++)if("Address Details"==this.ScreenObject.CustomTab.Pages[n].Name.toString())for(let l=0;l<this.ScreenObject.CustomTab.Pages[n].Fields.length;l++)if(26685==this.ScreenObject.CustomTab.Pages[n].Fields[l].DBColumnID&&m.length>0){for(let r=0;r<m.length;r++)this.ScreenObject.CustomTab.Pages[n].Fields[l].Items.push(c._p.ComboBoxItems_2(m[r].Name.toString(),m[r].NodeID.toString()));this.ScreenObject.CustomTab.Pages[n].Fields[l].SelectedValue=this.ScreenObject.CustomTab.Pages[n].Fields[l].Items[0].Value}if(this.ContactCombo.Items.push(c._p.ComboBoxItems_2("New","0")),this.ContactCombo.SelectedValue="0",this.Campaign.Items.push(c._p.ComboBoxItems_2("Default","1")),this.Campaign.SelectedValue="1",null!=this.dt&&this.dt.Tables.length>1&&this.dt.Tables[1].length>0){for(let n=0;n<this.dt.Tables[1].length;n++)this.Document.Items.push(c._p.ComboBoxItems_2(this.dt.Tables[1][n].DOCNAME.toString(),this.dt.Tables[1][n].DOCID.toString()));this.Document.SelectedValue="-1"}this.Activity.Items.push(c._p.ComboBoxItems_2("All","-1")),this.Activity.Items.push(c._p.ComboBoxItems_2("Open","1")),this.Activity.Items.push(c._p.ComboBoxItems_2("Closed","2")),this.Activity.SelectedValue="1",this.loadtabs(),this.ButtonSave=new D.v,this.ButtonEmail=new D.v,0==i&&(d.d.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=d.d.SessionManager.IsActionAssigned(89,"Create"):this.ButtonSave.Enable=d.d.SessionManager.IsActionAssigned(89,"Create"),this.ButtonCopy.Visible=!1),0!=i?d.d.SessionManager.HideUnathorizedAccess?this.ButtonEmail.Visible=d.d.SessionManager.IsActionAssigned(this.CostCenterID,"Email"):this.ButtonEmail.Enable=d.d.SessionManager.IsActionAssigned(this.CostCenterID,"Email"):(d.d.SessionManager.HideUnathorizedAccess?this.ButtonSave.Visible=d.d.SessionManager.IsActionAssigned(89,"Update"):this.ButtonSave.Enable=d.d.SessionManager.IsActionAssigned(89,"Update"),d.d.SessionManager.HideUnathorizedAccess?this.ButtonCopy.Visible=d.d.SessionManager.IsActionAssigned(this.CostCenterID,"Clone"):this.ButtonCopy.Enable=d.d.SessionManager.IsActionAssigned(this.CostCenterID,"Clone")),this.ScreenObject.InitAutoCode(this.ScreenObject.Data.Tables[7],!1),this.AutoGenerateCode(),this.ds=[],0==i?(this.DisplayName=d.d.GetResource("CRMOpportunity_AddOpportunity"),this.Opp.GUID="Guid",this.GetCurrency(),this.NextPreviousVisibility=!1,this.Owner.Text=d.d.SessionManager.UserName,this.Lead.CCID=86,this.Currency.CCID=12,this.Lead.TypeID=this.Currency.TypeID=1,this.Lead.SelectedValue=this.Currency.SelectedValue=1,this.CloseDate.IsReadOnly=!0,this.CloseVisible=!1,this.OnModeChange(null)):(this.Lead.CCID=86,this.Currency.CCID=12,this.Lead.TypeID=this.Currency.TypeID=1,this.Lead.SelectedValue=this.Currency.SelectedValue=1,this.DisplayName=d.d.GetResource("CRMOpportunity_EditOpportunity"),this.LoadData(i),this.CloseDate.IsReadOnly=!0,this.PrintVisible=!0,this.PrintViewVisible=!0,this.CloseVisible=!0),this.Title=this.DisplayName,this.PrimaryContact.Visiblebtns=!1,this.ContactVisibility=!1,this.AssignedTo.Enable=!1,this.ScreenObject.CheckEstimateRevenueMapping(this.LeadsProduct.DestProductValueMapping),this.ScreenObject.HeaderFields.sort((n,l)=>n.Row>l.Row||n.Row==l.Row&&n.Column>l.Column?1:-1),this.lstEventCtrls.push(this.Mode.DBColumnID),this.lstEventCtrls.push(this.Status.DBColumnID),this.lstEventCtrls.push(this.ContactCombo.DBColumnID);for(let n=0;n<this.ScreenObject.StaticFields.length;n++)h=this.ScreenObject.StaticFields[n],h&&null!=h.ToolTipFooterTitle&&null!=h.KeyTip&&!this.lstEventCtrls.Contains(h.DBColumnID)?this.SetControlEvent(h):this.OppID>0&&h&&null!=h.ToolTipFooterTitle&&null!=h.KeyTip&&19==h.Mode&&this.OnGetExtFunctionData(h);if(null!=this.ScreenObject.HeaderFields)for(let n=0;n<this.ScreenObject.HeaderFields.length;n++)h=this.ScreenObject.HeaderFields[n],h&&null!=h.ToolTipFooterTitle&&null!=h.KeyTip&&!this.lstEventCtrls.Contains(h.DBColumnID)?this.SetControlEvent(h):this.OppID>0&&h&&null!=h.ToolTipFooterTitle&&null!=h.KeyTip&&19==h.Mode&&this.OnGetExtFunctionData(h);this.ScreenObject.CustomTab.Pages.forEach(n=>{h=n.Fields.find(l=>l instanceof g.MI&&null!=l.ToolTipFooterTitle),h&&null!=h.ToolTipFooterTitle&&null!=h.KeyTip&&!this.lstEventCtrls.Contains(h.DBColumnID)?this.SetControlEvent(h):this.OppID>0&&h&&null!=h.ToolTipFooterTitle&&null!=h.KeyTip&&19==h.Mode&&this.OnGetExtFunctionData(h)}),this.ReportView(),d.d.SessionManager.Preferences.ContainsKey("isYearMonthWiseFolder")&&"FALSE"==d.d.SessionManager.Preferences.isYearMonthWiseFolder.toUpperCase()&&(this.ScreenObject.YearMonth="")}SetControlEvent(i){try{i instanceof C.Dw?i.LostFocusCommand.Subscribe(this,"OnGetExtFunctionData"):i instanceof c.y$?i.SelectionChangedCommand.Subscribe(this,"OnGetExtFunctionData"):i instanceof y.I||i instanceof C.L6?i.LostFocusCommand.Subscribe(this,"OnGetExtFunctionData"):i instanceof b.y$?i.OnPactListBoxValueChanged.Subscribe(this,"OnGetExtFunctionData"):(i instanceof p.Lc||i instanceof p.P6||i instanceof p.C_)&&i.SelectedDateChanged.Subscribe(this,"OnGetExtFunctionData"),this.OppID>0&&19==i.Mode&&this.OnGetExtFunctionData(i)}catch{}}OnGetExtFunctionData(i){null!=i.ToolTipFooterTitle&&!a.J0.IsEmpty(i.KeyTip)&&"lostfocus"==i.KeyTip.toLowerCase()&&this.ScreenObject.ValidateExtData(i,null,!0)&&this.ScreenObject.GetExternalFuncData(i.Mode,this.OppID,i.ToolTipFooterTitle,i.ToolTipFooterDescription,i.ToolTipDescription,null,null)}onStatusSelectionChanged(i){if(""!=this.Status.SelectedValue){let t=this.dtStatusProbability.filter(s=>s.Status==this.Status.SelectedValue);t.length>0?(this.Probability.SelectedValue=parseInt(t[0].Probability.toString()),this.Probability.Enable=!1):this.Probability.Enable=!0}}onCompanySelectionChanged(i){if(this.EnableControls(!0),this.ContactCombo.Items.Clear(),"3"==this.Mode.SelectedValue){if(0!=this.Company.Code.SelectedValue){let t=new v.C;t.CustomerID=this.Company.Code.SelectedValue;let s=t.GetCustomerDetails();if(null!=s&&s.Tables[0].length>0){if(this.ViewContacts.ContactsListObj.Clear(),this.ContactCombo.Items.push(c._p.ComboBoxItems_2("New","0")),this.ContactCombo.SelectedValue="0",s.Tables.length>5&&s.Tables[5].length>0)for(let e=0;e<s.Tables[5].length;e++)!a.J0.IsEmpty(s.Tables[5][e].ContactID)&&!a.J0.IsEmpty(s.Tables[5][e].FirstName)&&this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(s.Tables[5][e].FirstName),a.J0.String(s.Tables[5][e].ContactID)));if(s.Tables.length>2&&s.Tables[2].length>0){for(let e=0;e<s.Tables[2].length;e++)!a.J0.IsEmpty(s.Tables[2][e].ContactID)&&!a.J0.IsEmpty(s.Tables[2][e].FirstName)&&this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(s.Tables[2][e].FirstName),a.J0.String(s.Tables[2][e].ContactID)));this.dvContacts=s.Tables[2],this.dvContactsTable=this.dvContacts,s.Tables.length>5&&s.Tables[5].length>0&&this.dvContactsTable.AddRange(s.Tables[5])}}this.Company.Code.SelectedValue!=this.Company.Code.PreviousSelectedValue&&(this.Company.Code.PreviousSelectedValue=this.Company.Code.SelectedValue,this.ScreenObject.OnGetReference(this.Company.Code))}}else if("2"==this.Mode.SelectedValue){if(0!=this.Company.Code.SelectedValue){let t=d.d.accounting.GetAccountDetails(this.Company.Code.SelectedValue);if(null!=t&&t.Tables[0].length>0){if(this.ContactCombo.Items.push(c._p.ComboBoxItems_2("New","0")),this.ContactCombo.SelectedValue="0",t.Tables.length>8&&t.Tables[8].length>0)for(let s=0;s<t.Tables[8].length;s++)this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(t.Tables[8][s].FirstName),a.J0.String(t.Tables[8][s].ContactID)));if(t.Tables.length>2&&t.Tables[2].length>0){for(let s=0;s<t.Tables[2].length;s++)this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(t.Tables[2][s].FirstName),a.J0.String(t.Tables[2][s].ContactID)));this.dvContacts=t.Tables[2],this.dvContactsTable=this.dvContacts,t.Tables.length>8&&t.Tables[8].length>0&&this.dvContactsTable.AddRange(t.Tables[8])}}if(this.Company.Code.SelectedValue!=this.Company.Code.PreviousSelectedValue){let s=this.ScreenObject.Data.Tables[0].filter(e=>e.LocalReference==this.Company.Code.CCID);s.length>0&&this.Company.Code.SetLocalReference(s),this.Company.Code.PreviousSelectedValue=this.Company.Code.SelectedValue,this.ScreenObject.OnGetReference(this.Company.Code)}}}else this.ViewContacts.isPick=!1}onContactSelectionChanged(i){this.EnableControls(!0),null!=this.dvContacts&&null!=this.ContactCombo.SelectedValue&&"0"!=this.ContactCombo.SelectedValue&&(this.dvContacts=this.dvContactsTable.filter(t=>t.ContactID==this.ContactCombo.SelectedValue),this.dvContacts.length>0&&(this.EnableControls(!1),this.FirstName.Visible&&(this.FirstName.Text=this.dvContacts[0].FirstName.toString()),this.LastName.Visible&&(this.LastName.Text=this.dvContacts[0].LastName.toString()),this.MiddleName.Visible&&(this.MiddleName.Text=this.dvContacts[0].MiddleName.toString()),this.Salutation.Visible&&(this.Salutation.SelectedValue=this.dvContacts[0].SalutationID.toString()),this.JobTitle.Visible&&(this.JobTitle.Text=this.dvContacts[0].JobTitle.toString()),this.Phone1.Visible&&(this.Phone1.Text=this.dvContacts[0].Phone1.toString()),this.Phone2.Visible&&(this.Phone2.Text=this.dvContacts[0].Phone2.toString()),this.Email.Visible&&(this.Email.Text=this.dvContacts[0].Email1.toString()),this.Fax.Visible&&(this.Fax.Text=this.dvContacts[0].Fax.toString()),this.Department.Visible&&(this.Department.Text=this.dvContacts[0].Department.toString())))}GetRecords(i){this.ButtonSave.Enable||(this.ButtonSave.Enable=!0);let t=0,s=!1;"NEXT"==i.toString().toUpperCase()?s=!0:"PREVIOUS"==i.toString().toUpperCase()&&(s=!1);let e=d.d.common.GetNextPreviousRecords(this.CostCenterID,this.OppID,s,0,this.IsGroup?1:0);if(null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&(t=parseInt(e.Tables[0][0][e.Columns[0][0]]),t>0)){this.Mode.Items.Clear(),this.lstModeDetails.Clear(),this.Mode.Items.push(c._p.ComboBoxItems_2("New","0")),this.Mode.Items.push(c._p.ComboBoxItems_2("Converted","4"));let m=this.ScreenObject.Data.Tables[4].filter(h=>"AccountLinkDimension"==h.Name);m.length>0&&""!=m[0].Value.toString()&&(this.Mode.Items.push(c._p.ComboBoxItems_2("Account","2")),this.lstModeDetails.push(c._p.ComboBoxItems_2(m[0].Value.toString(),"Account"))),m=this.ScreenObject.Data.Tables[4].filter(h=>"CustomerInMode"==h.Name),m.length>0&&(0,f.yG0)(m[0].Value)&&(this.Mode.Items.push(c._p.ComboBoxItems_2("Customer","3")),this.lstModeDetails.push(c._p.ComboBoxItems_2(m[0].Value.toString(),"Customer"))),this.LoadData(t)}}OnModeChange(i){if(this.ViewContacts.isPick=!1,"4"==this.Mode.SelectedValue&&this.Mode.Enable&&(this.Mode.SelectedValue="0"),"1"==this.Mode.SelectedValue){if(this.Company.Code.Visible=!0,this.Company.TextVisible=!1,this.lstModeDetails.filter(s=>"LEAD"==s.Value.toUpperCase()).length>0){let s=this.lstModeDetails.find(e=>"Lead"==e.Value);this.Company.Code.CCID=parseInt(s.Name),this.Company.Code.TypeID=1,this.Company.Label="Company",this.Company.Code.Refresh()}}else if("3"==this.Mode.SelectedValue){if(this.ViewContacts.isPick=!0,this.Company.Code.Visible=!0,this.Company.TextVisible=!1,this.lstModeDetails.filter(s=>"CUSTOMER"==s.Value.toUpperCase()).length>0){this.Company.Code.PreviousSelectedValue=0,this.Company.Code.DBColumnName="CustomerID",this.Company.Code.CCID=83,this.Company.Label="Customer";var t=this.lstModeDetails.find(s=>"Customer"==s.Value);this.Company.Code.TypeID=1,this.Company.Code.Refresh()}}else"2"==this.Mode.SelectedValue?(this.ViewContacts.isPick=!0,this.Company.Code.Visible=!0,this.Company.TextVisible=!1,this.lstModeDetails.filter(s=>"ACCOUNT"==s.Value.toUpperCase()).length>0&&(this.Company.Code.PreviousSelectedValue=0,this.Company.Code.DBColumnName="AccountID",this.Company.Code.CCID=2,this.Company.Label="Account",t=this.lstModeDetails.find(e=>"Account"==e.Value),this.Company.Code.TypeID=parseInt(t.Name),this.Company.Code.Refresh())):(this.Company.Label="Company",this.Company.Code.Visible=!1,this.Company.TextVisible=!0);this.Company.Visible||(this.Company.Label="",this.Company.Code.Visible=!1,this.Company.TextVisible=!1)}onClickLeadCommand(i){}onTabSelectionChanged(i){if(null!=this.ScreenObject.CustomTab.SelectedTab)if("Activities"==this.ScreenObject.CustomTab.SelectedTab.Name){this.ScreenObject.CustomTab.ColumnSpan=4,"0"==this.Mode.SelectedValue||"4"==this.Mode.SelectedValue?(this.Activities.CRMCustomer.Text=this.Company.Text,"4"==this.Mode.SelectedValue&&(2==this.LeadMode||3==this.LeadMode)&&(2==this.LeadMode?this.Activities.CRMCustomer.Code.CCID=2:3==this.LeadMode&&(this.Activities.CRMCustomer.Code.CCID=83),this.Activities.CRMCustomer.Code.TypeID=1,this.LeadModeID>0&&(this.Activities.CRMCustomer.Code.SelectedValue=this.LeadModeID),this.Activities.onCustomerSelectionChange("Customer"))):(this.Activities.CRMCustomer.Text=this.Company.Code.Text,null!=this.Activities.CRMCustomer&&(this.Activities.CRMCustomer.Code.CCID=this.Company.Code.CCID,this.Activities.CRMCustomer.Code.TypeID=this.Company.Code.TypeID),this.Activities.CRMCustomer.Text=this.Company.Code.Text,this.Activities.CRMCustomer.Code.SelectedValue=this.Company.Code.SelectedValue,this.Activities.onCustomerSelectionChange("Customer"));var t=this.ScreenObject.StaticFields.find(s=>s.DBColumnID==this.ContactPersonColID);null!=t&&t instanceof C.Dw&&(this.Activities.CRMContactPerson.Text=t.Text),this.Activities.Location.Text=d.d.SessionManager.LocationName,this.Activities.Location.Enable=!1,this.Activities.CRMCustomer.Enable=!1,this.Activities.AssignVisiblity=!1,this.PrimaryVisibility=!1,this.PrimaryContact.Visiblebtns=!1,this.ContactVisibility=!1}else"Contacts"==this.ScreenObject.CustomTab.SelectedTab.Name&&(this.PrimaryVisibility=!1,this.PrimaryContact.Visiblebtns=!0,this.ViewContacts.OnShowNewContact(null),1==this.Contact.isPopup&&(this.ContactVisibility=!1))}LoadData(i){if(this.OppID=i,this.ds=this.Opp.GetOpportunity(i),this.ScreenObject.IsAutoCode&&(this.Code.Enable=!1),null!=this.ds&&this.ds.Tables.length>1&&this.ds.Tables[1].length>0){if(this.ds.Columns[0].Contains("CDATE")&&""!=this.ds.Tables[0][0].CDATE.toString()&&(this.ScreenObject.YearMonth=d.d.SessionManager.Preferences.ContainsKey("isYearMonthWiseFolder")&&"TRUE"==d.d.SessionManager.Preferences.isYearMonthWiseFolder.toUpperCase()?new Date(this.ds.Tables[0][0].CDATE.toString()).ToString("yyyyMMM"):""),a.J0.IsEmpty(this.ds.Tables[1][0].Code)||(this.Code.Text=this.ds.Tables[1][0].Code.toString()),a.J0.IsEmpty(this.ds.Tables[1][0].Subject)||(this.Subject.Text=this.ds.Tables[1][0].Subject.toString()),a.J0.IsEmpty(this.ds.Tables[1][0].Date)||(this.Date.Date=a.J0.ParseDate(this.ds.Tables[1][0].Date.toString())),a.J0.IsEmpty(this.ds.Tables[1][0].StatusID)||(this.Status.SelectedValue=this.ds.Tables[1][0].StatusID.toString()),a.J0.IsEmpty(this.ds.Tables[1][0].GUID)||(this.Opp.GUID=a.J0.String(this.ds.Tables[1][0].GUID)),a.J0.IsEmpty(this.ds.Tables[1][0].LeadID)||(this.Lead.SelectedValue=parseInt(this.ds.Tables[1][0].LeadID.toString())),a.J0.IsEmpty(this.ds.Tables[1][0].CampaignID)||(this.Campaign.SelectedValue=this.ds.Tables[1][0].CampaignID.toString()),a.J0.IsEmpty(this.ds.Tables[1][0].AssignedTo)||(this.AssignedTo.Text=this.ds.Tables[1][0].AssignedTo.toString()),a.J0.IsEmpty(this.ds.Tables[1][0].CreatedBy.ToString())||(this.Owner.Text=this.ds.Tables[1][0].CreatedBy.ToString()),this.EstimatedRevenue.Text="0",a.J0.IsEmpty(this.ds.Tables[1][0].EstimatedRevenue)||(this.EstimatedRevenue.Text=a.J0.Double(this.ds.Tables[1][0].EstimatedRevenue).ToString("N2")),a.J0.IsEmpty(this.ds.Tables[1][0].CurrencyID)||(this.Currency.SelectedValue=parseInt(this.ds.Tables[1][0].CurrencyID.toString())),a.J0.IsEmpty(this.ds.Tables[1][0].EstimatedCloseDate)||(this.EstimatedCloseDate.Date=a.J0.ParseDate(this.ds.Tables[1][0].EstimatedCloseDate.toString())),a.J0.IsEmpty(this.ds.Tables[1][0].ProbabilityLookUpID)||(this.Probability.SelectedValue=parseInt(this.ds.Tables[1][0].ProbabilityLookUpID.toString())),a.J0.IsEmpty(this.ds.Tables[1][0].ReasonLookUpID)||(this.Reason=this.ds.Tables[1][0].ReasonLookUpID.toString()),a.J0.IsEmpty(this.ds.Tables[1][0].RatingLookUpID)||(this.Rating.SelectedValue=parseInt(this.ds.Tables[1][0].RatingLookUpID.toString())),a.J0.IsEmpty(this.ds.Tables[1][0].CloseDate)||(this.CloseDate.Text=a.J0.ParseDate(this.ds.Tables[1][0].CloseDate.toString()).ToString(d.d.SessionManager.Preferences["Date Format"].toString()),this.CloseDate.Tag=a.J0.ParseDate(this.ds.Tables[1][0].CloseDate.toString()).toString()),a.J0.IsEmpty(this.ds.Tables[1][0].Mode)||("4"==this.ds.Tables[1][0].Mode.toString()?(this.Lead.Enable=!1,this.Mode.Enable=!1,a.J0.IsEmpty(this.ds.Tables[1][0].LeadMode)||(this.LeadMode=parseInt(this.ds.Tables[1][0].LeadMode.toString()),a.J0.IsEmpty(this.ds.Tables[1][0].CustomerID)||(this.LeadModeID=parseInt(this.ds.Tables[1][0].CustomerID.toString())))):(this.Lead.Enable=!0,this.Mode.Enable=!0),this.Mode.SelectedValue=this.ds.Tables[1][0].Mode.toString()),this.ds.Tables.length>0&&this.ds.Tables[0].length>0){let t=this.ds.Tables[0].filter(e=>"StatusReadOnly"==e.Name),s=null;if(t.length>0&&!a.J0.IsEmpty(t[0].Value)&&(s=t[0].Value.toString().split(";")),null!=s&&s.length>0)for(let e=0;e<s.length;e++)if(s[e]==this.Status.SelectedValue){this.ButtonSave.Enable=!1;break}}if(a.J0.IsEmpty(this.ds.Tables[1][0].Company)||(this.OnModeChange(null),"0"==this.Mode.SelectedValue||"4"==this.Mode.SelectedValue?this.Company.Text=this.ds.Tables[1][0].Company.toString():(this.Company.Code.SelectedValue=parseInt(this.ds.Tables[1][0].SelectedModeID),this.ScreenObject.OnGetReference(this.Company.Code))),"3"==this.Mode.SelectedValue){this.ContactCombo.Items.Clear();let t=new v.C;t.CustomerID=this.Company.Code.SelectedValue;let s=t.GetCustomerDetails();if(null!=s&&s.Tables[0].length>0){if(this.ContactCombo.Items.push(c._p.ComboBoxItems_2("New","0")),this.ContactCombo.SelectedValue="0",s.Tables.length>5&&s.Tables[5].length>0)for(let e=0;e<s.Tables[5].length;e++)!a.J0.IsEmpty(s.Tables[5][e].ContactID)&&!a.J0.IsEmpty(s.Tables[5][e].FirstName)&&this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(s.Tables[5][e].FirstName),a.J0.String(s.Tables[5][e].ContactID)));if(s.Tables.length>1&&s.Tables[2].length>0){for(let e=0;e<s.Tables[2].length;e++)!a.J0.IsEmpty(s.Tables[2][e].ContactID)&&!a.J0.IsEmpty(s.Tables[2][e].FirstName)&&this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(s.Tables[2][e].FirstName),a.J0.String(s.Tables[2][e].ContactID)));this.dvContacts=s.Tables[2],this.dvContactsTable=this.dvContacts,s.Tables.length>5&&s.Tables[5].length>0&&this.dvContactsTable.AddRange(s.Tables[5])}}}if("2"==this.Mode.SelectedValue){this.ContactCombo.Items.Clear();let t=d.d.accounting.GetAccountDetails(this.Company.Code.SelectedValue);if(null!=t&&t.Tables[0].length>0){if(this.ContactCombo.Items.push(c._p.ComboBoxItems_2("New","0")),this.ContactCombo.SelectedValue="0",t.Tables.length>8&&t.Tables[8].length>0)for(let s=0;s<t.Tables[8].length;s++)!a.J0.IsEmpty(t.Tables[8][s].ContactID)&&!a.J0.IsEmpty(t.Tables[8][s].FirstName)&&this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(t.Tables[8][s].FirstName),a.J0.String(t.Tables[8][s].ContactID)));if(t.Tables.length>1&&t.Tables[2].length>0){for(let s=0;s<t.Tables[2].length;s++)!a.J0.IsEmpty(t.Tables[2][s].ContactID)&&!a.J0.IsEmpty(t.Tables[2][s].FirstName)&&this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(t.Tables[2][s].FirstName),a.J0.String(t.Tables[2][s].ContactID)));this.dvContacts=t.Tables[2],this.dvContactsTable=this.dvContacts,t.Tables.length>8&&t.Tables[8].length>0&&this.dvContactsTable.AddRange(t.Tables[8])}}}if("4"==this.Mode.SelectedValue&&(this.ContactCombo.Items.Clear(),this.ds.Tables.length>15)){if(this.ContactCombo.Items.push(c._p.ComboBoxItems_2("New","0")),this.ContactCombo.SelectedValue="0",this.ds.Tables[15].length>0)for(let t=0;t<this.ds.Tables[15].length;t++)!a.J0.IsEmpty(this.ds.Tables[15][t].ContactID)&&!a.J0.IsEmpty(this.ds.Tables[15][t].FirstName)&&this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(this.ds.Tables[15][t].FirstName),a.J0.String(this.ds.Tables[15][t].ContactID)));if(this.ds.Tables[14].length>0)for(let t=0;t<this.ds.Tables[14].length;t++)!a.J0.IsEmpty(this.ds.Tables[14][t].ContactID)&&!a.J0.IsEmpty(this.ds.Tables[14][t].FirstName)&&this.ContactCombo.Items.push(c._p.ComboBoxItems_2(a.J0.String(this.ds.Tables[14][t].FirstName),a.J0.String(this.ds.Tables[14][t].ContactID)));this.dvContacts=this.ds.Tables[14],this.dvContactsTable=this.dvContacts,this.ds.Tables[15].length>0&&this.dvContactsTable.AddRange(this.ds.Tables[15])}if(a.J0.IsEmpty(this.ds.Tables[1][0].ContactID.toString())||(this.ContactCombo.SelectedValue=this.ds.Tables[1][0].ContactID.toString()),null!=this.ContactCombo.SelectedValue&&"0"!=this.ContactCombo.SelectedValue&&this.EnableControls(!1),null==this.ContactCombo.GetselectedItem()&&this.ContactCombo.Items.length>1&&(this.ContactCombo.SelectedValue=this.ContactCombo.Items[1].Value),null!=this.ds&&this.ds.Tables.length>12&&this.ds.Tables[13].length>0&&(a.J0.IsEmpty(this.ds.Tables[13][0].FirstName.toString())||(this.FirstName.Text=this.ds.Tables[13][0].FirstName.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].MiddleName.toString())||(this.MiddleName.Text=this.ds.Tables[13][0].MiddleName.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].LastName.toString())||(this.LastName.Text=this.ds.Tables[13][0].LastName.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].SalutationID.toString())||(this.Salutation.SelectedValue=this.ds.Tables[13][0].SalutationID.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].JobTitle.toString())||(this.JobTitle.Text=this.ds.Tables[13][0].JobTitle.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].Company.toString())||(this.Company.Text=this.ds.Tables[13][0].Company.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].Phone1.toString())||(this.Phone1.Text=this.ds.Tables[13][0].Phone1.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].Phone2.toString())||(this.Phone2.Text=this.ds.Tables[13][0].Phone2.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].Email1.toString())||(this.Email.Text=this.ds.Tables[13][0].Email1.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].Fax.toString())||(this.Fax.Text=this.ds.Tables[13][0].Fax.toString()),a.J0.IsEmpty(this.ds.Tables[13][0].Department.toString())||(this.Department.Text=this.ds.Tables[13][0].Department.toString()),this.LoadCustomFieldsData(this.ds.Tables[13],this.ds.Columns[13])),this.IsClone){let t=new L.bT;t.push("4","ActivityID"),t.push("9","NoteID"),t.push("10","FileID"),t.push("11","CCCCDataID"),t.push("12","NodeID"),t.push("14","ContactID"),t.push("15","ContactID"),t.keys.forEach(s=>{let e={Key:s,Value:t[s]};if(this.ds.Tables.length>e.Key&&this.ds.Tables.length>e.Key)for(let m=0;m<this.ds.Tables[e.Key].length;m++)this.ds.Tables[e.Key][m][e.Value.toString()]=0,this.ds.Tables[e.Key][m].GUID=a.J0.NewGuid()})}if(null!=this.ds&&this.ds.Tables.length>4&&this.ViewActivities.LoadActivityData(this.ds.Tables[4]),null!=this.ds&&this.ds.Tables.length>5&&this.LeadsProduct.LoadProductData(this.ds.Tables[5],this.ds.Columns[5]),null!=this.ds&&this.ds.Tables.length>8&&this.ScreenObject.LoadCustomFieldsData(this.ds.Tables[8]),null!=this.ds&&this.ds.Tables.length>9&&this.ViewNotes.LoadNotes(this.ds.Tables[9]),null!=this.ds&&this.ds.Tables.length>10&&this.ViewAttachments.LoadAttachments(this.ds.Tables[10]),null!=this.ds&&this.ds.Tables.length>11&&this.ScreenObject.LoadCustomFieldsCCData(this.ds.Tables[11]),null!=this.ds&&this.ds.Tables.length>12&&this.ViewFeedback.LoadData(this.ds.Tables[12]),null!=this.PrimaryContact&&this.PrimaryContact.LoadContacts(this.ds.Tables[14]),this.ViewContacts.LoadContacts(this.ds.Tables[15],this.ds.Columns[15]),this.ViewAssignHistroy.LoadHistroy_1(89,this.OppID),this.ds.Columns[1].Contains("WorkFlowID")&&this.ds.Tables[0].length>0&&!a.J0.IsEmpty(this.ds.Tables[1][0].WorkFlowID)&&parseInt(this.ds.Tables[1][0].WorkFlowID.toString())>0&&(this.Opp.WID=parseInt(this.ds.Tables[1][0].WorkFlowID.toString()),this.btnHistoryVisible=!0,("1002"==this.Status.SelectedValue||"1001"==this.Status.SelectedValue||"1003"==this.Status.SelectedValue)&&(this.Status.IsReadOnly=!0),this.ds.Tables.length>18&&this.ds.Columns[19].Contains("WorkFlowLevel"))){""!=this.ds.Tables[18][0].canEdit.toString()&&(0,f.yG0)(this.ds.Tables[18][0].canEdit.toString())&&(this.ButtonSave.Visible=!0),""!=this.ds.Tables[18][0].canApprove.toString()&&(0,f.yG0)(this.ds.Tables[18][0].canApprove.toString())&&(this.BtnApprove.Visible=!0,this.ButtonSave.Visible=!1);let t,s,e=0;t=this.ds.Tables[20],s=this.ds.Tables[19],""!=this.ds.Tables[1][0].WorkFlowLevel.toString()&&(e=parseInt(this.ds.Tables[1][0].WorkFlowLevel.toString())),this.ScreenObject.GetWorkFlowLevels(e,s,t)}this.LoadReport()}}LoadCustomFieldsData(i,t){if(null!=i&&i.length>0)try{this.ScreenObject.CustomTab.Pages.forEach(s=>{s.Fields.forEach(e=>{e instanceof g.MI&&null!=e.DBColumnName&&t.Contains(e.DBColumnName)&&(e instanceof C.Dw?e.Text=a.J0.String(i[0][e.DBColumnName]).Replace("&amp","&").Replace("''","'"):e instanceof C.hV?e.Text=a.J0.String(i[0][e.DBColumnName]).Replace("&amp;","&").Replace("''","'"):e instanceof c.y$?e.SelectedValue="Gender"==e.DBColumnName.toString()?"Female"==i[0][e.DBColumnName].toString()?"2":"1":a.J0.String(i[0][e.DBColumnName]).Replace("&amp;","&").Replace("''","'"):e instanceof p.Lc?a.J0.isValidDate(i[0][e.DBColumnName])&&(e.Date=a.J0.ParseDate(i[0][e.DBColumnName])):e instanceof y.I?e.Text=i[0][e.DBColumnName].toString():e instanceof b.y$&&a.J0.IsNum(i[0][e.DBColumnName])&&(e.SelectedValue=parseInt(i[0][e.DBColumnName])))})})}catch(s){Logger.ErrorLog("AddEditLeads::  LoadCustomFieldsData : "+s.stack)}}EnableControls(i){this.FirstName.Visible&&(this.FirstName.Enable=i,this.FirstName.Text=""),this.LastName.Visible&&(this.LastName.Enable=i,this.LastName.Text=""),this.MiddleName.Visible&&(this.MiddleName.Enable=i,this.MiddleName.Text=""),this.Salutation.Visible&&(this.Salutation.Enable=i,this.Salutation.SelectedValue="0"),this.JobTitle.Visible&&(this.JobTitle.Enable=i,this.JobTitle.Text=""),this.Phone1.Visible&&(this.Phone1.Enable=i,this.Phone1.Text=""),this.Phone2.Visible&&(this.Phone2.Enable=i,this.Phone2.Text=""),this.Email.Visible&&(this.Email.Enable=i,this.Email.Text=""),this.Fax.Visible&&(this.Fax.Enable=i,this.Fax.Text=""),this.Department.Visible&&(this.Department.Enable=i,this.Department.Text="")}details(){Logger.InfoLog("AddEditLeads::Entering details");try{let i="";return i+="<Row ",i+=""!=this.FirstName.Text&&""!=this.FirstName.Text?' FirstName="'+S.p.GetValidXml(this.FirstName.Text)+'"':' FirstName=""',i+=""!=this.MiddleName.Text&&""!=this.MiddleName.Text?' MiddleName="'+S.p.GetValidXml(this.MiddleName.Text)+'"':' MiddleName=""',i+=""!=this.LastName.Text&&""!=this.LastName.Text?' LastName="'+S.p.GetValidXml(this.LastName.Text)+'"':' LastName=""',i+=""!=this.Salutation.SelectedValue?' Salutation="'+this.Salutation.SelectedValue+'"':' Salutation="0"',i+=""!=this.JobTitle.Text&&""!=this.JobTitle.Text?' JobTitle="'+S.p.GetValidXml(this.JobTitle.Text)+'"':' JobTitle=""',i+=""!=this.Phone1.Text&&""!=this.Phone1.Text?' Phone1="'+S.p.GetValidXml(this.Phone1.Text)+'"':' Phone1=""',i+=""!=this.Phone2.Text&&""!=this.Phone2.Text?' Phone2="'+S.p.GetValidXml(this.Phone2.Text)+'"':' Phone2=""',i+=""!=this.Email.Text&&""!=this.Email.Text?' Email="'+S.p.GetValidXml(this.Email.Text)+'"':' Email=""',i+=""!=this.Fax.Text&&""!=this.Fax.Text?' Fax="'+S.p.GetValidXml(this.Fax.Text)+'"':' Fax="'+this.Fax.Text+'"',i+=""!=this.Department.Text&&""!=this.Department.Text?' Department="'+S.p.GetValidXml(this.Department.Text)+'"':' Department=""',i+="/>",Logger.InfoLog("AddEditLeads::Exiting details"),i.toString()}catch{return""}}ClearFields(){this.Subject.Text="",this.Company.Text="",this.Status.SelectedValue="1",this.Campaign.SelectedValue="",this.Lead.SelectedValue=0,this.ContactCombo.SelectedValue="53",this.EstimatedRevenue.Text="",this.Currency.SelectedValue=1,this.Probability.SelectedValue=0,this.Rating.SelectedValue=0,this.CloseDate.Text="",this.ViewActivities.ActivityGridData.Clear(),this.ViewActivities.ActivityGridDataObj.refreshDataView(),this.ViewActivities.Activity.SelectedValue="-1",this.LeadsProduct.ClearGrid(),this.ScreenObject.Clear()}EstimateRevenceData(i,t,s){try{this.EstimatedRevenue.Text=parseFloat(i).ToString("N2")}catch{this.EstimatedRevenue.Text="0"}this.CloseDate.Text=t.ToString(d.d.SessionManager.Preferences["Date Format"].toString()),this.CloseDate.Tag=t.toString(),this.Reason=s}AutoGenerateCode(){0==this.OppID&&this.ScreenObject.SetAutoCode(this.Code,!1,this.ParentId,this.ScreenObject.Data.Tables[7])}OnCellEditEnding(i){let t=i.item;if("Microsoft.Windows.Controls.DataGridComboBoxColumn"!=i.OriginalSource.Column.GetType().toString()){if(t.Table.Columns.Contains("UOM")&&"ProductName"==i.OriginalSource.Column.Binding.Path.Path&&!a.J0.IsEmpty(t.ProductName_Key)){let e=F.ControlGenerator.GetProductTypeDetails(parseInt(t.ProductName_Key.toString()),this.Date.Date,0,81,"",!1,!1,!1,!1,!1,!1,!1,!1,!1);e.Tables.length>0&&e.Columns[0].Contains("uomid")&&!a.J0.IsEmpty(e.Tables[0][0].uomid)&&(t.UOM=e.Tables[0][0].UnitName.toString(),t.UOM_Key=e.Tables[0][0].uomid.toString(),e.Tables.length>3&&e.Tables[3].length>0&&e.Columns[3].Contains("PurchaseRate")&&!a.J0.IsEmpty(e.Tables[3][0].PurchaseRate)?t.UnitPrice=e.Tables[3][0].PurchaseRate.toString():e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("PurchaseRate")&&!a.J0.IsEmpty(e.Tables[0][0].PurchaseRate)&&(t.UnitPrice=e.Tables[0][0].PurchaseRate.toString()),t.AcceptChanges())}this.CalculateTotals(t)}}CalculateTotals(i){let t=new L.bT,s=new R.Nl;s.setFieldDetails("RATE",1,1,"",1,!1,!1),t.push("RATE",s),s=new R.Nl,s.setFieldDetails("QTY",4,1,"",1,!1,!1),t.push("QTY",s),Object.keys(i).Contains("UnitPrice")&&!a.J0.IsEmpty(i.UnitPrice)?t.RATE.setFieldValue(i.UnitPrice):t.RATE.setFieldValue(0),Object.keys(i).Contains("Qty")&&!a.J0.IsEmpty(i.Qty)?t.QTY.setFieldValue(i.Qty):t.QTY.setFieldValue(0),i.Value=d.d.eval.EvaluateExpression("QTY*RATE",t).toString()}onBeginEdit(i){if("DataGridPactListBoxColumn"==i.column.className){let e=i.column.DgCol;if(11==e.CostCenterID){let m=i.item,h=" (BaseID IN ";h+=" (SELECT BaseID ",h+=" FROM COM_UOM AS COM_UOM_1 WITH(NOLOCK) ",h=h+" WHERE (UOMID ="+m.UOM_Key.toString()+" ))) ",""==m.UOM_Key.toString()&&(h=" (BaseID IN ",h+=" (SELECT BaseID ",h+=" FROM COM_UOM AS COM_UOM_1 WITH(NOLOCK) ",h+=" WHERE (UOMID =-1 ))) "),e.FilterCondition=h}}}loadtabs(){this.AssignRowColumns();for(let i=this.ScreenObject.CustomTab.Pages.length-1;i>=0;i--){let t=this.ScreenObject.CustomTab.Pages[i];switch(t.Name){case"Products":t.Fields.push(this.LeadsProduct);break;case"Activities":t.Fields.push(this.ViewActivities);break;case"History":t.Fields.push(this.ViewAssignHistroy.ListObj);break;case"Attachments":t.Fields.push(this.ViewAttachments);break;case"Notes":t.Fields.push(this.ViewNotes);break;case"Follow Up":t.Fields.push(this.ViewFeedback);break;case"Contacts":t.Fields.push(this.ViewContacts)}}}AssignRowColumns(){let i=this.ScreenObject.CustomFields.length;for(let t=0;t<i;t++)this.ScreenObject.CustomFields[t].Row=t/4,this.ScreenObject.CustomFields[t].Column=t%4}GetCurrency(){let i=[];i.push(0),i.push(d.d.SessionManager.UserID);let t=d.d.admin.GetCurrencies(i);null!=t&&t.Tables.length>0&&t.Columns[0].Contains("CurrencyID")&&(this.Currency.SelectedValue=a.J0.IsEmpty(t.Tables[0][0].CurrencyID)?0:parseInt(t.Tables[0][0].CurrencyID.toString()))}LoadReport(){let i=this.ScreenObject.CustomTab.Pages.find(t=>"Documents"==t.Name);if(null!=i&&null!=this.ds){let t=this.ds.Tables[0].filter(s=>"LinkDimension"==s.Name&&89==s.CostCenterID);if(t.length>0&&!a.J0.IsEmpty(t[0].Value)&&this.ds.Tables[2].length>0){let s=0,e=0,m=parseInt(t[0].Value)-5e4;s=a.J0.Int(this.ds.Tables[1][0].CCOpportunityID),0==s&&(s=-123);let h="(DCC.dcCCNID"+m+"="+s;t=this.ds.Tables[0].filter(l=>"LinkDimension"==l.Name&&89==l.CostCenterID),t.length>0&&!a.J0.IsEmpty(t[0].Value)&&(e=a.J0.Int(this.ds.Tables[1][0].CCLeadID),e>0&&(h+=" OR DCC.dcCCNID"+(parseInt(t[0].Value)-5e4)+"="+e)),h+=")";let n="";if(t=this.ds.Tables[0].filter(l=>"CreateDocuments"==l.Name&&89==l.CostCenterID),t.length>0&&!a.J0.IsEmpty(t[0].Value)&&(n=t[0].Value.toString().Replace(";",",")),e>0&&(t=this.ds.Tables[0].filter(l=>"CreateDocuments"==l.Name&&89==l.CostCenterID),t.length>0&&!a.J0.IsEmpty(t[0].Value)&&(n.length>0&&(n+=","),n+=t[0].Value.toString().Replace(";",","))),n.length>0){let l="<XML><Row ColID='300' Value='"+n+"'/>";l+="<Row ColID='CRM_Masters_DocumentsTab' Value='"+h+"'/>",l+="</XML>",null==this.Report?(i.Fields.Clear(),i.Fields.push(this.Report)):(this.Report.LoadDocFilterXML(l),this.Report.OnReportClick(this.Report.ReportID,0))}}}}OnSave(i){if("Close"==i&&d.d.page.ShowDialog(new Q(this),$,{ShowCenter:!0}),"EstimateRevenue"==i&&""!=this.EstimatedRevenue.Text&&(this.EstimatedRevenue.Enable=!0),"Save"==i||"SaveDraft"==i){Logger.InfoLog("SaveOpportunityViewModel:: OnSave");try{this.Opp.OpportunityID=this.OppID;let t=this.ScreenObject.ValidateData();if(!a.J0.IsEmpty(t))return this.DisplayMessage=t,void(this.MessageVisibility=!0);if(0==this.Opp.OpportunityID){let e={StrCode:this.Opp.Code,CodePrefix:this.Opp.CodePrefix,CodeNumber:this.Opp.CodeNumber};if(this.DisplayMessage=this.ScreenObject.SetAutoCodeParams_3(this.Code,this.ParentId,this.ScreenObject.Data.Tables[7],e),this.Opp.Code=e.StrCode,this.Opp.CodePrefix=e.CodePrefix,this.Opp.CodeNumber=e.CodeNumber,this.DisplayMessage.length>0)return}else this.Opp.Code=this.Code.Text;if(this.Opp.Subject=this.Subject.Text,a.J0.IsEmpty(this.Mode.SelectedValue)&&(this.Mode.SelectedValue="0"),this.Opp.Mode=parseInt(a.J0.String(this.Mode.SelectedValue)),this.Company.Visible?"0"==this.Mode.SelectedValue||"4"==this.Mode.SelectedValue?this.Opp.Company=null!=this.Company.Text?this.Company.Text:"":(this.Opp.Company=null!=this.Company.Code.Text?this.Company.Code.Text:"",this.Opp.SelectedModeID=this.Company.Code.SelectedValue):(!this.Company.Enable||!this.Company.Visible)&&(this.Opp.Company=this.Code.Text),this.Opp.GUID=this.OppID>0?a.J0.String(this.ds.Tables[1][0].GUID):"GUID",this.Opp.Status=""!=this.Status.SelectedValue?parseInt(this.Status.SelectedValue):0,this.Opp.Date=this.Date.Date,this.Opp.Leadid=0!=this.Lead.SelectedValue?this.Lead.SelectedValue:0,this.Opp.Contactid=""!=this.ContactCombo.SelectedValue?parseInt(this.ContactCombo.SelectedValue):0,this.Opp.Campaignid=""!=this.Campaign.SelectedValue?parseInt(this.Campaign.SelectedValue):0,this.Opp.EstimateRevenue=this.EstimatedRevenue.Text,this.Opp.Currency=0!=this.Currency.SelectedValue?this.Currency.SelectedValue:0,this.Opp.EstimateCloseDate=this.EstimatedCloseDate.Date?this.EstimatedCloseDate.Date:null,this.Opp.Probabilityid=0!=this.Probability.SelectedValue?this.Probability.SelectedValue:0,this.Opp.Ratingid=0!=this.Rating.SelectedValue?this.Rating.SelectedValue:0,""!=this.CloseDate.Text&&null!=this.CloseDate.Tag?this.Opp.CloseDate=a.J0.ParseDate(this.CloseDate.Tag):""!=this.CloseDate.Text&&(this.Opp.CloseDate=a.J0.ParseDate(this.CloseDate.Text)),this.Opp.Details=this.details(),this.Opp.OppProXML=this.LeadsProduct.GetProductXML(),this.Opp.ActivityXml=this.ViewActivities.ActivitiesXML(),this.Opp.Reason=this.Reason,this.Opp.CustomFieldsQuery=this.ScreenObject.GetCustomFieldsQuery(),this.Opp.CustomCostCenterFieldsQuery=this.ScreenObject.GetCustomCostCenterFieldsQuery(),this.Opp.NotesXML=this.ViewNotes.GetXML(),this.Opp.AttachmetsXML=this.ViewAttachments.GetXML(),this.Opp.FeedbackXML=this.ViewFeedback.GetXML(),this.Opp.WID=this.ScreenObject.CheckWorkFlow(),this.Opp.TabXML=this.getFields(),this.Opp.ContactXML=this.ViewContacts.GetXML(),null!=this.PrimaryContact&&this.PrimaryContact.CheckPrimaryDuplicateContact())return this.DisplayMessage="Duplicate Contact[s] in Contacts DB",void(this.MessageVisibility=!0);if(this.Opp.PrimaryContactXML=this.PrimaryContact.GetXML(),!this.ScreenObject.ValidateDataonSave())return;let s=this.Opp.SaveOpportunity();this.DisplayMessage=s.Message,this.Ret=s.RetValue,this.Ret>0&&(this.OppID=this.Ret,"SaveDraft"==i?(this.ds=this.Opp.GetOpportunity(this.OppID),this.OppID>0&&null!=this.ds&&this.ds.Tables[1].length>0&&(a.J0.IsEmpty(this.ds.Tables[1][0].GUID)||(this.Opp.GUID=this.ds.Tables[1][0].GUID.toString()))):(this.LeadsProduct.ClearGrid(),this.Opp.OpportunityID>0?(this.ButtonSave.Enable=!1,this.Code.Text=""):this.OppID=0,this.ClearFields(),this.AutoGenerateCode(),this.LeadsProduct.ProductGridObj.Clear(),this.ViewFeedback.FeedBackDataObj.Clear(),this.ViewNotes.NotesListObj.Clear(),this.ViewContacts.ContactsListObj.Clear(),this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewAssignHistroy.ListObj.Clear(),this.ViewFeedback.FeedBackDataObj.Clear())),Logger.InfoLog("SaveOpportunityViewModel:: OnSave")}catch(t){Logger.ErrorLog("SaveOpportunityViewModel:: OnSave"+t.stack)}}else if("Report"==i.toString())this.ReportInfoVisibility=!0,d.d.page.ShowDialog(this,Y.L,{Title:"Reports"});else if("Clone"==i.toString())this.IsClone=!0,this.DisplayName=d.d.GetResource("CRMOpportunity_AddOpportunity"),this.Lead.CCID=86,this.Currency.CCID=12,this.Lead.TypeID=this.Currency.TypeID=1,this.Lead.SelectedValue=this.Currency.SelectedValue=1,this.DisplayName=d.d.GetResource("CRMOpportunity_EditOpportunity"),this.OppID=0,this.AutoGenerateCode(),this.NextPreviousVisibility=!1,this.CloseVisible=!1;else if("ApproveMaster"==i.toString()){this.HideControls();let t=new z.i(89,this.OppID,this.ScreenObject,this);d.d.page.ShowDialog(t,Z.R,{ShowCenter:!0,Title:d.d.GetResource("ApproveReject")})}else"ViewHistory"==i.toString()?d.d.page.ShowDialog(new _.DocumentDraftsViewModel(this,3),q.DocumentDraftsComponent):"Email"==i&&this.OppID>0&&d.d.page.ShowDialog(new U.SendEmailSMSViewModel(!0,this.CostCenterID,this.OppID,this),k.SendEmailSMSComponent)}HideControls(){this.PrimaryVisibility=!1,this.ContactVisibility=!1}getFields(){Logger.InfoLog("AddEditLeads::Entering getFields");try{let i,t="";return t+="<Row ",this.ScreenObject.CustomTab.Pages.forEach(s=>{s.Fields.forEach(e=>{e instanceof g.MI&&null!=e.DBColumnName&&(e instanceof C.Dw?(i=e.Text,a.J0.IsEmpty(i)&&(i=""),t+=e.DBColumnName+'="'+S.p.GetValidXml(i)+'" '):e instanceof c.y$?(i=e.SelectedValue,a.J0.IsEmpty(i)&&(i=""),"Gender"==e.DBColumnName?null!=e.SelectedItem&&(t+=e.DBColumnName+'="'+S.p.GetValidXml(e.SelectedItem.Name)+'" '):"Country"==e.DBColumnName?null!=e.SelectedValue&&""!=e.SelectedValue&&(t+=e.DBColumnName+'="'+e.SelectedValue+'" '):t+=e.DBColumnName+'="'+S.p.GetValidXml(i)+'" '):e instanceof p.Lc?(i=a.J0.IsEmpty(e.Date)?"":e.Date.ToString("dd/MMM/yyyy"),a.J0.IsEmpty(i)&&(i=""),t+=e.DBColumnName+'="'+i+'" '):e instanceof y.I?(i=e.Text,a.J0.IsEmpty(i)&&(i=""),t+=e.DBColumnName+'="'+i+'" '):e instanceof b.y$&&(this.oPactCombo=e,t+=this.oPactCombo.DBColumnName+'="'+this.oPactCombo.SelectedValue+'" '))})}),t+=" />",Logger.InfoLog("AddEditLeads::Exiting getFields"),t.toString()}catch(i){throw i}}ReportView(){this.ReportDimension=new b.y$(0),this.ReportDimension.CCID=this.CostCenterID,this.ReportDimension.TypeID=1,this.ReportDimension.SelectedValue=this.OppID,this.ReportsList=[],this.ReportDimension.OnPactListBoxValueChanged.Subscribe(this,"OnReportsLinkClick");let i=[];this.dsData=d.d.common.GetDataSetQuery(" declare @UserID int,@RoleID int        set @UserID="+d.d.SessionManager.UserID+" set @RoleID="+d.d.SessionManager.RoleID+"    \n        SELECT R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel,Q.Width ,Q.Height,Q.mapxml,Q.MapType\n        FROM ADM_RevenUReports R  with(nolock)\n        inner join ADM_DocumentReports Q WITH(NOLOCK) on Q.DocumentReportID=R.ReportID\n        left join ADM_CostCenterDef A WITH(NOLOCK) on A.CostCenterColID=Q.DocumentField \n        left join [ADM_DocReportUserRoleMap] DR WITH(NOLOCK) on DR.DocumentViewID=Q.DocumentViewID and DR.CostCenterID=Q.CostCenterID\n        where  Q.CostCenterID="+this.CostCenterID+" and (DR.UserID=@UserID OR DR.RoleID=@RoleID OR GroupID IN (SELECT GroupID FROM COM_Groups WITH(NOLOCK) WHERE UserID=@UserID OR RoleID=@RoleID))\n        GROUP BY  Q.ReportID, R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel ,Q.Width,Q.Height,Q.mapxml,Q.MapType \n        order by Q.ReportID "),null!=this.dsData&&this.dsData.Tables[0].length>0&&this.dsData.Tables[0].forEach(s=>{let e=new D.v;e.DBColumnID=parseInt(s.ReportID),e.Label=s.ReportName.toString(),this.dsData.Columns[0].Contains("Shortcut")&&(e.KeyTip=s.Shortcut.toString()),this.dsData.Columns[0].Contains("DisplayAsPopup")&&""!=s.DisplayAsPopup.toString()&&(e.Dependantinuse="1"==s.DisplayAsPopup.toString()),this.dsData.Columns[0].Contains("Width")&&""!=s.Width.toString()&&(e.Width=s.Width.toString()),this.dsData.Columns[0].Contains("Height")&&""!=s.Height.toString()&&(e.Length=s.Height.toString()),this.dsData.Columns[0].Contains("DocumentField")&&""!=s.DocumentField.toString()&&(e.Formula=s.DocumentField.toString()),this.dsData.Columns[0].Contains("mapxml")&&""!=s.mapxml.toString()&&(e.ToolTipDescription=s.mapxml.toString()),i.Contains(parseInt(s.ReportID))||(i.push(parseInt(s.ReportID)),this.ReportsList.push(e)),0==this.ReportsList.length&&(this.ButtonReport.Visible=!1)})}OnReportsLinkClick(i){var t=this;return(0,w.A)(function*(){const{ReportViewModel:s}=yield Promise.resolve().then(u.bind(u,16645)),{ReportViewComponent:e}=yield Promise.resolve().then(u.bind(u,53884));let n,m={strXML:""},h=new s;if(t.ReportDimension.SelectedValue=t.OppID,t.DisplayMessage=t.GetReportFilterXML(i,m),n=m.strXML,0==t.DisplayMessage.length){var l=t.ReportsList.find(r=>r.DBColumnID==parseInt(i));if(null!=l&&l.Dependantinuse)h.ReportViewModel_Document(t.CostCenterID,n,parseInt(i),!0,null,null),!a.J0.IsEmpty(l.Width)&&parseFloat(l.Width)>0&&(h.RptWidth=parseFloat(l.Width)),!a.J0.IsEmpty(l.length)&&parseFloat(l.length)>0&&(h.RptHeight=parseFloat(l.length)),h.DocumentObject=t,d.d.page.HideDialog(t.PopUpGUID),d.d.page.ShowDialog(h,e,{Title:"",HideClose:!0,ShowCenter:!0});else{let r=new s;r.ReportViewModel_Document(t.CostCenterID,n,parseInt(i),!1,null,null),r.DocumentObject=t,d.d.page.HideDialog(t.PopUpGUID),d.d.page.addNewTab({component:e,params:{obj:r}})}}})()}GetReportFilterXML(i,t){let s="";t.strXML="";let e=this.dsData.Tables[0];e=e.filter(n=>n.ReportID==i);let h,m=!1;e.forEach(n=>{(0,f.yG0)(n.GroupLevel)&&(m=!0)}),s+="<XML",m&&(s+=' GroupLevel="1"'),s+=" >";for(let n=0;n<e.length;n++){h=e[n].ReportField.toString(),s+="<Row ",s+='ColID ="'+h+'" ';for(let l=0;l<this.ScreenObject.StaticFields.length;l++)if(this.ScreenObject.StaticFields[l].DBColumnID==parseInt(e[n].DocumentField.toString()))if(this.ScreenObject.StaticFields[l]instanceof C.Dw){if(""==this.ScreenObject.StaticFields[l].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[l].Label+" '"),"Empty Value";"SNO"==e[n].SysColumnName.toString()?s+='Value ="'+this.ReportDimension.SelectedValue+'" ':s+='Value ="'+this.ScreenObject.StaticFields[l].Text+'" '}else if(this.ScreenObject.StaticFields[l]instanceof C.s3){if(""==this.ScreenObject.StaticFields[l].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[l].Label+" '"),"Empty Value";s+='Value ="'+this.OppID+'" '}else if(this.ScreenObject.StaticFields[l]instanceof V.e3){if(""==this.ScreenObject.StaticFields[l].TextBox.Text||""==this.ScreenObject.StaticFields[l].ComboBox.SelectedValue)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[l].Label+" '"),"Empty Value";s+='Value ="'+this.ScreenObject.StaticFields[l].ComboBox.SelectedValue+'" '}else if(this.ScreenObject.StaticFields[l]instanceof C.hV){if(""==this.ScreenObject.StaticFields[l].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[l].Label+" '"),"Empty Value";s+='Value ="'+this.ScreenObject.StaticFields[l].Text+'" '}else if(this.ScreenObject.StaticFields[l]instanceof p.Lc||this.ScreenObject.StaticFields[l]instanceof p.l6||this.ScreenObject.StaticFields[l]instanceof p.P6){if(this.ScreenObject.StaticFields[l]instanceof p.Lc||this.ScreenObject.StaticFields[l]instanceof p.l6){if(""==this.ScreenObject.StaticFields[l].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[l].Label+" '"),"Empty Value";s+='Value ="'+this.ScreenObject.StaticFields[l].Date.ToString("dd/MMM/yyyy")+'" '}else if(this.ScreenObject.StaticFields[l]instanceof p.P6){if(!this.ScreenObject.StaticFields[l].Date)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[l].Label+" '"),"Empty Value";s+='Value ="'+this.ScreenObject.StaticFields[l].Date.ToString("dd/MMM/yyyy")+'" '}}else if(this.ScreenObject.StaticFields[l]instanceof b.y$){if(""==this.ScreenObject.StaticFields[l].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[l].Label+" '"),"Empty Value";s+='Value ="'+this.ScreenObject.StaticFields[l].SelectedValue+'" '}else if(this.ScreenObject.StaticFields[l]instanceof I.G){if(""==this.ScreenObject.StaticFields[l].Text)return alert(this.ErrorMessage+this.ScreenObject.StaticFields[l].Label+" '"),"Empty Value";s+='Value ="'+this.ScreenObject.StaticFields[l].SelectedValue+'" '}this.ScreenObject.CustomTab.Pages.forEach(l=>{l.Fields.forEach(r=>{if(null!=r&&(r instanceof C.Dw||r instanceof V.e3||r instanceof C.hV||r instanceof p.Lc||r instanceof p.l6||r instanceof p.P6||r instanceof b.y$||r instanceof I.G)&&r.DBColumnID==parseInt(e[n].DocumentField.toString()))if(r instanceof C.Dw){if(""==r.Text)return alert(this.ErrorMessage+r.Label+" '"),"Empty Value";s+='Value ="'+r.Text+'" '}else if(r instanceof V.e3){if(""==r.TextBox.Text||""==r.ComboBox.SelectedValue)return alert(this.ErrorMessage+r.Label+" '"),"Empty Value";s+='Value ="'+r.TextBox.Text+'" '}else if(r instanceof C.hV){if(""==r.Text)return alert(this.ErrorMessage+r.Label+" '"),"Empty Value";s+='Value ="'+r.Text+'" '}else if(r instanceof p.Lc||r instanceof p.l6||r instanceof p.P6){if(r||r){if(""==r.Text)return alert(this.ErrorMessage+r.Label+" '"),"Empty Value";s+='Value ="'+r.Date.ToString("dd/MMM/yyyy")+'" '}else if(r instanceof p.P6){if(!r.Date)return alert(this.ErrorMessage+r.Label+" '"),"Empty Value";s+='Value ="'+r.Date.ToString("dd/MMM/yyyy")+'" '}}else if(r instanceof b.y$){if(""==r.Text&&0==r.SelectedValue)return alert(this.ErrorMessage+r.Label+" '"),"Empty Value";s+='Value ="'+r.SelectedValue+'" '}else if(r instanceof I.G){if(""==r.Text)return alert(this.ErrorMessage+r.Label+" '"),"Empty Value";s+='Value ="'+r.SelectedValue+'" '}return"Empty Value"})}),s+=" />"}return s+="</XML>",t.strXML=s.toString(),""}}}}]);