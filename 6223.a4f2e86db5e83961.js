"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[6223],{96223:(L,g,i)=>{i.r(g),i.d(g,{LoanGuaranteesViewModel:()=>C});var s=i(32040),l=i(43767),m=i(98580),E=i(7321),p=i(66096),h=i(21774);class C extends m.g{constructor(e,t){if(super(),this.EmployeeList=new p.G(0),this.strCustomEmpFilter="",this.dtLoanGuarantees=null,this.DocID=0,Logger.InfoLog("LoanGuaranteesViewModel::Entering LoanGuaranteesViewModel()"),this.DocID=e,this.dtLoanGuarantees=t,this.DisplayMessage="",this.EmployeeList.Code.TypeID=4,this.EmployeeList.Name.TypeID=1,this.EmployeeList.Code.Visible=this.EmployeeList.Name.Visible=!1,this.EmployeeList.Code.Column=0,this.EmployeeList.Name.Column=1,this.EmployeeList.Code.Visible=!0,this.EmployeeList.Name.Visible=!0,this.EmployeeList.Code.CCID=this.EmployeeList.Name.CCID=50051,this.EmployeeList.Code.Visible&&(this.EmployeeList.Code.CCID=50051,this.EmployeeList.Code.TypeID=4),this.EmployeeList.Name.Visible&&(this.EmployeeList.Name.CCID=50051,this.EmployeeList.Name.TypeID=1),this.strCustomEmpFilter=this.FilterEmployees(),this.EmployeeList.Code.CustomWhere=this.EmployeeList.Name.CustomWhere=this.strCustomEmpFilter,this.LoadGrid(),null!=t&&t.length>0){let n,o="";for(let a=0;a<t.length;a++)o+=l.J0.String(t[a].GEmpSeqNo)+",";if(o.length>0){o=o.Remove(o.length-1,1);let d,a=s.d.common.GetDataTable("LOG001",o);for(let r=0;r<t.length;r++)n=a.filter(y=>y.NodeID==l.J0.String(t[r].GEmpSeqNo)),n.length>0&&(d=this.dgv.NewRow(),d.EmployeeID=l.J0.String(t[r].GEmpSeqNo),d.EmpCode=l.J0.String(n[0].Code),d.EmpName=l.J0.String(n[0].Name),this.dgv.addRow(d));this.dgv.RefreshSno()}}Logger.InfoLog("LoanGuaranteesViewModel::Exiting LoanGuaranteesViewModel()")}FilterEmployees(){let e="";try{Logger.InfoLog("LoanGuaranteesViewModel::Entering FilterEmployees()"),e=" ( a.StatusID=250 AND ISNULL(CONVERT(DATETIME,a.DORelieve),'01-Jan-9000')>='"+s.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"' AND CONVERT(DATETIME,a.DOJ)<='"+s.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")+"' ) ",s.d.SessionManager.LocationID>0&&s.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&s.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(e=e+" AND a.NodeID IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+s.d.SessionManager.LocationID+")"),Logger.InfoLog("MonthlyPayrollViewModel::Exiting FilterEmployees()")}catch(t){Logger.ErrorLog("LoanGuaranteesViewModel::EXCEPTION FilterEmployees()"+t.stack)}return e}dgv_BeginEdit(e,t,o){return!0}LoadGrid(){Logger.InfoLog("GradeWiseSlabsViewModel::Entering LoadGrid()"),this.dgv=new E.vv,this.dgv.CanUserAddRows=!1,this.dgv.CanUserSortColumns=!1,this.dgv.CanUserDeleteRows=!0,this.dgv.Columns=[],this.dgv.Width="530",this.dgv.OnBeginEdit.Subscribe(this,"dgv_BeginEdit");let e=new h.O7;e.Header="#",e.DisplayMember="sno",e.ID="sno",e.Width=40,e.ReadOnly=!0,e.TextAlign="Center",this.dgv.Columns.push(e),e=new h.O7,e.Header="Employee Code",e.DisplayMember="EmpCode",e.DataType="TextBlock",e.Width=200,this.dgv.Columns.push(e),e=new h.O7,e.Header="Employee Name",e.DisplayMember="EmpName",e.DataType="TextBlock",e.Width=270,this.dgv.Columns.push(e),this.dgv.Table=[],this.dgv.TableNewRow.Subscribe(this,"dgv_RowAdded"),this.dgv.RowDeleted.Subscribe(this,"dgv_RowDeleted"),this.dgv.TableColumns.push("sno"),this.dgv.TableColumns.push("EmployeeID"),this.dgv.TableColumns.push("EmpCode"),this.dgv.TableColumns.push("EmpName"),Logger.InfoLog("GradeWiseSlabsViewModel::Exiting LoadGrid()")}Button_Click(e){try{Logger.InfoLog("LoanGuaranteesViewModel::Entering Button_Click()"),"Add"==e.toString()?this.Add_Click():"OK"==e.toString()?this.Save_Click():"Clear"==e.toString()?(this.EmployeeList.SelectedValue=0,this.dgv.Table.Clear()):"Cancel"==e.toString()&&(s.d.page.HideDialog(this.PopUpGUID),this.DialogResult=!1),Logger.InfoLog("LoanGuaranteesViewModel::Exiting Button_Click()")}catch(t){Logger.ErrorLog("LoanGuaranteesViewModel::EXCEPTION Button_Click()"+t.stack)}}Add_Click(){if(0==this.EmployeeList.SelectedValue)return this.DisplayMessage="Select any Employee",void(this.MessageVisibility=!0);{let e=this.dgv.Table.filter(t=>t.EmployeeID==this.EmployeeList.SelectedValue);if(null!=e&&e.length>0)this.DisplayMessage="Employee already selected",this.MessageVisibility=!0;else{let t=this.dgv.NewRow();t.sno=this.dgv.Table.length+1,t.EmployeeID=this.EmployeeList.SelectedValue,t.EmpCode=this.EmployeeList.Code.Text,t.EmpName=this.EmployeeList.Name.Text,this.dgv.addRow(t),this.EmployeeList.SelectedValue=0}}}dgv_RowAdded(e,t){this.dgv.RefreshSno()}dgv_RowDeleted(e,t){this.dgv.RefreshSno()}Save_Click(){if(0==this.dgv.Table.length)return this.DisplayMessage="Select atleast one Employee",void(this.MessageVisibility=!0);{let e;this.dtLoanGuarantees=[],this.dtLoanGuaranteesColumns.push("GEmpSeqNo");for(let t=0;t<this.dgv.Table.length;t++)e={},e.GEmpSeqNo=l.J0.String(this.dgv.Table[t].EmployeeID),this.dtLoanGuarantees.push(e);this.DialogResult=!0,s.d.page.HideDialog(this.PopUpGUID)}}}}}]);