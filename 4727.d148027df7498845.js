"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[4727],{84727:(v,m,r)=>{r.r(m),r.d(m,{SearchContactViewModel:()=>G});var d=r(58170),u=r(23458),f=r(98580),l=r(21774),S=r(7321),C=r(27730),g=r(11592),y=r(54581),T=r(31884),b=r(84151),D=r(43767),p=r(82503),a=r(32040);class I{get Data(){return this._Data}constructor(){this._DocumentID=0,this.className="PreferenceControlGenerator",this.SessionManager=a.d.SessionManager,this.commonService=a.d.common}LoadScreen(t,n){Logger.InfoLog("PreferenceControlGenerator:: Inside LoadScreen"),this._Data=null,this.OnLoad(t,n)}LoadScreen_1(t,n,o){Logger.InfoLog("PreferenceControlGenerator:: Inside LoadScreen"),this._DocumentID=o,this._Data=null,this.OnLoad(t,n)}OnLoad(t,n){try{if(null==this._Data){this.oParent=t,this._Data=this._DocumentID>0?this.GetScreenInfo_2(n,this._DocumentID):this.GetScreenInfo(n);for(const o in t){let e=t[o];if(e instanceof d.MI||e instanceof C.y$||e instanceof u.y$||e instanceof p.Lc||e instanceof u.bQ){let i=e;null!=i&&i.FeatureID==n&&(this.StaticFields.push(i),this.SetProperties_Static(i))}}}}catch(o){Logger.ErrorLog("PreferenceControlGenerator:: LoadScreen : "+o.stack)}}SetProperties_Static(t){let n=this._Data.Tables[0].filter(o=>o.CostCenterColID==t.DBColumnID);if(n.length>0)if(t instanceof C.y$){t.Label=n[0].Text.toString();let o=t;if(n[0].Contains("ProbableValues")){let e=null!=n[0].UserProbableValues?n[0].UserProbableValues.toString().trim():[];if(e.length>0&&null!=o){let i=e.split(";");for(let s=0;s<i.length;s++)o.Items.push(C._p.ComboBoxItems_2(i[s].replace("''","'"),i[s].replace("''","'")));o.SelectedValue=o.Items[0].Value}}o.DefaultValue=n[0].Value.toString(),this.SetProperty_DefaultValue(o)}else t.Label=n[0].Text.toString(),t.DefaultValue=n[0].Value.toString(),this.SetProperty_DefaultValue(t);else t.Label=""}SetProperty_DefaultValue(t){if(t instanceof g.c)try{t.IsChecked=(0,y.yG0)(t.DefaultValue)}catch{}else if(t instanceof u.y$)try{t.SelectedValue=parseInt(t.DefaultValue)}catch{}else if(t instanceof T.u)try{t.IsChecked=(0,y.yG0)(t.DefaultValue)}catch{}else if(t instanceof b.Dw)try{t.Text=t.DefaultValue}catch{}else if(t instanceof C.y$)try{t.SelectedValue=D.J0.IsEmpty(t.DefaultValue)?"":t.DefaultValue}catch{}else if(t instanceof p.Lc)try{t.Date=D.J0.ParseDate(t.DefaultValue)}catch{}}GetScreenInfo(t){try{return this.commonService.GetScreenInfo(t)}catch(n){return this.SessionManager.Logger.ErrorLog("ControlGenerator:: GetScreenInfo"+n),null}}GetScreenInfo_2(t,n){Logger.InfoLog("PreferenceControlGenerator:: Inside GetScreenInfo");try{let o=null;return o=a.d.document.GetScreenInfo_2(t,n,0),o}catch(o){return Logger.ErrorLog("PreferenceControlGenerator:: GetScreenInfo"+o.stack),null}}GetDocFields(t,n){}GetTableName(t){return 2==t?"ACC_Accounts":3==t?"INV_Product":50001==t?"COM_Division":50002==t?"COM_Location":50003==t?"COM_Branch":50004==t?"COM_Department":50005==t?"COM_Salesman":50006==t?"COM_Category":50007==t?"COM_Area":50008==t?"COM_Teritory":"COM_CC"+t}GetUnitStatuses(t){}SetPayrollDocumentFields(t){}}var O=r(71329);class G extends f.g{get angularGrid(){return this.TableObj.angularGrid}get Table(){return this.TableObj.Table}get Columns(){return this.TableObj.TableColumns}get ColumnSource(){return this.TableObj.Columns}set ColumnSource(t){this.TableObj.Columns=t}get SelectedGridTable(){return this.SelectedGrid.Table}get SelectedItem(){return this.SelectedGrid.SelectedItem}get SelectedGridColumns(){return this.SelectedGrid.Columns}set SelectedGridColumns(t){this.SelectedGrid.Columns=t}constructor(t){super(),this.Fields=new Array,this.ButtonClick=new d.Yk,this.TableObj=new S.vv,this.SelectedGrid=new S.vv,this.className="SearchContactViewModel",this.Title="Search Contacts",this.ButtonClick.Subscribe(this,"OnButtonClick"),"ViewOrganizationViewModel"==t.ClassName?this.Oparent=t:"ViewInvitesViewModel"==t.ClassName?this.OIparent=t:"ViewStaffViewModel"==t.ClassName?this.OStaff=t:"ResponcesViewModel"==t.ClassName?this.OResponses=t:this.OSpeaker=t,this.LoadGrid();let n=0,o=0,e=new u.y$(0);e.CCID=83,e.TypeID=1,e.Label="Customer",e.DBColumnID=26644,e.DBColumnName="CustomerID",e.SysColumnName="CustomerID",e.Column=n,e.Row=o,this.Fields.push(e),n+=1;let i=new I;i.LoadScreen(this,88);let s=i.Data.Tables[0],c=null;s.RowFilter="DBText='SearchContactDims'",s=s.filter(h=>"SearchContactDims"==h.DBText),s.length>0&&s[0].Value.toString().length>0&&(c=s[0].Value.toString().split(",")),null!=c&&(i.Data.Tables.length>1&&(s=i.Data.Tables[1].DefaultView),c.forEach(h=>{e=new u.y$(0),e.CCID=parseInt(h),e.TypeID=1,s.Table.Columns.Contains("FeatureID")&&(s.RowFilter="FeatureID="+h,s.length>0&&(e.Label=s[0].Name.toString())),e.Column=n,e.Row=o,this.Fields.push(e),3==n?(o+=1,n=0):n+=1}))}LoadGrid(){let t;this.TableObj.Table=[],this.Columns.push("Customer"),this.Columns.push("CustomerID"),this.Columns.push("ContactID"),this.Columns.push("ContactName"),this.Columns.push("JobTitle"),this.Columns.push("Department"),this.Columns.push("Salutation"),this.Columns.push("SalutationID"),(null!=this.Oparent?73!=this.Oparent.CostCenterID:null!=this.OSpeaker&&73!=this.OSpeaker.CostCenterID)||null!=this.OIparent&&73!=this.OIparent.CostCenterID||null!=this.OStaff||null!=this.OResponses?(this.Columns.push("CytomedDivision"),this.Columns.push("CytomedDivision_Key"),this.Columns.push("Territory"),this.Columns.push("Territory_Key"),this.Columns.push("City"),this.Columns.push("City_Key"),this.Columns.push("Country"),this.Columns.push("Country_Key")):(this.Columns.push("MiddleName"),this.Columns.push("LastName")),this.Columns.push("Action"),this.SelectedGrid.Table=[],this.SelectedGrid.TableColumns.push("Customer"),this.SelectedGrid.TableColumns.push("CustomerID"),this.SelectedGrid.TableColumns.push("ContactID"),this.SelectedGrid.TableColumns.push("ContactName"),this.SelectedGrid.TableColumns.push("JobTitle"),this.SelectedGrid.TableColumns.push("Department"),this.SelectedGrid.TableColumns.push("Salutation"),this.SelectedGrid.TableColumns.push("SalutationID"),(null!=this.Oparent?73!=this.Oparent.CostCenterID:null!=this.OSpeaker&&73!=this.OSpeaker.CostCenterID)||null!=this.OIparent||null!=this.OStaff||null!=this.OResponses?(this.SelectedGrid.TableColumns.push("CytomedDivision"),this.SelectedGrid.TableColumns.push("CytomedDivision_Key"),this.SelectedGrid.TableColumns.push("Territory"),this.SelectedGrid.TableColumns.push("Territory_Key"),this.SelectedGrid.TableColumns.push("City"),this.SelectedGrid.TableColumns.push("City_Key"),this.SelectedGrid.TableColumns.push("Country"),this.SelectedGrid.TableColumns.push("Country_Key")):(this.SelectedGrid.TableColumns.push("MiddleName"),this.SelectedGrid.TableColumns.push("LastName")),this.SelectedGrid.TableColumns.push("Action"),this.ColumnSource=[],this.SelectedGridColumns=[],t=new l.O7,t.Header=a.d.GetResource("Service_Action"),t.DisplayMember="Action",t.DataType="LINK",t.Width=65,t.ReadOnly=!0,t.Click.Subscribe(this,"onClick"),this.ColumnSource.push(t),t=new l.O7,t.Header=a.d.GetResource("Customer"),t.DisplayMember="Customer",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=(null!=this.Oparent?73!=this.Oparent.CostCenterID:null==this.OSpeaker||73!=this.OSpeaker.CostCenterID)&&null==this.OIparent&&null==this.OStaff&&null==this.OResponses,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new l.O7,t.Header=a.d.GetResource("ContactName"),t.DisplayMember="ContactName",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new l.O7,t.Header=a.d.GetResource("JobTitle"),t.DisplayMember="JobTitle",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new l.O7,t.Header=a.d.GetResource("Department"),t.DisplayMember="Department",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new l.O7,t.Header=a.d.GetResource("Salutation"),t.DisplayMember="Salutation",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),((null!=this.Oparent?73!=this.Oparent.CostCenterID:null!=this.OSpeaker&&73!=this.OSpeaker.CostCenterID)||null!=this.OIparent||null!=this.OStaff||null!=this.OResponses)&&(t=new l.O7,t.Header=a.d.GetResource("CytomedDivision"),t.DisplayMember="CytomedDivision",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new l.O7,t.Header=a.d.GetResource("Country"),t.DisplayMember="Country",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new l.O7,t.Header=a.d.GetResource("City"),t.DisplayMember="City",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t),t=new l.O7,t.Header=a.d.GetResource("Territory"),t.DisplayMember="Territory",t.DataType="TEXTBOX",t.Width=150,t.IsVisible=!0,t.ReadOnly=!0,this.ColumnSource.push(t),this.SelectedGridColumns.push(t)),this.TableObj.Columns=this.ColumnSource,this.SelectedGrid.Columns=this.SelectedGridColumns}OnSelectionChangedCommand(t){null!=t&&t.toString()}onClick(){if(null!=this.SelectedItem){let t=this.SelectedGrid.NewRow();t.Customer=this.SelectedItem.Customer.toString(),t.CustomerID=this.SelectedItem.CustomerID.toString(),t.ContactName=this.SelectedItem.ContactName.toString(),t.ContactID=this.SelectedItem.ContactID.toString(),t.Salutation=this.SelectedItem.Salutation.toString(),t.SalutationID=this.SelectedItem.SalutationID.toString(),t.JobTitle=this.SelectedItem.JobTitle.toString(),t.Department=this.SelectedItem.Department.toString(),this.SelectedGrid.TableColumns.Contains("Country")&&(t.Country=this.SelectedItem.Country.toString()),this.SelectedGrid.TableColumns.Contains("City")&&(t.City=this.SelectedItem.City.toString()),this.SelectedGrid.TableColumns.Contains("CytomedDivision")&&(t.CytomedDivision=this.SelectedItem.CytomedDivision.toString()),this.SelectedGrid.TableColumns.Contains("Territory")&&(t.Territory=this.SelectedItem.Territory.toString()),this.SelectedGrid.TableColumns.Contains("Country")&&(t.Country=this.SelectedItem.Country.toString()),this.SelectedGrid.TableColumns.Contains("City")&&(t.City=this.SelectedItem.City.toString()),this.SelectedGrid.TableColumns.Contains("Country_key")&&(t.Country_key=this.SelectedItem.Country_key.toString()),this.SelectedGrid.TableColumns.Contains("City_key")&&(t.City_key=this.SelectedItem.City_key.toString()),this.SelectedGrid.TableColumns.Contains("CytomedDivision_Key")&&(t.CytomedDivision_Key=this.SelectedItem.CytomedDivision_Key.toString()),this.SelectedGrid.TableColumns.Contains("Territory_Key")&&(t.Territory_Key=this.SelectedItem.Territory_Key.toString()),t.Action="Add",this.SelectedGrid.addRows(t)}}OnButtonClick(t){if(null!=t)if("Cancel"==t.toString())a.d.page.HideDialog(this.PopUpGUID);else if("OK"==t.toString()){let n=null;for(let o=0;o<this.SelectedGrid.Table.length;o++){let e=this.SelectedGrid.Table[o];if(null!=this.Oparent&&"ViewOrganizationViewModel"==this.Oparent.ClassName){if(this.Oparent.lstContacts.filter(s=>s.toString()==e.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+e.ContactName.toString()+"' \r\n Do you want to continue "))continue;this.Oparent.lstContacts.push(null!=e.ContactID&&""!=e.ContactID.toString()?parseInt(e.ContactID.toString()):0);let i=this.Oparent.OrganizationDataObj.NewRow();i.Customer=e.Customer.toString(),i.CustomerID=e.CustomerID.toString(),i.ContactName=e.ContactName.toString(),i.ContactID=e.ContactID.toString(),i.Salutation=e.Salutation.toString(),i.SalutationID=e.SalutationID.toString(),i.JobTitle=e.JobTitle.toString(),i.Department=e.Department.toString(),this.Oparent.OrganizationDataObj.TableColumns.Contains("Country")&&(i.Country=e.Country.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("City")&&(i.City=e.City.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("CytomedDivision")&&(i.CytomedDivision=e.CytomedDivision.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("Territory")&&(i.Territory=e.Territory.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("Country_key")&&(i.Country_key=e.Country_key.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("City_key")&&(i.City_key=e.City_key.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("CytomedDivision_Key")&&(i.CytomedDivision_Key=e.CytomedDivision_Key.toString()),this.Oparent.OrganizationDataObj.TableColumns.Contains("Territory_Key")&&(i.Territory_Key=e.Territory_Key.toString()),this.Oparent.OrganizationDataObj.addRows(i)}else if(null!=this.OIparent&&"ViewInvitesViewModel"==this.OIparent.ClassName){if(this.OIparent.lstContacts.filter(s=>s.toString()==e.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+e.ContactName.toString()+"' \r\n Do you want to continue "))continue;this.OIparent.lstContacts.push(null!=e.ContactID&&""!=e.ContactID.toString()?parseInt(e.ContactID.toString()):0);let i=this.OIparent.InvitesData.NewRow();i.Customer=e.Customer.toString(),i.CustomerID=e.CustomerID.toString(),i.ContactName=e.ContactName.toString(),i.ContactID=e.ContactID.toString(),i.Salutation=e.Salutation.toString(),i.SalutationID=e.SalutationID.toString(),i.JobTitle=e.JobTitle.toString(),i.Department=e.Department.toString(),this.OIparent.InvitesData.Columns.Contains("Country")&&(i.Country=e.Country.toString()),this.OIparent.InvitesData.Columns.Contains("City")&&(i.City=e.City.toString()),this.OIparent.InvitesData.Columns.Contains("CytomedDivision")&&(i.CytomedDivision=e.CytomedDivision.toString()),this.OIparent.InvitesData.Columns.Contains("Territory")&&(i.Territory=e.Territory.toString()),this.OIparent.InvitesData.Columns.Contains("Country_key")&&(i.Country_key=e.Country_key.toString()),this.OIparent.InvitesData.Columns.Contains("City_key")&&(i.City_key=e.City_key.toString()),this.OIparent.InvitesData.Columns.Contains("CytomedDivision_Key")&&(i.CytomedDivision_Key=e.CytomedDivision_Key.toString()),this.OIparent.InvitesData.Columns.Contains("Territory_Key")&&(i.Territory_Key=e.Territory_Key.toString()),this.OIparent.InvitesData.addRows(i)}else if(null!=this.OStaff&&"ViewStaffViewModel"==this.OStaff.ClassName){if(this.OStaff.lstContacts.filter(i=>i.toString()==e.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+e.ContactName.toString()+"' \r\n Do you want to continue "))continue;if(null!=e.CustomerID.toString()&&""!=e.CustomerID.toString()&&"0"!=e.CustomerID.toString()){this.OStaff.lstContacts.push(null!=e.ContactID&&""!=e.ContactID.toString()?parseInt(e.ContactID.toString()):0);let i=this.OStaff.OrganizationData.NewRow();i.Type="Involve",i.Customer=e.Customer.toString(),i.CustomerID=e.CustomerID.toString(),i.JobTitle=e.JobTitle.toString(),i.StaffName=e.ContactName.toString(),i.ContactID=e.ContactID.toString(),this.OStaff.OrganizationData.Rows.push(i)}}else if(null!=this.OSpeaker&&"ViewCampaignSpeakersViewModel"==this.OSpeaker.ClassName){if(this.OSpeaker.lstContacts.filter(i=>i.toString()==e.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+e.ContactName.toString()+"' \r\n Do you want to continue "))continue;if(null!=e.CustomerID.toString()&&""!=e.CustomerID.toString()&&"0"!=e.CustomerID.toString()){this.OSpeaker.lstContacts.push(null!=e.ContactID&&""!=e.ContactID.toString()?parseInt(e.ContactID.toString()):0);let i=this.OSpeaker.SpeakersData.NewRow();i.date=(new Date).ToString("dd/MMM/yyyy"),i.Customer=e.Customer.toString(),i.CustomerID=e.CustomerID.toString(),i.ContactName=e.ContactName.toString(),i.ContactID=e.ContactID.toString(),this.OSpeaker.SpeakersData.Rows.push(i)}}else if(null!=this.OResponses&&"ResponcesViewModel"==this.OResponses){if(this.OResponses.lstContacts.filter(i=>i.toString()==e.ContactID.toString()).length>0&&confirm("Duplicate contact found '"+e.ContactName.toString()+"' \r\n Do you want to continue "))continue;if(null!=e.CustomerID.toString()&&""!=e.CustomerID.toString()&&"0"!=e.CustomerID.toString()){this.OResponses.lstContacts.push(null!=e.ContactID&&""!=e.ContactID.toString()?parseInt(e.ContactID.toString()):0);let i=this.OResponses.grdata.NewRow();if(i.ReceivedDate=(new Date).ToString("dd/MMM/yyyy"),null!=n&&n.Tables.length>4&&n.Tables[5].length>0){let s=n.Tables[5];null!=s&&(s.RowFilter="IsDefault=1",s.length>0&&(i.ResponceType=s[0].Name.toString(),i.CampgnRespLookupID=s[0].NodeID.toString()))}i.ContactID=e.ContactID.toString(),i.Customer=e.Customer.toString(),i.CompanyName=e.Customer.toString(),i.CustomerID=e.CustomerID.toString(),i.JobTitle=e.JobTitle.toString(),i.ContactName=e.ContactName.toString(),i.FirstName=e.ContactName.toString(),i.JobTitle=e.JobTitle.toString(),i.Department=e.Department.toString(),i.Campaign=null!=this.OResponses.ObjParent&&null!=this.OResponses.ObjParent.txtName?this.OResponses.ObjParent.txtName.Text:"",this.OResponses.grdata.Rows.push(i)}}}a.d.page.HideDialog(this.PopUpGUID),this.ClearData()}else if("Clear"==t.toString())this.ClearData();else if("Search"==t.toString()){let n="";if(this.Fields.forEach(o=>{o instanceof u.y$&&(this.oPactCombo=o,this.oPactCombo.SelectedValue>0&&(n+=0==n.length?" where ":" and ",83==this.oPactCombo.CCID?n+=" ( cus.customerid= "+this.oPactCombo.SelectedValue+" ) ":(n+=" ( (c.FeatureID=65 and CC.CCNID"+(this.oPactCombo.CCID-5e4)+"="+this.oPactCombo.SelectedValue+" )",n+=" or (  c.FeatureID=83 and cccus.CCNID"+(this.oPactCombo.CCID-5e4)+"="+this.oPactCombo.SelectedValue+" )) ")))}),n.toString().length>0){let e=(new O.N).GetContactSearchDetails(n.toString());null!=e&&e.Tables.length>0&&(this.TableObj.Clear(),e.Tables[0].forEach(i=>{let s=this.TableObj.NewRow();s.Customer=i.CustomerName.toString(),s.CustomerID=i.CustomerID.toString(),s.ContactName=i.FirstName.toString(),s.ContactID=i.ContactID.toString(),s.Salutation=i.Salutation.toString(),s.SalutationID=i.SalutationID.toString(),s.JobTitle=i.JobTitle.toString(),s.Department=i.Department.toString(),this.TableObj.TableColumns.Contains("Country")&&(s.Country=i.Country.toString()),this.TableObj.TableColumns.Contains("City")&&(s.City=i.City.toString()),this.TableObj.TableColumns.Contains("City")&&(s.CytomedDivision=i.CytomedDivision.toString()),this.TableObj.TableColumns.Contains("City")&&(s.Territory=i.Territory.toString()),this.TableObj.TableColumns.Contains("City")&&(s.Country=i.Country1.toString()),this.TableObj.TableColumns.Contains("City")&&(s.City=i.City1.toString()),this.TableObj.TableColumns.Contains("City")&&(s.Country_key=i.CountryID.toString()),this.TableObj.TableColumns.Contains("City")&&(s.City_key=i.CityID.toString()),this.TableObj.TableColumns.Contains("City")&&(s.CytomedDivision_Key=i.CytomedDivisionID.toString()),this.TableObj.TableColumns.Contains("City")&&(s.Territory_Key=i.TerritoryID.toString()),s.Action="Add",this.TableObj.addRows(s)}))}}}ClearData(){this.TableObj.Clear(),this.Fields.forEach(t=>{t instanceof u.y$&&(null!=t.DBColumnName&&t.DBColumnName.toLowerCase().Contains("ccnid")||null!=t.DBColumnName&&"customerid"==t.DBColumnName.toLowerCase())&&(this.oPactCombo=t,this.oPactCombo.SelectedValue=0)})}}}}]);