"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[7983],{40364:(j,f,d)=>{d.r(f),d.d(f,{GenerateBillsViewModel:()=>B});var T=d(74523),c=d(9659),r=d(66148),S=d(76962),O=d(76199),C=d(5349),V=d(6532),M=d(1077),g=d(4884),P=d(29702),u=d(99393),p=d(9503),y=d(89211),I=d(27490);class B extends O.g{get SelectAll(){return this._SelectAll}set SelectAll(e){e!=this._SelectAll&&(this._SelectAll=e,this.SelectUnselectAll(e))}get OnlyFirstInvs(){return this._OnlyFirstInvs}set OnlyFirstInvs(e){e!=this._OnlyFirstInvs&&(this._OnlyFirstInvs=e,this.FilterfirstInvs(e))}constructor(e){super(),this.InProgress="",this.ProgressMessage="",this.ProgressValue=0,this.ProgressWidth=0,this.ProgressMax=0,this.BasedOn=new C.y$(0),this.Status=new C.y$(0),this.Customer=new M.y$(0),this.From=new V.Dw(0),this.TO=new V.Dw(0),this.FromDate=new g.Lc(0),this.ToDate=new g.Lc(0),this.InvoiceDate=new g.Lc(0),this.TillDate=new g.Lc(0),this._SelectAll=!1,this.chkSelectAll=new y.c,this._OnlyFirstInvs=!1,this.chkOnlyFirstInvs=new y.c,this.VoucherWise=!1,this.DateWise=!1,this.rdoVoucherWise=new p.u("",0,"Doc"),this.rdoDateWise=new p.u("",0,"Doc"),this.dtpref=null,this.ShowProcessDialog=!1,this.VirtualVouchersTable=[],this.DisplayName=e,this.FromDate.Label=c.d.GetResource("DocumentDesigner_FromDate"),this.Customer.Label="Customer",this.Customer.CCID=2,this.Customer.TypeID=2,this.ToDate.Label=c.d.GetResource("DocumentDesigner_ToDate"),this.BasedOn.Label="Post Bills",this.Status.Label="Show Contracts",this.BasedOn.Items.push(C._p.ComboBoxItems_2("Contract based","0")),this.BasedOn.Items.push(C._p.ComboBoxItems_2("Customer based","1")),this.Status.Items.push(C._p.ComboBoxItems_2("Both","0")),this.Status.Items.push(C._p.ComboBoxItems_2("Pending","1")),this.Status.Items.push(C._p.ComboBoxItems_2("Invoiced","2")),this.BasedOn.SelectedValue="0",this.Status.SelectedValue="1",this.InvoiceDate.Label="Invoice Date",this.VoucherWise=!1,this.DateWise=!0,this.From.Label="From",this.TO.Label="To",this.TillDate.Label="Till Date",this.LoadGrid(),this.rdoVoucherWise.Label=c.d.GetResource("Com_HCNoWise"),this.rdoVoucherWise.CheckedChangedCommand.Subscribe(this,"onVoucherWiseCheck"),this.rdoDateWise.Label=c.d.GetResource("Com_DateWise"),this.rdoDateWise.CheckedChangedCommand.Subscribe(this,"onDateWiseCheck"),this.chkSelectAll.Label=c.d.GetResource("Selectall"),this.chkSelectAll.CheckedChangedCommand.Subscribe(this,"onSelectall"),this.chkOnlyFirstInvs.Label=c.d.GetResource("OnlyFirst"),this.chkOnlyFirstInvs.CheckedChangedCommand.Subscribe(this,"onOnlyFirstInvs"),this.ProgressWidth=1}onSelectall(e){this.SelectAll=e.IsChecked}onOnlyFirstInvs(e){this.OnlyFirstInvs=e.IsChecked}onVoucherWiseCheck(e){this.VoucherWise=e.IsChecked,this.DateWise=!1,this.rdoDateWise.IsChecked=!1,this.FromDate.Enable=!1,this.ToDate.Enable=!1,this.From.Enable=!0,this.TO.Enable=!0}onDateWiseCheck(e){this.DateWise=e.IsChecked,this.VoucherWise=!1,this.rdoVoucherWise.IsChecked=!1,this.FromDate.Enable=!0,this.ToDate.Enable=!0,this.From.Enable=!1,this.TO.Enable=!1}OnBeginEdit(e){return!r.J0.IsEmpty(e.args.item.BillNo)}LoadGrid(){this.Vouchers=new P.vv(!0),this.Vouchers.CanUserDeleteRows=!0,this.Vouchers.Table=[],this.Vouchers.OnBeginEdit.Subscribe(this,"OnBeginEdit"),this.Vouchers.TableColumns.push("Select"),this.Vouchers.TableColumns.push("Sno"),this.Vouchers.TableColumns.push("Date"),this.Vouchers.TableColumns.push("HCNo"),this.Vouchers.TableColumns.push("Customer"),this.Vouchers.TableColumns.push("Product"),this.Vouchers.TableColumns.push("BillCycle"),this.Vouchers.TableColumns.push("Price"),this.Vouchers.TableColumns.push("CustomerID"),this.Vouchers.TableColumns.push("DtBill"),this.Vouchers.TableColumns.push("BillNo"),this.Vouchers.TableColumns.push("Billdate"),this.Vouchers.TableColumns.push("TotDays"),this.Vouchers.TableColumns.push("InvDocDetailsID"),this.Vouchers.TableColumns.push("Remarks"),this.Vouchers.TableColumns.push("ProductID"),this.Vouchers.TableColumns.push("Fromdate"),this.Vouchers.TableColumns.push("Todate"),this.Vouchers.TableColumns.push("billseq");let e=new u.O7;this.Vouchers.Columns=[],e=new u.O7,e.Header="Select",e.DisplayMember="Select",e.DataType="CheckBox",e.Width=50,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Sno",e.DisplayMember="Sno",e.DataType="TextBlock",e.Width=50,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="HC Date",e.DisplayMember="Date",e.DataType="TextBlock",e.Width=80,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="HC No.",e.DisplayMember="HCNo",e.DataType="LINK",e.Click.Subscribe(this,"onHCClick"),e.Width=100,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Customer",e.DisplayMember="Customer",e.DataType="TextBlock",e.Width=200,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Product",e.DisplayMember="Product",e.DataType="TextBlock",e.Width=150,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="BillCycle",e.DisplayMember="BillCycle",e.DataType="TextBlock",e.Width=200,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Tot Days",e.DisplayMember="TotDays",e.DataType="TextBlock",e.Width=80,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Qty",e.DisplayMember="Qty",e.DataType="FLOAT",e.Width=80,e.ReadOnly=!0,e.IsVisible=!1,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Price",e.DisplayMember="Price",e.DataType="FLOAT",e.Width=70,e.DecimalPoints=c.d.SessionManager.Preferences.DecimalsinAmount,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Bill No",e.DisplayMember="BillNo",e.DataType="LINK",e.Width=100,e.ReadOnly=!0,e.Click.Subscribe(this,"onDOcClick"),this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Bill Date",e.DisplayMember="Billdate",e.Width=100,e.ReadOnly=!0,this.Vouchers.Columns.push(e),e=new u.O7,e.Header="Remarks",e.DisplayMember="Remarks",e.Width=100,e.ReadOnly=!0,this.Vouchers.Columns.push(e);try{let n=[],i=c.d.common.GetDataSet("GB001","");if(null!=i&&i.Tables.length>0&&i.Tables[0].length>0&&i.Columns[1].Contains("SysColumnName")){let t=i.Tables[0].filter(l=>"GBFields"==l.Name);if(t.length>0&&""!=t[0].Value.ToString()&&(n=t[0].Value.toString().split(";"),null!=n&&n.length>0))for(let l=0;l<i.Tables[1].length;l++)for(let h=0;h<n.length;h++)n[h]==i.Tables[1][l].SysColumnName.toString()&&(e=new u.O7,e.Header=i.Tables[1][l].ResourceData.toString(),e.DisplayMember=i.Tables[1][l].SysColumnName.toString(),e.Width=100,e.ReadOnly=!0,this.Vouchers.Columns.push(e),this.Vouchers.TableColumns.Contains(i.Tables[1][l].SysColumnName.toString())||this.Vouchers.TableColumns.push(i.Tables[1][l].SysColumnName.toString()))}}catch{}this.Vouchers.SearchVisible=!0,this.Vouchers.SelectAll.Visible=!0,this.Vouchers.SearchColStartIndex=1,this.Vouchers.AddSearchCols()}onHCClick(e){var n=this;return(0,T.A)(function*(){if(null!=n.Vouchers.SelectedItem&&!r.J0.IsEmpty(n.Vouchers.SelectedItem.HCNo)){let i=0,t=c.d.report.GetDocumentDetailsByVoucherNo(n.Vouchers.SelectedItem.HCNo.toString());if(i=r.J0.Int(t.obj),i>0){let l;l=t.Tables[0].length>0?t.Tables[0][0]:t.Tables[1][0];const{AddEditDocumentComponent:h}=yield Promise.resolve().then(d.bind(d,8405)),{AddEditDocumentViewModel:s}=yield Promise.resolve().then(d.bind(d,27490));let o=new s(parseInt(l.CostCenterID),l.DocumentName.toString(),!0);o.ScreenObject.DocPrefix.ComboBox.SelectedValue=l.DocPrefix.toString(),o.ScreenObject.DocPrefix.TextBox.Text=l.DocNumber.toString(),o.OnDocPrefixChanged("lostFocus"),o.ScreenObject.FillDocumentPrefix(!0),c.d.page.addNewTab({component:h,params:{obj:o}})}}})()}onDOcClick(e){var n=this;return(0,T.A)(function*(){if(null!=n.Vouchers.SelectedItem&&!r.J0.IsEmpty(n.Vouchers.SelectedItem.BillNo)){let i=0,t=c.d.report.GetDocumentDetailsByVoucherNo(n.Vouchers.SelectedItem.BillNo.toString());if(i=r.J0.Int(t.obj),i>0){let l;l=t.Tables[0].length>0?t.Tables[0][0]:t.Tables[1][0];const{AddEditDocumentComponent:h}=yield Promise.resolve().then(d.bind(d,8405));let s=new I.AddEditDocumentViewModel(parseInt(l.CostCenterID),l.DocumentName.toString(),!0);s.ScreenObject.DocPrefix.ComboBox.SelectedValue=l.DocPrefix.toString(),s.ScreenObject.DocPrefix.TextBox.Text=l.DocNumber.toString(),s.OnDocPrefixChanged("lostFocus"),s.ScreenObject.FillDocumentPrefix(!0),c.d.page.addNewTab({component:h,params:{obj:s}})}}})()}OnButtonClick(e){if("Hide"==e)this.ShowProcessDialog=!1;else if("Generate Bills"==e)this.ProgressMessage="Resaving documents.Please wait...",this.ShowProcessDialog=!0,this.SaveCall();else if("Export"!=e&&"OK"==e){this.SelectAll=!1;let n=0,i=0;null!=this.From.Text&&r.J0.Int(this.From.Text)>0&&(n=parseInt(this.From.Text)),null!=this.TO.Text&&r.J0.Int(this.TO.Text)>0&&(i=parseInt(this.TO.Text));let l,t=this.GetBills(this.FromDate.Date,this.ToDate.Date,this.VoucherWise,n,i,this.TillDate.Date,this.Customer.SelectedValue);if(null!=t&&t.Tables.length>0&&t.Columns[0].Contains("ErrorMessage")&&t.Tables[0].length>0)return this.DisplayMessage=t.Tables[0][0].ErrorMessage.toString(),void(this.MessageVisibility=!0);if(null!=t&&t.Tables.length>0){let h=!1;if(t.Tables.length>1&&t.Tables[1].length>0&&t.Columns[1].Contains("Name")){this.dtpref=t.Tables[1];let s=this.dtpref.filter(D=>"GBFields"==D.Name);if(s.length>0&&""!=s[0].Value.ToString()&&(l=s[0].Value.toString().split(";")),!this.Vouchers.TableColumns.Contains("Qty")){let D=this.dtpref.filter(a=>"QtyBased"==a.Name);D.length>0&&!r.J0.IsEmpty(D[0].Value)&&(0,S.yG0)(D[0].Value.toString())&&(this.Vouchers.TableColumns.push("Qty"),this.Vouchers.Columns[8].IsVisible=!0,this.Vouchers.UpdateFooter())}let o=this.dtpref.filter(D=>"InvoiceOnDelDate"==D.Name);o.length>0&&(h=(0,S.yG0)(o[0].Value.toString())),h&&!this.Vouchers.TableColumns.Contains("InvDate")&&this.Vouchers.TableColumns.push("InvDate")}this.Vouchers.Table.Clear();for(let s=0;s<t.Tables[0].length;s++){if("1"==this.Status.SelectedValue&&!r.J0.IsEmpty(t.Tables[0][s].BillNo)||"2"==this.Status.SelectedValue&&""==r.J0.String(t.Tables[0][s].BillNo))continue;let o=this.Vouchers.NewRow();o.Date=r.J0.ParseDate(t.Tables[0][s].docdate.toString()).ToString(c.d.SessionManager.Preferences["Date Format"]),o.HCNo=t.Tables[0][s].voucherno,o.Customer=t.Tables[0][s].accountname,o.CustomerID=t.Tables[0][s].debitaccount,o.Product=t.Tables[0][s].productname,o.ProductID=t.Tables[0][s].Prodid,o.Fromdate=r.J0.ParseDate(r.J0.String(t.Tables[0][s].Fromdate)),o.Todate=r.J0.ParseDate(r.J0.String(t.Tables[0][s].Todate)),o.BillCycle="from "+r.J0.ParseDate(t.Tables[0][s].Fromdate.toString()).ToString(c.d.SessionManager.Preferences["Date Format"])+"- to "+r.J0.ParseDate(t.Tables[0][s].Todate.toString()).ToString(c.d.SessionManager.Preferences["Date Format"]),r.J0.IsEmpty(t.Tables[0][s].Amount)||(o.Price=parseFloat(t.Tables[0][s].Amount.toString()).ToString("N"+c.d.SessionManager.Preferences.DecimalsinAmount));let a=r.J0.ParseDate(t.Tables[0][s].Todate.toString()).Subtract(r.J0.ParseDate(t.Tables[0][s].Fromdate.toString())).TotalDays+1;r.J0.IsEmpty(t.Tables[0][s].ExlDays)||(a-=parseInt(t.Tables[0][s].ExlDays.toString())),o.TotDays=a,o.DtBill=r.J0.ParseDate(t.Tables[0][s].Billdate.toString()),o.Billdate=r.J0.ParseDate(t.Tables[0][s].Billdate.toString()).ToString(c.d.SessionManager.Preferences["Date Format"]),o.BillNo=t.Tables[0][s].BillNo,o.InvDocDetailsID=t.Tables[0][s].InvDocDetailsID,o.Sno=(s+1).toString(),o.Select=!1,this.Vouchers.TableColumns.Contains("Qty")&&t.Columns[0].Contains("Qty")&&(o.Qty=t.Tables[0][s].Qty),this.Vouchers.TableColumns.Contains("billseq")&&t.Columns[0].Contains("billseq")&&(o.billseq=t.Tables[0][s].billseq),h&&(o.InvDate="1"==o.billseq.toString()?r.J0.ParseDate(r.J0.String(t.Tables[0][s].Fromdate)):r.J0.ParseDate(r.J0.String(t.Tables[0][s].Todate)));let m=this.dtpref.filter(b=>"OffHireDoc"==b.Name);if(m.length>0&&!r.J0.IsEmpty(m[0].Value)&&parseInt(m[0].Value.toString())>0&&(o.Remarks=t.Columns[0].Contains("isoffhire")&&!r.J0.IsEmpty(t.Tables[0][s].isoffhire)&&(0,S.yG0)(t.Tables[0][s].isoffhire.toString())?"Off Hire":"Hire cont."),null!=l&&l.length>0)for(let b=0;b<l.length;b++)t.Columns[0].Contains(l[b])&&!r.J0.IsEmpty(t.Tables[0][s][l[b]])&&(o[l[b]]=t.Tables[0][s][l[b]].toString());this.Vouchers.addRow(o)}this.VirtualVouchersTable=this.Vouchers.Table,this.FilterfirstInvs(this.OnlyFirstInvs)}}}GetExportHTML(){let e="",n="";e+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",n+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",n+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",n+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",n+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}",e+="<style>"+n.toString()+"</style>";let t=0;for(let h=0;h<this.Vouchers.Columns.length;h++)t+=this.Vouchers.Columns[h].Width;e+="<table>",e+="\r\n<tr><td align='center'><h2>",e+=c.d.SessionManager.CompanyName,e+="</h2></td></tr>",e+="\r\n<tr><td align='center'><h3 style='vertical-align:middl;'>",e+=this.DisplayName,e+="</h3></td></tr>",e+="\r\n<tr><td align='center'>",e+=" From :  "+this.FromDate.Date.ToString(c.d.SessionManager.Preferences["Date Format"]),e+=" &nbs;&nbsp;&nbsp;To :  "+this.ToDate.Date.ToString(c.d.SessionManager.Preferences["Date Format"]),e+="</td></tr>",e+="<tr><td style='padding-top:10p;'><table border=1 width='"+t+"' style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",e+="<COLGROUP>";for(let h=0;h<this.Vouchers.Columns.length-2;h++)e+="FLOAT"==this.Vouchers.Columns[h].DataType?"<COL style='text-align:righ;'>":"<COL style=''>";e+="</COLGROUP>",e+="<tr style=''>";for(let h=0;h<this.Vouchers.Columns.length-2;h++)e+="<th class='hdr' width='"+this.Vouchers.Columns[h].Width,e+="px' >",e+=this.Vouchers.Columns[h].Header,e+="</th>";e+="</tr>";let l=this.Vouchers.Table;for(let h=0;h<l.length;h++){e+="<tr",h%2==1&&(e+=" class=alt"),e+=">";for(let s=0;s<this.Vouchers.Columns.length-2;s++)e+="<td",e+="FLOAT"==this.Vouchers.Columns[s].DataType?" align='right'":" align='left'",e+=">",e+=l[h][this.Vouchers.Columns[s].DisplayMember].toString(),e+="</td>";e+="</tr>"}return e+="</table>",e+="</td></tr></table>",e+="</body><html>",e}SelectUnselectAll(e){let n=this.Vouchers.Table;for(let i=0;i<n.length;i++)""==r.J0.String(n[i].BillNo)&&(n[i].Select=e);this.Vouchers.refreshDataView()}FilterfirstInvs(e){this.Vouchers.TableColumns.Contains("billseq")&&(this.Vouchers.Table=e?this.VirtualVouchersTable.filter(n=>1==n.billseq):this.VirtualVouchersTable)}SaveCall(){if(this.ProgressValue=1,null==this.dtpref)return;let e=0,n=0,i=!1;this.Billdatefld="";let t=this.dtpref.filter(a=>"SIVDoc"==a.Name);if(t.length>0&&(e=parseInt(t[0].Value.toString())),t=this.dtpref.filter(a=>"HireContractDoc"==a.Name),t.length>0&&(n=parseInt(t[0].Value.toString())),t=this.dtpref.filter(a=>"SIVBillingDate"==a.Name),t.length>0&&(this.Billdatefld=t[0].Value.toString()),t=this.dtpref.filter(a=>"InvoiceOnDelDate"==a.Name),t.length>0&&(i=(0,S.yG0)(t[0].Value.toString())),0==e)return;this.objViewModel=new I.AddEditDocumentViewModel(e,"",!0),this.objViewModel.GenratePrefix=!0;var l=this.objViewModel.ScreenObject.Link.LinkCombo.Items.find(a=>a.Parent==n.toString());if(null==l||null==l)return void(this.DisplayMessage="Please place linking between Hire Contract and Sales invoice Docuemnt");if(this.objViewModel.ScreenObject.Link.LinkCombo.SelectedValue=l.Value,!this.objViewModel.ScreenObject.GridDataColumns.Contains(this.Billdatefld))return void(this.DisplayMessage="Sales invoice Billing Date should be in body");let h="",s=null;"1"==this.BasedOn.SelectedValue?i?(s=this.Vouchers.Table.filter(a=>1==a.Select),s=s.sort((a,m)=>a.CustomerID>m.CustomerID||a.CustomerID==m.CustomerID&&a.InvDate>m.InvDate?1:-1)):(s=this.Vouchers.Table.filter(a=>1==a.Select),s=s.sort((a,m)=>m.CustomerID-a.CustomerID)):i?(s=this.Vouchers.Table.filter(a=>1==a.Select),s=s.sort((a,m)=>a.HCNo>m.HCNo||a.HCNo==m.HCNo&&a.InvDate>m.InvDate?1:-1)):(s=this.Vouchers.Table.filter(a=>1==a.Select),s=s.sort((a,m)=>m.HCNo-a.HCNo)),this.obja=[];let o=null,D=[];for(let a=0;a<s.length;a++)D.Contains(s[a].HCNo.toString())||D.push(s[a].HCNo),(0==a||i&&r.J0.ParseDate(s[a].InvDate.toString()).Date()!=r.J0.ParseDate(s[a-1].InvDate.toString()).Date()||"1"==this.BasedOn.SelectedValue&&r.J0.String(s[a].CustomerID)!=r.J0.String(s[a-1].CustomerID)||"1"!=this.BasedOn.SelectedValue&&r.J0.String(s[a].HCNo)!=r.J0.String(s[a-1].HCNo))&&(a>0&&this.obja.push(o),o=[]),o.push(s[a]);null!=o&&this.obja.push(o);for(let a=0;a<D.length;a++)""!=h&&(h+="','"),h+=D[a].toString();this.ProgressMax=this.obja.length,this.InProgress=this.ProgressValue+" of "+this.ProgressMax,this.ProgressWidth=100*(this.ProgressValue-1)/this.ProgressMax,0==this.ProgressWidth&&(this.ProgressWidth=1),this.objViewModel.ScreenObject.GetLinkDocDetails(h,parseInt(l.Value),"",!0).subscribe(a=>{this.dsLink=a,this.objViewModel.IsSelectAll=!0,this.iLoop=0,this.objViewModel.SaveCallBackMethod.Subscribe(this,"SaveCallBack_Complete"),this.SaveCallBack()})}SaveCallBack(){let e=!1,n=this.dtpref.filter(i=>"InvoiceOnDelDate"==i.Name);if(n.length>0&&(e=(0,S.yG0)(n[0].Value.toString())),this.iLoop>=this.obja.length)return this.Vouchers.refreshDataView(),void(this.ShowProcessDialog=!1);this.InProgress=this.ProgressValue+" of "+this.ProgressMax,this.ids=this.obja[this.iLoop],this.objViewModel.DocumentDate=this.InvoiceDate.Date,this.objViewModel.DocumentDate=e&&this.ids.length>0?r.J0.ParseDate(this.ids[0].InvDate).Date():this.InvoiceDate.Date;for(let i=0;i<this.ids.length;i++){let t=[];t.push(this.ids[i]),0==i&&null!=this.objViewModel.ScreenObject.DebitAccount&&(this.objViewModel.ScreenObject.DebitAccount.SelectedValue=parseInt(r.J0.String(this.ids[i].CustomerID)),this.objViewModel.ScreenObject.Data.Tables[0].filter(s=>null!=s.LocalReference&&s.LocalReference=="'"+this.objViewModel.ScreenObject.DebitAccount.DBColumnID+"'").length>0&&this.objViewModel.ScreenObject.GetLinkReferenceData(this.objViewModel.ScreenObject.DebitAccount.DBColumnID,this.objViewModel.CostCenterID,this.objViewModel.ScreenObject.DebitAccount.SelectedValue,this.objViewModel.DocumentDate,this.objViewModel.ScreenObject.DebitAccount.DBColumnName,2,null));let l=this.objViewModel.GetEmptyRowPosition(this.objViewModel.ScreenObject.GridDataObj,"ProductID_Key");this.objViewModel.LoadLinkData(this.dsLink,t,0,[],null),this.objViewModel.ScreenObject.GridData[l][this.Billdatefld]=r.J0.ParseDate(this.ids[i].DtBill.toString()).ToString(c.d.SessionManager.Preferences["Date Format"]),this.objViewModel.ScreenObject.GridDataColumns.Contains(this.Billdatefld+"_Key")&&(this.objViewModel.ScreenObject.GridData[l][this.Billdatefld+"_Key"]=r.J0.ParseDate(this.ids[i].DtBill.toString())),this.objViewModel.ScreenObject.GridDataColumns.Contains("dcnum10")&&(this.objViewModel.ScreenObject.GridData[l].dcnum10=this.ids[i].TotDays.toString()),!r.J0.IsEmpty(this.ids[i].Fromdate)&&this.objViewModel.ScreenObject.GridDataColumns.Contains("dcalpha6_Key")&&(this.objViewModel.ScreenObject.GridData[l].dcalpha6_Key=r.J0.ParseDate(this.ids[i].Fromdate.toString()),this.objViewModel.ScreenObject.GridData[l].dcalpha6=r.J0.ParseDate(this.ids[i].Fromdate.toString()).ToString(c.d.SessionManager.Preferences["Date Format"])),!r.J0.IsEmpty(this.ids[i].Todate)&&this.objViewModel.ScreenObject.GridDataColumns.Contains("dcalpha7_Key")&&(this.objViewModel.ScreenObject.GridData[l].dcalpha7_Key=r.J0.ParseDate(this.ids[i].Todate.toString()),this.objViewModel.ScreenObject.GridData[l].dcalpha7=r.J0.ParseDate(this.ids[i].Todate.toString()).ToString(c.d.SessionManager.Preferences["Date Format"])),this.objViewModel.ScreenObject.GridData[l].ProductID_Key.toString()!=this.ids[i].ProductID.toString()&&(this.objViewModel.ScreenObject.GridData[l].ProductID_Key=this.ids[i].ProductID.toString()),this.objViewModel.ScreenObject.GridData[l].Rate=this.ids[i].Price.toString(),this.Vouchers.TableColumns.Contains("Qty")&&!r.J0.IsEmpty(this.ids[i].Qty)&&(this.objViewModel.ScreenObject.GridData[l].Quantity=this.ids[i].Qty.toString()),this.objViewModel.ScreenObject.GridDataColumns.Contains("LineNarration")&&(this.objViewModel.ScreenObject.GridData[l].LineNarration=this.ids[i].BillCycle.toString()+"("+this.ids[i].Remarks.toString()+")"),this.objViewModel.CalculateTotals(this.objViewModel.ScreenObject.GridData[l],!1)}this.objViewModel.SaveInventoryDocument("Save",!1)}SaveCallBack_Complete(){setTimeout(()=>{if(this.objViewModel.RetValue<=0)this.objViewModel.clear(1);else for(let e=0;e<this.ids.length;e++)this.ids[e].BillNo=this.objViewModel.DisplayMessage,this.ids[e].Select=!1;this.ProgressValue++,this.iLoop++,this.SaveCallBack()},30)}GetBills(e,n,i,t,l,h,s){Logger.InfoLog("Document:: Inside GetBills");try{let o=[];return o.push(e.ToString("dd/MMM/yyyy")),o.push(n.ToString("dd/MMM/yyyy")),o.push(i),o.push(t),o.push(l),o.push(h.ToString("dd/MMM/yyyy")),o.push(s),o.push(c.d.SessionManager.UserName),o.push(c.d.SessionManager.UserID),o.push(c.d.SessionManager.LanguageID),c.d.document.GetBills(o)}catch(o){return Logger.ErrorLog("Document:: GetBills"+o.stack),null}}}}}]);