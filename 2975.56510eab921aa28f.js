"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[2975],{2975:(M,C,a)=>{a.r(C),a.d(C,{ChequeBookViewModel:()=>I});var r=a(9659),o=a(66148),b=a(76199),S=a(29702),N=a(5349),G=a(6532),c=a(99393),d=a(45984),p=a(89417),i=a(41360),A=a(32881),m=a(45319),T=a(73955);function y(u,n){if(1&u&&(i.j41(0,"div",6),i.EFF(1,"\n            "),i.eu8(2,7),i.EFF(3,"\n        "),i.k0s()),2&u){const s=i.XpG();i.R7$(2),i.Y8G("obj",s.obj.ChequeNo)("group",s.form)}}let f=(()=>{class u{constructor(){this.form=new p.gE({})}ngOnInit(){}static{this.\u0275fac=function(e){return new(e||u)}}static{this.\u0275cmp=i.VBU({type:u,selectors:[["app-cancel-cheque-book"]],inputs:{obj:"obj"},standalone:!1,decls:21,vars:7,consts:[[1,"master-screen"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"form-group","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"]],template:function(e,l){1&e&&(i.j41(0,"div",0),i.EFF(1,"\n    "),i.j41(2,"div",1),i.EFF(3,"\n        "),i.DNE(4,y,4,2,"div",2),i.EFF(5,"\n    "),i.k0s(),i.EFF(6,"\n    "),i.j41(7,"div",3),i.EFF(8,"\n        "),i.j41(9,"div"),i.EFF(10,"\n            "),i.j41(11,"button",4),i.bIt("click",function(){return l.obj.OnButtonClick("Submit")}),i.EFF(12),i.nI1(13,"translate"),i.k0s(),i.EFF(14,"\n            "),i.j41(15,"button",5),i.bIt("click",function(){return l.obj.OnButtonClick("ChequeCancel")}),i.EFF(16),i.nI1(17,"translate"),i.k0s(),i.EFF(18,"\n        "),i.k0s(),i.EFF(19,"\n    "),i.k0s(),i.EFF(20,"\n"),i.k0s()),2&e&&(i.R7$(4),i.Y8G("ngIf",l.obj.ChequeNo.Visible),i.R7$(8),i.JRh(i.bMT(13,3,"Submit")),i.R7$(4),i.JRh(i.bMT(17,5,"Cancel")))},dependencies:[A.bT,m._,T.D9],encapsulation:2})}}return u})();class I extends b.g{constructor(){super(),this.obj=new d.Document,this.CancelledDisplayMessage="",this.CancelledMessageVisibility=!1,this.ChequeCancelVisibility=!1,this.AccountList=new N.y$(0),this.ChequeNo=new G.Dw(0),this.SNO=1,this.DisplayName=r.d.GetResource("ChequeBooks");let n=this.obj.GetChequeBookDetail(0);this.AccountList.SelectionChangedCommand.Subscribe(this,"OnSelectionChanged"),null!=n&&n.Tables.length>0&&n.Tables[0].length>0&&n.Tables[0].forEach(s=>{this.AccountList.Items.push(N._p.ComboBoxItems_2(s.AccountName.toString(),s.AccountID.toString()))}),this.loadGrid(),this.AccountsGrid.OnCellEditEnding.Subscribe(this,"OnCellEndEdit"),this.AccountsGrid.SearchVisible=!1,this.AccountList.Label="Accounts",this.ChequeNo.Label="Cheque No"}loadGrid(){let n=[],s={};s.Name=r.d.GetResource("Open"),s.Value=1,n.push(s),s={},s.Name=r.d.GetResource("Close"),s.Value=2,n.push(s),this.AccountsGrid=new S.vv,this.AccountsGrid.CanUserAddRows=!0,this.AccountsGrid.CanUserDeleteRows=!0,this.AccountsGrid.Table=[],this.AccountsGrid.TableColumns.push("Sno"),this.AccountsGrid.TableColumns.push("BookNo"),this.AccountsGrid.TableColumns.push("StartNo"),this.AccountsGrid.TableColumns.push("EndNo"),this.AccountsGrid.TableColumns.push("CurrentNo"),this.AccountsGrid.TableColumns.push("CancelledCheques"),this.AccountsGrid.TableColumns.push("Status"),this.AccountsGrid.Columns=[];let e=new c.O7;e=new c.O7,e.Header=r.d.GetResource("Sno"),e.DisplayMember="Sno",e.DataType="TextBlock",e.Width=50,e.ReadOnly=!0,this.AccountsGrid.Columns.push(e),e=new c.O7,e.Header=r.d.GetResource("BookNo"),e.DisplayMember="BookNo",e.DataType="TextBlock",e.Width=280,e.ReadOnly=!1,this.AccountsGrid.Columns.push(e),e=new c.O7,e.Header=r.d.GetResource("StartNo"),e.DisplayMember="StartNo",e.DataType="TextBlock",e.Width=150,e.ReadOnly=!1,this.AccountsGrid.Columns.push(e),e=new c.O7,e.Header=r.d.GetResource("EndNo"),e.DisplayMember="EndNo",e.DataType="TextBlock",e.Width=150,e.ReadOnly=!1,this.AccountsGrid.Columns.push(e),e=new c.O7,e.Header=r.d.GetResource("CurrentNo"),e.DisplayMember="CurrentNo",e.DataType="TextBlock",e.Width=150,e.ReadOnly=!1,this.AccountsGrid.Columns.push(e),e=new c.O7,e.Header=r.d.GetResource("CancelledCheques"),e.DisplayMember="CancelledCheques",e.DataType="TextBlock",e.Width=280,e.ReadOnly=!0,this.AccountsGrid.Columns.push(e),e=new c.O7,e.Header=r.d.GetResource("Status"),e.ValueBinding="Status",e.DataType="ComboBox",e.DisplayMember="Name",e.ValueMember="Value",e.Width=70,e.ComboData=n,this.AccountsGrid.Columns.push(e),this.AccountsGrid.Clear();for(let l=0;l<20;l++){let t=this.AccountsGrid.NewRow();t.Sno=l+1,this.AccountsGrid.addRow(t)}this.AccountsGrid.TableNewRow.Subscribe(this,"Table_TableNewRow")}OnCellEndEdit(n,s,e){let l=this.AccountsGrid.Table.indexOf(n)+1;return""==o.J0.String(n.BookNo)?(this.DisplayMessage="BookNo instanceof Empty at RowNo "+l,void(this.MessageVisibility=!0)):"BookNo"==s&&this.AccountsGrid.Table.filter(h=>h.BookNo==n.BookNo.toString()).length>1?(this.DisplayMessage="BookNo already selected with the Name '"+n.BookNo.toString()+"'",this.MessageVisibility=!0,n.BookNo=null,n.StartNo=null,n.EndNo=null,n.CurrentNo=null,n.CancelledCheques=null,void this.AccountsGrid.updateRow(n)):"CurrentNo"==s&&!o.J0.IsEmpty(n.CurrentNo)&&(parseInt(n.CurrentNo.toString())>parseInt(n.EndNo.toString())||parseInt(n.CurrentNo.toString())<parseInt(n.StartNo.toString()))?(this.DisplayMessage="CurrentNo. in BookNo. '"+n.BookNo.toString()+"' instanceof out of Range",void(this.MessageVisibility=!0)):void 0}Table_TableNewRow(n){this.UpdateSequence(),n.Sno=this.SNO}UpdateSequence(){this.SNO=1,this.AccountsGrid.Table.forEach(n=>{n.Sno=this.SNO++})}OnButtonClick(n){if(this.AccountsGrid.angularGrid?.slickGrid&&this.AccountsGrid.angularGrid?.slickGrid.getActiveCellNode()&&this.AccountsGrid.angularGrid.slickGrid.getEditorLock().commitCurrentEdit(),"Save"==n){let s="";s+="<XML>";for(let t=0;t<this.AccountsGrid.Table.length;t++)if(!o.J0.IsEmpty(this.AccountsGrid.Table[t].BookNo)){if(""==o.J0.String(this.AccountsGrid.Table[t].StartNo))return this.DisplayMessage="Enter start No. for BookNo. = '"+this.AccountsGrid.Table[t].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(0==o.J0.Int(this.AccountsGrid.Table[t].StartNo))return this.DisplayMessage="Invalid start No. for BookNo. = '"+this.AccountsGrid.Table[t].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(""==o.J0.String(this.AccountsGrid.Table[t].EndNo))return this.DisplayMessage="Enter End No. for BookNo. = '"+this.AccountsGrid.Table[t].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(0==o.J0.Int(this.AccountsGrid.Table[t].EndNo))return this.DisplayMessage="Invalid End No. for BookNo. = '"+this.AccountsGrid.Table[t].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(!o.J0.IsEmpty(this.AccountsGrid.Table[t].CurrentNo)&&0==o.J0.Int(this.AccountsGrid.Table[t].CurrentNo))return this.DisplayMessage="Invalid Current No. for BookNo. = '"+this.AccountsGrid.Table[t].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(parseInt(this.AccountsGrid.Table[t].EndNo.toString())<=parseInt(this.AccountsGrid.Table[t].StartNo.toString()))return this.DisplayMessage="EndNo Should be higher than start No. for BookNo. = '"+this.AccountsGrid.Table[t].BookNo.toString()+"'",void(this.MessageVisibility=!0);if(!o.J0.IsEmpty(this.AccountsGrid.Table[t].CurrentNo)&&!o.J0.IsEmpty(this.AccountsGrid.Table[t].StartNo)&&!o.J0.IsEmpty(this.AccountsGrid.Table[t].EndNo)&&(parseInt(this.AccountsGrid.Table[t].CurrentNo.toString())>parseInt(this.AccountsGrid.Table[t].EndNo.toString())||parseInt(this.AccountsGrid.Table[t].CurrentNo.toString())<parseInt(this.AccountsGrid.Table[t].StartNo.toString())))return this.DisplayMessage="CurrentNo. for BookNo. = '"+o.J0.String(this.AccountsGrid.Table[t].BookNo)+"' instanceof out of Range",void(this.MessageVisibility=!0);if(""==o.J0.String(this.AccountsGrid.Table[t].Status)||"0"==o.J0.String(this.AccountsGrid.Table[t].Status))return this.DisplayMessage="Select Status for BookNo. = '"+o.J0.String(this.AccountsGrid.Table[t].BookNo)+"'",void(this.MessageVisibility=!0);s+="<Rows ",s+='BookNo="'+o.J0.String(this.AccountsGrid.Table[t].BookNo)+'" ',s+='StartNo="'+o.J0.String(this.AccountsGrid.Table[t].StartNo)+'" ',s+='EndNo="'+o.J0.String(this.AccountsGrid.Table[t].EndNo)+'" ',""!=o.J0.String(this.AccountsGrid.Table[t].CurrentNo)?s+='CurrentNo="'+this.AccountsGrid.Table[t].CurrentNo.toString()+'" ':s+='CurrentNo="'+o.J0.String(this.AccountsGrid.Table[t].StartNo)+'" ',s+='Status="'+parseInt(o.J0.String(this.AccountsGrid.Table[t].Status))+'" ',s+=" />"}s+="</XML>";let l=0;d.Document.SetChequeBookDetails(parseInt(this.AccountList.SelectedValue),s,0).subscribe(t=>{if(this.DisplayMessage=t.Message,l=t.RetValue,l>0){this.MessageVisibility=!0,this.AccountsGrid.Clear();for(let h=0;h<20;h++){let g=this.AccountsGrid.NewRow();g.Sno=h+1,this.AccountsGrid.addRow(g)}}},t=>{console.log(t),this.DisplayMessage="Error in Save"})}else if("Cancel"==n)this.ChequeNo.Text="",this.CancelledDisplayMessage="",this.CancelledMessageVisibility=!1,null==this.AccountsGrid.SelectedItem||null==this.AccountsGrid.SelectedItem||o.J0.IsEmpty(this.AccountsGrid.SelectedItem[Object.keys(this.AccountsGrid.SelectedItem)[1]])?(this.DisplayMessage="Select Cheque to Cancel",this.MessageVisibility=!0):(this.ChequeCancelVisibility=!0,this.ChequeNo.Text=this.AccountsGrid.SelectedItem.CurrentNo.toString(),r.d.page.ShowDialog(this,f,{Title:"Cancel Cheque"}));else if("ChequeCancel"==n)this.ChequeNo.Text="",this.ChequeCancelVisibility=!1,r.d.page.HideDialog(this.PopUpGUID);else if("Submit"==n){if(0==o.J0.Int(this.ChequeNo.Text))return this.CancelledDisplayMessage="Invalid Cheque No.",this.DisplayMessage="Invalid Cheque No.",this.MessageVisibility=!0,void(this.CancelledMessageVisibility=!0);if(parseInt(this.AccountsGrid.SelectedItem.EndNo.toString())<parseInt(this.ChequeNo.Text)||parseInt(this.AccountsGrid.SelectedItem.StartNo.toString())>parseInt(this.ChequeNo.Text))return this.CancelledDisplayMessage="Select Cheque Between StartNo and EndNo",this.DisplayMessage="Select Cheque Between StartNo and EndNo",this.MessageVisibility=!0,void(this.CancelledMessageVisibility=!0);if(parseInt(o.J0.String(this.AccountsGrid.SelectedItem.CurrentNo))>=parseInt(o.J0.String(this.AccountsGrid.SelectedItem.EndNo)))this.CancelledDisplayMessage="Cheque No. out of Range",this.DisplayMessage="Cheque No. out of Range",this.MessageVisibility=!0,this.CancelledMessageVisibility=!0;else{let e="";e+="<XML>",e+="<Rows ",e+='BookNo="'+o.J0.String(this.AccountsGrid.SelectedItem.BookNo)+'" ',e+='StartNo="'+o.J0.String(this.AccountsGrid.SelectedItem.StartNo)+'" ',e+='EndNo="'+o.J0.String(this.AccountsGrid.SelectedItem.EndNo)+'" ',e+='CurrentNo="'+this.ChequeNo.Text+'" ',e+=" />",e+="</XML>";let l=0;d.Document.SetChequeBookDetails(parseInt(this.AccountList.SelectedValue),e,1).subscribe(t=>{l=t.RetValue,l>0?(this.CancelledDisplayMessage="Cheque No '"+this.ChequeNo.Text+"' has been Cancelled",this.DisplayMessage="Cheque No '"+this.ChequeNo.Text+"' as been Cancelled",this.MessageVisibility=!0,this.CancelledMessageVisibility=!0,this.AccountsGrid.SelectedItem.CancelledCheques=o.J0.String(this.AccountsGrid.SelectedItem.CancelledCheques)+","+this.ChequeNo.Text,this.AccountsGrid.SelectedItem.CurrentNo=o.J0.String(this.AccountsGrid.SelectedItem.CurrentNo).Replace(parseInt(this.AccountsGrid.SelectedItem.CurrentNo.toString()).toString(),"")+l,this.AccountsGrid.updateRow(this.AccountsGrid._SelectedItem)):(this.CancelledDisplayMessage=t.Message,this.DisplayMessage=t.Message,this.MessageVisibility=!0)},t=>{console.log(t),this.DisplayMessage="Error in Delete",this.MessageVisibility=!0})}}}OnSelectionChanged(n){this.AccountsGrid.Clear();let s=this.obj.GetChequeBookDetail(parseInt(this.AccountList.SelectedValue));if(null!=s&&s.Tables.length>0&&s.Tables[0].length>0)for(let e=0;e<s.Tables[0].length;e++){let l=this.AccountsGrid.NewRow();o.J0.IsEmpty(s.Tables[0][e].BookNo)||(l.BookNo=s.Tables[0][e].BookNo.toString()),o.J0.IsEmpty(s.Tables[0][e].StartNo)||(l.StartNo=s.Tables[0][e].StartNo.toString()),o.J0.IsEmpty(s.Tables[0][e].EndNo)||(l.EndNo=s.Tables[0][e].EndNo.toString()),o.J0.IsEmpty(s.Tables[0][e].CurrentNo)||(l.CurrentNo=s.Tables[0][e].CurrentNo.toString()),o.J0.IsEmpty(s.Tables[0][e].CancelledCheques)||(l.CancelledCheques=s.Tables[0][e].CancelledCheques.toString()),"0"!=o.J0.String(s.Tables[0][e].Status)&&(l.Status=s.Tables[0][e].Status.toString()),l.Sno=this.AccountsGrid.Table.length+1,this.AccountsGrid.addRow(l)}for(let e=0;e<20;e++){let l=this.AccountsGrid.NewRow();l.Sno=this.AccountsGrid.Table.length+1,this.AccountsGrid.addRow(l)}}}}}]);