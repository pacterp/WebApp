"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[181],{52562:(b,c,r)=>{r.r(c),r.d(c,{LicenseTabViewModel:()=>u});var t=r(9659),n=r(66148),d=r(76199),m=r(29702),h=r(99393),S=r(35789),i=r(5349);class u extends d.g{constructor(){super(),this.ActiveSessionsObj=new m.vv,this.Save=new S.Yk,this.ActiveSessionsObj.Table=[],this.ActiveSessionsObj.Columns=[],this.ActiveSessionsObj.CanUserAddRows=!1,this.ActiveSessionsObj.CanUserDeleteRows=!1,this.ActiveSessionsObj.Height=0;let s=[],e=new h.O7;e.Header="Select",e.DisplayMember="Select",e.DataType="CheckBox",e.Width=50,e.ReadOnly=!0,s.push(e),e=new h.O7,e.Header="System Name",e.DisplayMember="SysName",e.DataType="TextBlock",e.Width=150,e.ReadOnly=!0,s.push(e),e=new h.O7,e.Header="IP Address",e.DisplayMember="IPAddress",e.DataType="TextBlock",e.Width=120,e.ReadOnly=!0,s.push(e),e=new h.O7,e.Header="Create Time",e.DisplayMember="LoginTimeText",e.DataType="TextBlock",e.Width=140,e.ReadOnly=!0,s.push(e),e=new h.O7,e.Header="Last Access Time",e.DisplayMember="LastAccessTimeText",e.DataType="TextBlock",e.Width=140,e.ReadOnly=!0,s.push(e),e=new h.O7,e.Header="Status",e.DisplayMember="Status",e.DataType="TextBlock",e.Width=80,e.ReadOnly=!0,s.push(e),e=new h.O7,e.Header="User",e.DisplayMember="UserName",e.DataType="TextBlock",e.Width=parseInt(this.UserWidth),e.ReadOnly=!0,s.push(e),e=new h.O7,e.Header="Site",e.DisplayMember="SiteName",e.DataType="TextBlock",e.Width=parseInt(this.SiteWidth),e.ReadOnly=!0,s.push(e),e=new h.O7,e.Header="DB Index",e.DisplayMember="DBIndex",e.DataType="TextBlock",e.Width=70,e.ReadOnly=!0,s.push(e),this.ActiveSessionsObj.Columns=s,this.Save.Subscribe(this,"OnSave"),this.FillSearchDetails()}OnButtonClick(s){if("Refresh"==s)this.RefreshData();else if("Kill"==s){let e=this.ActiveSessionsObj.Table.filter(a=>a.Select&&"Blocked"!=a.Status);0==e.length?this.DisplayMessage="Select session to kill":e.forEach(a=>{t.d.ForwardProgress.LoginGUID!=a.GUID.toString()?(t.d.ForwardProgress.KillLoginSession(a.GUID.toString()),this.ActiveSessionsObj.removeRow(a)):1==e.length&&(this.DisplayMessage="Selected session can not be killed, because its owned by you.")})}else if("Unblock"==s){let e=this.ActiveSessionsObj.Table.filter(a=>a.Select&&"Blocked"==a.Status);0==e.length?this.DisplayMessage="Select blocked users to unblock":e.forEach(l=>{if(t.d.SessionManager.UserName!=l.UserName.toString())try{t.d.admin.UserLoginCheck(n.J0.Int(t.d.SessionManager.CompanyIndex),l.UserName.toString(),2),this.ActiveSessionsObj.removeRow(l)}catch{}else 1==e.length&&(this.DisplayMessage="Selected users can not be unblock, because its owned by you.")})}}RefreshData(){this.ActiveSessionsObj.Clear(),this.LicenseCount=t.d.ForwardProgress.NoOfLicenses.toString(),t.d.ForwardProgress.IsSiteWise?(this.SiteWidth="120",this.UserWidth="100"):(this.SiteWidth="0",this.UserWidth="100");let l=t.d.admin.GetAccessRights(5,t.d.ForwardProgress.LCDBIndex,t.d.ForwardProgress.IsSiteWise?"1":"0",t.d.AccessPoint,"",t.d.ForwardProgress.SessionRefreshTime.toString(),"").ds;for(let o=0;o<l.Table.length;o++)l.Table[o].Sno=o+1,l.Table[o].Select=!1,l.Table[o].LoginTimeText=n.J0.ParseDate(l.Table[o].LoginTime).ToString("dd MMM yyyy hh:mm:ss"),l.Table[o].LastAccessTimeText=n.J0.ParseDate(l.Table[o].LastAccessTime).ToString("dd MMM yyyy hh:mm:ss");if(this.ActiveSessionsObj.addRows(l.Table),this.InUse=l.Table.filter(o=>"Active"==o.Status).length.toString(),this.AvailableCount=(t.d.ForwardProgress.NoOfLicenses-parseInt(this.InUse)).toString(),this.ActiveSessionsObj.Columns.length>0){this.SearchCols.Items.push(i._p.ComboBoxItems_2("System Name","SysName")),this.SearchCols.Items.push(i._p.ComboBoxItems_2("IP Address","IPAddress")),this.SearchCols.Items.push(i._p.ComboBoxItems_2("Create Time","LoginTimeText")),this.SearchCols.Items.push(i._p.ComboBoxItems_2("Last Access Time","LastAccessTimeText")),this.SearchCols.Items.push(i._p.ComboBoxItems_2("Status","Status"));for(let o=0;o<this.ActiveSessionsObj.Columns.length;o++)"UserName"==this.ActiveSessionsObj.Columns[o].toString()?this.SearchCols.Items.push(i._p.ComboBoxItems_2("User","UserName")):"SiteName"==this.ActiveSessionsObj.Columns[o].toString()&&this.SearchCols.Items.push(i._p.ComboBoxItems_2("Site","SiteName"));this.SearchCols.Items.push(i._p.ComboBoxItems_2("DB Index","DBIndex"))}this.SearchCols.Items.length>0&&(this.SearchCols.SelectedValue=this.SearchCols.Items[0].Value)}FillSearchDetails(){this.Options=new i.y$(0),this.SearchCols=new i.y$(0),this.Options.Items.push(i._p.ComboBoxItems_2(t.d.GetResource("Com_Equals"),"1")),this.Options.Items.push(i._p.ComboBoxItems_2(t.d.GetResource("Com_NotEquals"),"2")),this.Options.Items.push(i._p.ComboBoxItems_2(t.d.GetResource("Com_BeginsWith"),"3")),this.Options.Items.push(i._p.ComboBoxItems_2(t.d.GetResource("Com_EndsWith"),"4")),this.Options.Items.push(i._p.ComboBoxItems_2(t.d.GetResource("Com_Contains"),"5")),this.Options.Items.push(i._p.ComboBoxItems_2(t.d.GetResource("Com_NotContains"),"6")),this.Options.SelectedValue="5"}OnSave(s){("Search"==s.toString()||"Filter"==s.toString())&&this.SearchGrid(s.toString())}Setselectedrow(s){this.SelectedRow=this.ActiveSessionsObj[s]}SearchGrid(s){if(n.J0.StringIsNullOrEmpty(this.SearchText))return;let e="";if(""!=this.SearchCols.SelectedValue)e=this.SearchCols.SelectedValue;else{if(!(this.SearchCols.Items.length>0))return;e=this.SearchCols.Items[0].Value}if(!this.ActiveSessionsObj.TableColumns.Contains(e))return;let a=this.SelectedIndex;null!=this.SelectedRow&&this.ActiveSessionsObj.Table.indexOf(this.SelectedRow),-1==a&&(a=0)}}}}]);